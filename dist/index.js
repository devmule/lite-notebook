!function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(r){return e[r]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=33)}([function(e,r,t){"use strict";e.exports=function(e){var r=[];return r.toString=function(){return this.map((function(r){var t=e(r);return r[2]?"@media ".concat(r[2]," {").concat(t,"}"):t})).join("")},r.i=function(e,t,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<e.length;a++){var d=[].concat(e[a]);n&&i[d[0]]||(t&&(d[2]?d[2]="".concat(t," and ").concat(d[2]):d[2]=t),r.push(d))}},r}},,,function(e,r,t){"use strict";var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var e={};return function(r){if(void 0===e[r]){var t=document.querySelector(r);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[r]=t}return e[r]}}(),s=[];function a(e){for(var r=-1,t=0;t<s.length;t++)if(s[t].identifier===e){r=t;break}return r}function d(e,r){for(var t={},n=[],i=0;i<e.length;i++){var o=e[i],d=r.base?o[0]+r.base:o[0],c=t[d]||0,l="".concat(d," ").concat(c);t[d]=c+1;var u=a(l),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==u?(s[u].references++,s[u].updater(h)):s.push({identifier:l,updater:b(h,r),references:1}),n.push(l)}return n}function c(e){var r=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=t.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(e){r.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(r);else{var s=o(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(r)}return r}var l,u=(l=[],function(e,r){return l[e]=r,l.filter(Boolean).join("\n")});function h(e,r,t,n){var i=t?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(r,i);else{var o=document.createTextNode(i),s=e.childNodes;s[r]&&e.removeChild(s[r]),s.length?e.insertBefore(o,s[r]):e.appendChild(o)}}function f(e,r,t){var n=t.css,i=t.media,o=t.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var v=null,p=0;function b(e,r){var t,n,i;if(r.singleton){var o=p++;t=v||(v=c(r)),n=h.bind(null,t,o,!1),i=h.bind(null,t,o,!0)}else t=c(r),n=f.bind(null,t,r),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return n(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;n(e=r)}else i()}}e.exports=function(e,r){(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=i());var t=d(e=e||[],r);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<t.length;n++){var i=a(t[n]);s[i].references--}for(var o=d(e,r),c=0;c<t.length;c++){var l=a(t[c]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}t=o}}}},function(e,r,t){"use strict";r.a={GET_NOTEBOOK:"GET_NOTEBOOK",INIT_NOTEBOOK:"INIT_NOTEBOOK"}},function(e,r,t){"use strict";t.d(r,"a",(function(){return n}));class n{constructor(){this.eventListeners=[]}on(e,r){this.eventListeners.push({type:e,handler:r,once:!1})}once(e,r){this.eventListeners.push({type:e,handler:r,once:!0})}remove(e,r){const t=this.eventListeners.filter(t=>t.type===e&&(t.handler===r||null==r));for(let e=0;e<t.length;e++){const r=this.eventListeners.indexOf(t[e]);this.eventListeners.splice(r,1)}}emit(e){for(let r=0;r<this.eventListeners.length;r++){const t=this.eventListeners[r];t.type===e.type&&(t.handler.call(this,e),t.once&&(this.eventListeners.splice(r,1),r--))}}has(e){return!!this.eventListeners.find(r=>r.type===e)}}},,,,function(e,r,t){"use strict";var n=t(0),i=t.n(n),o=t(13),s=t(14),a=t(15),d=t(16),c=t(17),l=i()((function(e){return e[1]}));l.i(o.a),l.i(s.a),l.i(a.a),l.i(d.a),l.i(c.a),l.push([e.i,"html, body, .main-outer {\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    overflow: hidden;\r\n}\r\n",""]),r.a=l},,,,function(e,r,t){"use strict";var n=t(0),i=t.n(n)()((function(e){return e[1]}));i.push([e.i,".screen {\r\n    padding: 0;\r\n    margin: 0;\r\n    position: absolute;\r\n    overflow: hidden;\r\n    left: calc(var(--offset-default) + var(--sidebar-toggle-button-size));\r\n    width: calc(100% - var(--offset-default) - var(--sidebar-toggle-button-size));\r\n    height: 100%;\r\n    transition: left 0.2s ease-in-out, width 0.2s ease-in-out;\r\n}\r\n\r\n#screen-editor, #screen-report {\r\n    margin: var(--offset-default);\r\n    top: 0;\r\n    width: calc(var(--screen-notebook-width) - 2 * var(--offset-default));\r\n    height: calc(var(--screen-notebook-height) - 2 * var(--offset-default));\r\n    position: absolute;\r\n    transition: left 0.2s ease-in-out;\r\n}\r\n\r\n/* ========================================================== */\r\n/*     приколы для показа    */\r\n.screen > #screen-editor {\r\n    left: 0;\r\n}\r\n\r\n.screen > #screen-report {\r\n    left: var(--screen-notebook-width);\r\n}\r\n\r\n.screen.report > #screen-editor {\r\n    left: calc(-1 * var(--screen-notebook-width));\r\n}\r\n\r\n.screen.report > #screen-report {\r\n    left: 0;\r\n}\r\n\r\n.main-outer.sidebar-on > .screen {\r\n    left: var(--sidebar-width);\r\n    width: calc(100% - var(--sidebar-width));\r\n}\r\n",""]),r.a=i},function(e,r,t){"use strict";var n=t(0),i=t.n(n)()((function(e){return e[1]}));i.push([e.i,".ltn-sidebar {\r\n\r\n    left: calc(-1 * var(--sidebar-width));\r\n    top: 0;\r\n\r\n    width: var(--sidebar-width);\r\n    height: 100%;\r\n\r\n    overflow-y: visible;\r\n    overflow-x: visible;\r\n    position: absolute;\r\n    z-index: 100;\r\n\r\n    background-color: var(--sidebar-background-color);\r\n\r\n    transition: left 0.2s ease-in-out;\r\n}\r\n\r\n.ltn-sidebar-button {\r\n    margin: 0;\r\n    padding: 0;\r\n\r\n    position: absolute;\r\n    cursor: pointer;\r\n\r\n    top: var(--offset-default);\r\n    right: calc(-1 * (var(--offset-default) + var(--sidebar-toggle-button-size)));\r\n\r\n    width: var(--sidebar-toggle-button-size);\r\n    height: var(--sidebar-toggle-button-size);\r\n\r\n    background-image: var(--svg-icon-burger);\r\n\r\n    background-position: center center;\r\n    background-repeat: no-repeat;\r\n    transition: opacity 0.1s linear, right 0.2s ease-in-out;\r\n    opacity: 0.25;\r\n}\r\n\r\n.ltn-sidebar-button:hover {\r\n    opacity: 0.75;\r\n}\r\n\r\n/* ================= */\r\n.main-outer.sidebar-on > .ltn-sidebar {\r\n    left: 0;\r\n}\r\n\r\n.main-outer.sidebar-on > .ltn-sidebar > .ltn-sidebar-button {\r\n    right: var(--offset-default);\r\n}\r\n\r\n\r\n/* ================= */\r\n.ltn-sidebar-button-option {\r\n    cursor: pointer;\r\n\r\n    height: var(--sidebar-option-button-size);\r\n    padding: 8px;\r\n    margin: 0;\r\n    display: block;\r\n}\r\n\r\n.ltn-sidebar-button-option:hover {\r\n    background-color: var(--hover-color);\r\n}\r\n",""]),r.a=i},function(e,r,t){"use strict";var n=t(0),i=t.n(n)()((function(e){return e[1]}));i.push([e.i,".button {\r\n    margin: var(--offset-default);\r\n\r\n}\r\n",""]),r.a=i},function(e,r,t){"use strict";var n=t(0),i=t.n(n)()((function(e){return e[1]}));i.push([e.i,"\r\n.full-fill {\r\n    margin: 0;\r\n    padding: 0;\r\n    border: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n",""]),r.a=i},function(e,r,t){"use strict";var n=t(0),i=t.n(n)()((function(e){return e[1]}));i.push([e.i,':root {\r\n\r\n    /* размеры */\r\n    --screen-notebook-height: 100%;\r\n    --screen-notebook-width: 100%;\r\n    --offset-default: 14px;\r\n\r\n    --sidebar-toggle-button-size: 24px;\r\n    --sidebar-option-button-size: 18px;\r\n\r\n    --sidebar-width: 240px;\r\n\r\n    /* цвета */\r\n    --sidebar-background-color: #f1f1f1; /* он должен быть непрозрачный ?? */\r\n    --hover-color: rgba(93, 109, 99, 0.17);\r\n\r\n\r\n    /* иконки */\r\n    --svg-icon-burger: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M24 6h-24v-4h24v4zm0 4h-24v4h24v-4zm0 8h-24v4h24v-4z"/></svg>\');\r\n}\r\n',""]),r.a=i},function(e,r){e.exports='<div class="main-outer sidebar-on">\r\n    <div class="ltn-sidebar">\r\n        <div class="ltn-sidebar-button" id="btn-sidebar-toggle"></div>\r\n\r\n        <div class="ltn-sidebar-button-option" id="go-editor">%go_editor%</div>\r\n        <div class="ltn-sidebar-button-option" id="go-report">%go_report%</div>\r\n        <div class="ltn-sidebar-button-option" id="do-render">%do_render_report%</div>\r\n        <div class="ltn-sidebar-button-option" id="load-notebook">%load_notebook%</div>\r\n        <div class="ltn-sidebar-button-option" id="save-notebook">%save_notebook%</div>\r\n\r\n    </div>\r\n    <div class="screen">\r\n        <div id="screen-editor">\r\n            <iframe id="screen-editor-frame" class="full-fill" src="#"></iframe>\r\n        </div>\r\n        <div id="screen-report">\r\n            <iframe id="screen-report-frame" class="full-fill" src="#"></iframe>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n'},,,,,,,,,,,,,,,function(e,r,t){"use strict";t.r(r);var n=t(3),i=t.n(n),o=t(9),s={insert:"head",singleton:!1},a=(i()(o.a,s),o.a.locals,t(18)),d=t.n(a),c=t(5);let l=0,u=(e,r)=>e+":"+r;class h extends c.a{constructor(){super(),this.senders=new Map,this.requests=new Map,window.addEventListener("message",e=>this.onMessage(e.data),!1)}addSender(e,r){if(this.senders.has(e))throw new Error(`Name "${e}" already exist!`);this.senders.set(e,r)}onMessage(e){try{let r=JSON.parse(e);if(!this.senders.get(r.sender))return void console.warn(`No such sender name "${name}"!`);null!=r.uid&&this.requests.has(r.uid)&&(this.requests.get(r.uid)(r.data),this.requests.delete(r.uid)),this.emit({type:u(r.sender,r.type),msg:r})}catch(e){console.warn(e)}}send(e,r,t){if(!this.senders.has(e))throw new Error(`Name "${e}" not exist!`);this.senders.get(e).contentWindow.postMessage(JSON.stringify({type:r,data:t}),window.location.href)}request(e,r,t){if(!this.senders.has(e))throw new Error(`Name "${e}" not exist!`);let n=this.senders.get(e);return new Promise(e=>{let i=l++;n.contentWindow.postMessage(JSON.stringify({type:r,data:t,uid:i}),window.location.href),this.requests.set(i,e)})}}var f=t(4);const v=new class extends h{constructor(){super(),this.element=document.createElement("div"),this.element.innerHTML=d.a,this._screensContainer=this.element.querySelector(".screen"),this._buttonSidebarToggle=this.element.querySelector("#btn-sidebar-toggle"),this._buttonSidebarToggle.addEventListener("click",()=>{let e=this.element.children[0];e.classList.contains("sidebar-on")?e.classList.remove("sidebar-on"):e.classList.add("sidebar-on")}),this.editor=this.element.querySelector("#screen-editor-frame"),this.editor.src="./frame.html?isEditor=1&senderName=editor",this.addSender("editor",this.editor),this.report=this.element.querySelector("#screen-report-frame"),this.report.src="./frame.html?isEditor=0&senderName=report",this.addSender("report",this.report),this.element.querySelector("#go-editor").addEventListener("click",this.showEditorScreen.bind(this)),this.element.querySelector("#go-report").addEventListener("click",this.showReportScreen.bind(this)),this.element.querySelector("#do-render").addEventListener("click",this.reloadReport.bind(this)),this.element.querySelector("#load-notebook").addEventListener("click",this.loadNotebook.bind(this)),this.element.querySelector("#save-notebook").addEventListener("click",this.saveNotebook.bind(this))}async loadNotebook(){const e=document.createElement("input");e.accept=".ltn",e.type="file",e.multiple=!1,document.body.appendChild(e);try{e.click(),e.onchange=r=>{let t=e.files[0];if(!t)return;let n=new FileReader;n.onload=e=>{let r=n.result,t=JSON.parse(r);this.initNotebookOnScreen("editor",t)},n.readAsText(t)}}catch(e){console.error(e)}e.remove()}async saveNotebook(){const e=await this.getNotebookFromScreen("editor"),r=JSON.stringify(e),t=new Blob([r],{type:"octet/stream"}),n=window.document.createElement("a");n.href=window.URL.createObjectURL(t),n.download="notebook.ltn",n.click()}async reloadReport(){let e=await this.getNotebookFromScreen("editor");await this.initNotebookOnScreen("report",e)}async getNotebookFromScreen(e){return await this.request(e,f.a.GET_NOTEBOOK)}async initNotebookOnScreen(e,r){if(!this.senders.has(e))throw new Error(`Name "${e}" not exist!`);let t=this.senders.get(e);await new Promise(e=>{t.contentWindow.location.reload(),t.onload=e}),await this.request(e,f.a.INIT_NOTEBOOK,r)}showEditorScreen(){this._screensContainer.classList.remove("report")}showReportScreen(){this._screensContainer.classList.add("report")}};document.body.appendChild(v.element)}]);