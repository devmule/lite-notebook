!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}([function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultBufferLength=1024;var s=function(){function t(t,e){this.enter=t,this.leave=e,this.result=void 0}return Object.defineProperty(t.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),t.prototype.doEnter=function(t,e,i){var r=this.enter(t,e,i);return void 0===r||(!1!==r&&(this.result=r),!1)},t}(),o=0,h=function(){function t(t){var e=(void 0===t?{}:t).deserialize;this.id=o++,this.deserialize=e||function(){throw new Error("This node type doesn't define a deserialize function")}}return t.string=function(){return new t({deserialize:function(t){return t}})},t.flag=function(){return new t({deserialize:function(){return!0}})},t.prototype.set=function(t,e){return t[this.id]=e,t},t.prototype.add=function(t){return new a(this,"function"==typeof t?t:l.match(t))},t.error=t.flag(),t.skipped=t.flag(),t.delim=t.string(),t.top=t.flag(),t.repeated=t.flag(),t}();e.NodeProp=h;var a=function(t,e){this.prop=t,this.f=e};e.NodePropSource=a;var l=function(){function t(t,e,i){this.name=t,this.props=e,this.id=i}return t.prototype.prop=function(t){return this.props[t.id]},t.match=function(t){var e=Object.create(null);for(var i in t)for(var r=0,n=i.split(" ");r<n.length;r++){var s=n[r];e[s]=t[i]}return function(t){return e[t.name]}},t.none=new t("",Object.create(null),0),t}();e.NodeType=l;var c=function(){function t(t){this.types=t;for(var e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node group")}return t.prototype.extend=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var r=[],n=0,s=this.types;n<s.length;n++){for(var o=s[n],h=null,a=0,c=e;a<c.length;a++){var u=c[a],f=u.f(o);if(void 0!==f){if(!h)for(var d in h=Object.create(null),o.props)h[d]=o.props[d];h[u.prop.id]=f}}r.push(h?new l(o.name,h,o.id):o)}return new t(r)},t}();e.NodeGroup=c;var u=function(){function t(){}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depth",{get:function(){for(var t=0,e=this.parent;e;e=e.parent)t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;t.parent;)t=t.parent;return t},enumerable:!0,configurable:!0}),t.prototype.resolve=function(t,e){void 0===e&&(e=0);var i=this.resolveAt(t);if(0!=e)for(;;){var r=e<0?i.childBefore(t):i.childAfter(t);if(!r||(e<0?r.end:r.start)!=t)break;i=r}return i},Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childAfter(this.start-1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.childBefore(this.end+1)},enumerable:!0,configurable:!0}),t}();e.Subtree=u;var f=function(t){function i(e,i,r,n){var s=t.call(this)||this;return s.type=e,s.children=i,s.positions=r,s.length=n,s}return n(i,t),Object.defineProperty(i.prototype,"start",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"end",{get:function(){return this.length},enumerable:!0,configurable:!0}),i.prototype.toString=function(){var t=this.children.map((function(t){return t.toString()})).join();return this.name?(/\W/.test(this.name)&&!this.type.prop(h.error)?JSON.stringify(this.name):this.name)+(t.length?"("+t+")":""):t},i.prototype.partial=function(t,e,r,n,s){for(var o=0;o<this.children.length;o++){var h=this.positions[o];if(h>e)break;var a=this.children[o],l=h+a.length;l<t||(t<=h&&e>=l?(n.push(a),s.push(h+r)):a instanceof i&&a.partial(t-h,e-h,r+h,n,s))}},i.prototype.applyChanges=function(t){if(0==t.length)return this;var e=[],r=[];function n(t,e,i){for(var r=t.resolve(e),n=e;;){var s=i<0?r.childBefore(n):r.childAfter(n);if(s)return i<0?s.end-1:s.start+1;if(!r.parent)return i<0?0:1e9;n=i<0?r.start:r.end,r=r.parent}}for(var s=0,o=0,h=0;;o++){var a=o==t.length?null:t[o],c=a?n(this,a.fromA,-1):this.length;if(c>h&&this.partial(h,c,s,e,r),!a)break;h=n(this,a.toA,1),s+=a.toB-a.fromB-(a.toA-a.fromA)}return new i(l.none,e,r,this.length+s)},i.prototype.cut=function(t){if(t>=this.length)return this;for(var e=[],r=[],n=0;n<this.children.length;n++){var s=this.positions[n];if(s>=t)break;var o=this.children[n],h=s+o.length;e.push(h<=t?o:o.cut(t-s)),r.push(s)}return new i(this.type,e,r,t)},i.prototype.iterate=function(t){var e=t.from,i=void 0===e?this.start:e,r=t.to,n=void 0===r?this.end:r,o=t.enter,h=t.leave,a=new s(o,h);return this.iterInner(i,n,0,a),a.result},i.prototype.iterInner=function(t,e,i,r){if(!this.type.name||r.doEnter(this.type,i,i+this.length)){if(t<=e)for(var n=0;n<this.children.length&&!r.done;n++){var s=this.children[n],o=(h=this.positions[n]+i)+s.length;if(h>e)break;o<t||s.iterInner(t,e,h,r)}else for(n=this.children.length-1;n>=0&&!r.done;n--){var h;s=this.children[n];if((o=(h=this.positions[n]+i)+s.length)<e)break;h>t||s.iterInner(t,e,h,r)}r.leave&&this.type.name&&r.leave(this.type,i,i+this.length)}},i.prototype.resolveAt=function(t){if(d==this)for(var e=p;;){var i=e.parent;if(!i)break;if(e.start<t&&e.end>t)return e.resolve(t);e=i}return d=this,p=this.resolveInner(t,0,this)},i.prototype.childBefore=function(t){return this.findChild(t,-1,0,this)},i.prototype.childAfter=function(t){return this.findChild(t,1,0,this)},i.prototype.findChild=function(t,e,r,n){for(var s=0;s<this.children.length;s++){var o=this.positions[s]+r,h=-1;if(o>=t)if(e<0&&s>0)h=s-1;else{if(!(e>0))break;h=s}if(h<0&&(o+this.children[s].length>t||e<0&&s==this.children.length-1)&&(h=s),h>=0){var a=this.children[h],l=this.positions[h]+r;if(0==a.length&&l==t)continue;if(a instanceof i)return a.type.name?new m(a,l,n):a.findChild(t,e,l,n);var c=a.findIndex(t,e,l,0,a.buffer.length);if(c>-1)return new O(a,l,c,n)}}return null},i.prototype.resolveInner=function(t,e,i){var r=this.findChild(t,0,e,i);return r?r.resolveAt(t):i},i.prototype.append=function(t){if(t.children.length&&t.positions[0]<this.length)throw new Error("Can't append overlapping trees");return new i(this.type,this.children.concat(t.children),this.positions.concat(t.positions),t.length)},i.prototype.balance=function(t){return void 0===t&&(t=e.DefaultBufferLength),this.children.length<=y?this:S(this.type,this.children,this.positions,0,this.children.length,0,t)},i.build=function(t,i,r,n,s){return void 0===r&&(r=0),void 0===n&&(n=e.DefaultBufferLength),void 0===s&&(s=[]),w(Array.isArray(t)?new v(t,t.length):t,i,r,n,s)},i.empty=new i(l.none,[],[],0),i}(u);e.Tree=f,f.prototype.parent=null;var d=f.empty,p=f.empty,g=function(){function t(t,e,i){this.buffer=t,this.length=e,this.group=i}return t.prototype.toString=function(){for(var t=[],e=0;e<this.buffer.length;)e=this.childToString(e,t);return t.join(",")},t.prototype.childToString=function(t,e){var i=this.buffer[t],r=this.buffer[t+3],n=this.group.types[i],s=n.name;if(/\W/.test(s)&&!n.prop(h.error)&&(s=JSON.stringify(s)),r>(t+=4)){for(var o=[];t<r;)t=this.childToString(t,o);s+="("+o.join(",")+")"}return e.push(s),t},t.prototype.cut=function(e){for(var i=0;i<this.buffer.length&&this.buffer[i+1]<e;)i+=4;for(var r=new Uint16Array(i),n=0;n<i;n+=4)r[n]=this.buffer[n],r[n+1]=this.buffer[n+1],r[n+2]=Math.min(e,this.buffer[n+2]),r[n+3]=Math.min(this.buffer[n+3],i);return new t(r,Math.min(e,this.length),this.group)},t.prototype.iterInner=function(t,e,i,r){if(t<=e)for(var n=0;n<this.buffer.length;)n=this.iterChild(t,e,i,n,r);else this.iterRev(t,e,i,0,this.buffer.length,r)},t.prototype.iterChild=function(t,e,i,r,n){var s=this.group.types[this.buffer[r++]],o=this.buffer[r++]+i,h=this.buffer[r++]+i,a=this.buffer[r++];if(o>e)return this.buffer.length;if(h>=t&&n.doEnter(s,o,h)){for(;r<a&&!n.done;)r=this.iterChild(t,e,i,r,n);n.leave&&n.leave(s,o,h)}return a},t.prototype.parentNodesByEnd=function(t,e){for(var i=this,r=[],n=function(t){var e=i.buffer[t+3];if(e==t+4)return e;for(var s=t+4;s<e;)s=n(s);return r.push(t),e},s=t;s<e;)s=n(s);return r},t.prototype.iterRev=function(t,e,i,r,n,s){var o=this,h=this.parentNodesByEnd(r,n),a=-1,l=-1,c=function(){h.length>0?(a=h.pop(),l=o.buffer[a+3]):l=-1};c();t:for(var u=n;u>r&&!s.done;){for(;l==u;){var f=a,d=this.buffer[f],p=this.buffer[f+1]+i,g=this.buffer[f+2]+i;if(c(),p<=t&&g>=e&&!s.doEnter(this.group.types[d],p,g)){for(u=f;l>f;)c();continue t}}var m=this.buffer[--u],O=this.buffer[--u]+i,v=this.buffer[--u]+i,y=this.buffer[--u];v>t||O<e||(m!=u+4||s.doEnter(this.group.types[y],v,O))&&s.leave&&s.leave(this.group.types[y],v,O)}},t.prototype.findIndex=function(t,e,i,r,n){for(var s=-1,o=r,h=this.buffer;o<n;){var a=h[o+1]+i,l=h[o+2]+i,c=a==l&&a==t;if(a>=t){if(e>0&&!c)return o;break}if(l>t)return o;c||(s=o),o=h[o+3]}return e<0?s:-1},t}();e.TreeBuffer=g;var m=function(t){function e(e,i,r){var n=t.call(this)||this;return n.node=e,n.start=i,n.parent=r,n}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.node.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.start+this.node.length},enumerable:!0,configurable:!0}),e.prototype.resolveAt=function(t){return t<=this.start||t>=this.end?this.parent.resolveAt(t):this.node.resolveInner(t,this.start,this)},e.prototype.childBefore=function(t){return this.node.findChild(t,-1,this.start,this)},e.prototype.childAfter=function(t){return this.node.findChild(t,1,this.start,this)},e.prototype.toString=function(){return this.node.toString()},e.prototype.iterate=function(t){var e=t.from,i=void 0===e?this.start:e,r=t.to,n=void 0===r?this.end:r,o=t.enter,h=t.leave,a=new s(o,h);return this.node.iterInner(i,n,this.start,a),a.result},e}(u),O=function(t){function e(e,i,r,n){var s=t.call(this)||this;return s.buffer=e,s.bufferStart=i,s.index=r,s.parent=n,s}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.buffer.group.types[this.buffer.buffer[this.index]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.buffer.buffer[this.index+1]+this.bufferStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.buffer.buffer[this.index+2]+this.bufferStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endIndex",{get:function(){return this.buffer.buffer[this.index+3]},enumerable:!0,configurable:!0}),e.prototype.childBefore=function(t){var i=this.buffer.findIndex(t,-1,this.bufferStart,this.index+4,this.endIndex);return i<0?null:new e(this.buffer,this.bufferStart,i,this)},e.prototype.childAfter=function(t){var i=this.buffer.findIndex(t,1,this.bufferStart,this.index+4,this.endIndex);return i<0?null:new e(this.buffer,this.bufferStart,i,this)},e.prototype.iterate=function(t){var e=t.from,i=void 0===e?this.start:e,r=t.to,n=void 0===r?this.end:r,o=t.enter,h=t.leave,a=new s(o,h);return i<=n?this.buffer.iterChild(i,n,this.bufferStart,this.index,a):this.buffer.iterRev(i,n,this.bufferStart,this.index,this.endIndex,a),a.result},e.prototype.resolveAt=function(t){if(t<=this.start||t>=this.end)return this.parent.resolveAt(t);var i=this.buffer.findIndex(t,0,this.bufferStart,this.index+4,this.endIndex);return i<0?this:new e(this.buffer,this.bufferStart,i,this).resolveAt(t)},e.prototype.toString=function(){var t=[];return this.buffer.childToString(this.index,t),t.join("")},e}(u),v=function(){function t(t,e){this.buffer=t,this.index=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pos",{get:function(){return this.index},enumerable:!0,configurable:!0}),t.prototype.next=function(){this.index-=4},t.prototype.fork=function(){return new t(this.buffer,this.index)},t}(),y=8,b=h.repeated;function w(t,e,i,r,n){var s=e.types;function o(i,a,l,c){var u,d=t.id,p=t.start,m=t.end,O=t.size,v=p-i;if(O<0)return l.push(n[d]),c.push(v),void t.next();var w,x=s[d];if(m-p<=r&&(u=function(e,i){var n=t.fork(),o=0,h=0,a=0,l=n.end-r;t:for(var c=n.pos-e;n.pos>c;){var u=n.size,f=n.pos-u;if(u<0||f<c||n.start<l||i>-1&&n.id!=i)break;var d=s[n.id].prop(b)?4:0,p=n.start;for(n.next();n.pos>f;){if(n.size<0)break t;s[n.id].prop(b)&&(d+=4),n.next()}h=p,o+=u,a+=d}return o>4?{size:o,start:h,skip:a}:null}(t.pos-a,x.prop(b)?d:-1))){for(var k=new Uint16Array(u.size-u.skip),P=t.pos-u.size,A=k.length;t.pos>P;)A=h(u.start,k,A);w=new g(k,m-u.start,e),x.prop(b)&&(w=new f(x,[w],[0],m-u.start)),v=u.start-i}else{P=t.pos-O;t.next();for(var T=[],Q=[];t.pos>P;)o(p,P,T,Q);T.reverse(),Q.reverse(),w=new f(x,T,Q,m-p)}l.push(w),c.push(v),!x.prop(b)||0!=t.pos&&t.id==d||function(t,e,i){for(var n=t.length,s=n-1;s>0;s--){var o=t[s-1];if(!(o instanceof f)||o.type!=i)break}if(n-s<y)return;var h=e[n-1],a=S(i,t.slice(s,n).reverse(),e.slice(s,n).reverse(),0,n-s,h,r);t.length=e.length=s+1,t[s]=a,e[s]=h}(l,c,x)}function h(e,i,r){var n=t.id,o=t.start,a=t.end,l=t.size;t.next();var c=r;if(l>4)for(var u=t.pos-(l-4);t.pos>u;)r=h(e,i,r);return s[n].prop(b)||(i[--r]=c,i[--r]=a-e,i[--r]=o-e,i[--r]=n),r}for(var a=[],l=[];t.pos>0;)o(0,0,a,l);var c=a.length?l[0]+a[0].length:0;return new f(e.types[i],a.reverse(),l.reverse(),c)}function S(t,e,i,r,n,s,o){var h=i[n-1]+e[n-1].length-s;if(r==n-1&&0==s){var a=e[r];if(a instanceof f)return a}var l=[],c=[];if(h<=o)for(var u=r;u<n;u++)l.push(e[u]),c.push(i[u]-s);else{var d=Math.max(o,Math.ceil(1.5*h/y));for(u=r;u<n;){var p=u,g=i[u];for(u++;u<n;u++){if(i[u]+e[u].length-g>d)break}if(u==p+1){var m=e[p];if(m instanceof f&&m.type==t){if(m.length>d<<1){for(var O=0;O<m.children.length;O++)l.push(m.children[O]),c.push(m.positions[O]+g-s);continue}}else m=new f(t,[m],[0],m.length);l.push(m)}else l.push(S(t,e,i,p,u,g,o));c.push(g-s)}}return new f(t,l,c,h)}},function(t,e,i){"use strict";(function(t){function r(t,e){return"undefined"==typeof Symbol?"__"+t+(e?Math.floor(1e8*Math.random()):""):e?Symbol(t):Symbol.for(t)}i.d(e,"a",(function(){return a}));const n=r("ͼ"),s=r("styleSet",1),o=r("rules",1),h=void 0===t?window:t;function a(t,e){this[o]=[];for(let i in t){let r=t[i],n=r.specificity||0;if(/^@/.test(i)){this[o].push(i+" {"+d(r)+"}");continue}let s=a.newName(),h=i;if(!1!==(e&&e.generateClasses)){let t=s;h="."+s;for(let e=0;e<n;e++){let i="ͼ_"+(e?e.toString(36):"");h+="."+i,t+=" "+i}this[i]=t}f(h,t[i],this[o])}}a.newName=()=>{let t=h[n]||1;return h[n]=t+1,"ͼ"+t.toString(36)},a.prototype=Object.create(null),a.mount=function(t,e){(t[s]||new c(t)).mount(Array.isArray(e)?e:[e])};let l=null;class c{constructor(t){if(t.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(l)return t.adoptedStyleSheets=[l.sheet].concat(t.adoptedStyleSheets),t[s]=l;this.sheet=new CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets),l=this}else{this.styleTag=(t.ownerDocument||t).createElement("style");let e=t.head||t;e.insertBefore(this.styleTag,e.firstChild)}this.modules=[],t[s]=this}mount(t){let e=this.sheet,i=0,r=0;for(let n=0;n<t.length;n++){let s=t[n],h=this.modules.indexOf(s);if(h<r&&h>-1&&(this.modules.splice(h,1),r--,h=-1),-1==h){if(this.modules.splice(r++,0,s),e)for(let t=0;t<s[o].length;t++)e.insertRule(s[o][t],i++)}else{for(;r<h;)i+=this.modules[r++][o].length;i+=s[o].length,r++}}if(!e){let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e][o].join("\n")+"\n";this.styleTag.textContent=t}}}function u(t,e){return e.split(/\s*,\s*/).map(e=>{let i=e.indexOf("/*|*/");return(i<0?"":e.slice(0,i+5))+t.replace(/&/g,i<0?e:e.slice(i+5))}).join(", ")}function f(t,e,i){if("object"!=typeof e)throw new RangeError("Expected style object, got "+JSON.stringify(e));let r=[];for(let n in e)if(/^@/.test(n)){let r=[];f(t,e[n],r),i.push(n+" {"+r.join(" ")+"}")}else if(/&/.test(n))f(u(n,t),e[n],i);else if("specificity"!=n){if("object"==typeof e[n])throw new RangeError("The value of a property ("+n+") should be a primitive value.");r.push(n.replace(/_.*/,"").replace(/[A-Z]/g,t=>"-"+t.toLowerCase())+": "+e[n])}r.length&&i.push(t+" {"+r.join("; ")+"}")}function d(t){let e="";for(let i in t){e&&(e+=/}$/.test(e)?" ":"; ");let r=t[i];e+="object"==typeof r?i+" {"+d(r)+"}":i+": "+r}return e}}).call(this,i(6))},function(t,e,i){"use strict";var r=i(4),n=i.n(r)()((function(t){return t[1]}));n.push([t.i,"/* DEFAULT THEME */\r\n\r\n.cm-keyword {color: #708;}\r\n.cm-atom {color: #219;}\r\n.cm-number {color: #164;}\r\n.cm-def {color: #00f;}\r\n.cm-variable,\r\n.cm-punctuation,\r\n.cm-property,\r\n.cm-operator {}\r\n.cm-variable-2 {color: #05a;}\r\n.cm-variable-3, .cm-type {color: #085;}\r\n.cm-comment {color: #a50;}\r\n.cm-string {color: #a11;}\r\n.cm-string-2 {color: #f50;}\r\n.cm-meta {color: #555;}\r\n.cm-qualifier {color: #555;}\r\n.cm-builtin {color: #30a;}\r\n.cm-bracket {color: #997;}\r\n.cm-tag {color: #170;}\r\n.cm-attribute {color: #00c;}\r\n.cm-hr {color: #999;}\r\n.cm-link {color: #00c;}\r\n.codemirror { height: 300px; overflow: auto; border: 1px solid silver}\r\n.codemirror-matching-bracket { background: red; }\r\n.codemirror-nonmatching-bracket { background: green; }\r\n",""]),e.a=n},function(t,e,i){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},s=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),o=[];function h(t){for(var e=-1,i=0;i<o.length;i++)if(o[i].identifier===t){e=i;break}return e}function a(t,e){for(var i={},r=[],n=0;n<t.length;n++){var s=t[n],a=e.base?s[0]+e.base:s[0],l=i[a]||0,c="".concat(a," ").concat(l);i[a]=l+1;var u=h(c),f={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(o[u].references++,o[u].updater(f)):o.push({identifier:c,updater:m(f,e),references:1}),r.push(c)}return r}function l(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var o=s(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var c,u=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function f(t,e,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=u(e,n);else{var s=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}function d(t,e,i){var r=i.css,n=i.media,s=i.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var p=null,g=0;function m(t,e){var i,r,n;if(e.singleton){var s=g++;i=p||(p=l(e)),r=f.bind(null,i,s,!1),n=f.bind(null,i,s,!0)}else i=l(e),r=d.bind(null,i,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=n());var i=a(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<i.length;r++){var n=h(i[r]);o[n].references--}for(var s=a(t,e),l=0;l<i.length;l++){var c=h(i[l]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}i=s}}}},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,r){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(r)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(n[o]=!0)}for(var h=0;h<t.length;h++){var a=[].concat(t[h]);r&&n[a[0]]||(i&&(a[2]?a[2]="".concat(i," and ").concat(a[2]):a[2]=i),e.push(a))}},e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(7);const n=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];function s(t){return t>=65&&t<=90||t>=97&&t<=122||t>=161}const o=new r.ExternalTokenizer((t,e)=>{let i=e.start,r=i,n=!1;for(;;){let h=t.get(r);if(!(s(h)||45==h||95==h||n&&(o=h,o>=48&&o<=57))){n&&e.accept(40==h?94:95,r);break}!n&&(45!=h||r>i)&&(n=!0),r++}var o}),h=new r.ExternalTokenizer((t,e)=>{if(n.includes(t.get(e.start-1))){let i=t.get(e.start);(s(i)||95==i||35==i||46==i||91==i||58==i||45==i)&&e.accept(93,e.start)}}),a=new r.ExternalTokenizer((t,e)=>{let{start:i}=e;if(!n.includes(t.get(i-1))){let r=t.get(i);if(37==r&&e.accept(2,i+1),s(r)){let r=i+1;for(;s(t.get(r));)r++;e.accept(2,r)}}}),l=r.Parser.deserialize({states:"7^OVO[OOOUOW'#Cc'#CcOUOW'#Cb'#CbO!SO[O'#CeO!WOXO'#C`O!tO[O'#CgO#OO[O'#C}O#SO[O'#DQOUOW'#Ec'#EcO#WOdO'#DdO#nO[O'#DqO#WOdO'#DsO$OO[O'#DuO$YO[O'#DxO$^O[O'#EOO$kO[O'#EQOUOW'#Eb'#EbOUOW(3Be(3BeQVO[OOOUOW'#Cf'#CfOUOW,59P,59PO!SO[O,59PO%OOWO'#EfO%YO[O'#ESO%pO[O,59RO#OO[O,59iO#SO[O,59lO%YO[O,59qO%YO[O,59sO%YO[O,59tO%zOWO,58zOUOW'#Ci'#CiOUOW'#Co'#CoOUOW,59R,59RO&OOWO,59RO&SOWO,59ROUOW'#DP'#DPOUOW,59i,59iOUOW'#DS'#DSO&WOWO,59lOUO`'#Cq'#CqO#WOdO'#CrO&_OfO'#CtO'eOdO,5:OOUOW'#Cy'#CyO&SOWO'#CxO'xOWO'#CzOUO`'#Eh'#EhOUOW'#Dg'#DgO'|O[O'#DnO(ZOWO'#EnO$^O[O'#DlO(hOWO'#DoOUOW'#Eo'#EoO%zOWO,5:]O(lO`O,5:_OUOW'#Dw'#DwO(sOWO,5:aO(wO[O,5:aOUOW'#Dz'#DzO)OOWO,5:dO)SOWO,5:jO)ZOWO,5:lOUOW,5:m,5:mOUOW1G.k1G.kOUOW,5:n,5:nO)bOXO-E8QOUOW1G.m1G.mO&OOWO1G.mO&SOWO1G.mOUOW1G/T1G/TO*ROWO1G/WO*YOXO1G/]O*yOXO1G/_O+jOXO1G/`O,ZO[O'#D[OUOW1G.f1G.fO-^O[O'#CkO-wOdO'#CpOUOW1G/W1G/WO#WOdO1G/WO.bO`O,59^OUO`,59`,59`O#WOdO,59bO.iOWO1G/jOUO`,59d,59dO.mOpO,59fO.tO`O'#DgO/OO`O,5:SO/SOWO,5:YO$^O[O,5:UO/ZOWO'#EpO$^O[O'#EYOUOW,5;Y,5;YO/eOWO,5:WO%YO[O,5:ZOUOW1G/w1G/wOUOW1G/y1G/yOUOW1G/{1G/{O/uOWO1G/{O/yOdO'#D{OUOW1G0O1G0OOUOW1G0U1G0UOUOW1G0W1G0WOUOW7+$X7+$XOUOW7+$r7+$rO#WOdO7+$rO0WO[O'#EkOUOW(3Bi(3BiO1ZO[O,59vO1bOXO'#EeO2OOWO,59VO2SOdO(3BgO2sOdO'#EgO3aOWO,59[O3eO`O7+$rOUO`1G.x1G.xOUO`1G.|1G.|OUOW7+%U7+%UO3lOWO1G/QO#WOdO1G/nOUOW1G/t1G/tOUOW1G/p1G/pOUOW,5:t,5:tO3pOWO-E8WO3}OXO1G/uOUOW7+%g7+%gO4hOYO'#CtO4oOdO'#EqO%zOWO'#EZO4|OWO,5:gO5QO`O<<H^OUOW,5:q,5:qOUO`'#D_'#D_O5XO`O'#D^OUOW1G/b1G/bO5]OWO1G/bOUOW,5;P,5;POUOW1G.q1G.qOUO`,5:o,5:oO5dOWO'#EjO#WOdO'#EUOUOW,5;R,5;ROUOW1G.v1G.vOUOW<<H^<<H^OUO`7+$l7+$lO5kOdO7+%YOUOW7+%a7+%aOUO`,5:u,5:uOUO`-E8X-E8XOUOW1G0R1G0ROUOWAN=xAN=xO#WOdO,59xO6UOWO'#EmO6]O[O'#EXO7cOWO7+$|OUOW,5:p,5:pO7gOdO-E8SOUOW<<Ht<<HtO8TOdO1G/dOUOW,5:s,5:sO8zO[O-E8VOUOW<<Hh<<HhO9UOdO(3BjO9{OdO'#ElO#WOdO'#EWO:oOWO7+%OOUOW3)-q3)-qOUO`,5:r,5:rO:yOdO-E8UOUOW<<Hj<<Hj",stateData:";{ROS#TOS~TWOWWO[TOrUOuVO!X_O!YXO!fYO!hZO!j[O!m]O!s^O#RPO#WRO~#RcO~[hOagOriOujOzkO}mO#PlO#WeO!P#YP~^rO#QpO#RoO~#RtO~#RvO~`yOg!POi!POo!OO#Q|O#RxO#]zO~`!RO!a!TO!d!UO#R!QO!P#bP~i!ZOo!OO#R!YO~#R!]O~`!RO!a!TO!d!UO#R!QO~`!RO!a!TO!d!UO#R!QO!P#bP!U#bP~agO!P#YXb#YX~TWOWWO[TOrUOuVO#RPO#WRO~^!fO#QpO#RoO~!P!mO~`!oO~`!pO~w!rOx!qO~Q!tO`hXkhX!UhX!ahX!dhX#RhXbhXahXghXihXohX#QhX#]hXxhX!ThX!VhX~`!ROk!uO!a!TO!d!UO#R!QO!U#bP~`!xO~`!RO!a!TO!d!UO#R!yO~a#OO!_!|O!P#dP!U#dP~`#RO~k!uO!U#TO~!U#UO~i#VOo!OO~!P#WO~!P!mO!_!|O~!P!mO!U#ZO~[hOriOujOzkO}mO#PlO#WeOa!vc!P!vcb!vc~w#^Ox#]O~[hOriOujO#WeOayizyi}yi!Pyi#Pyibyi~[hOriOujO#WeOa{iz{i}{i!P{i#P{ib{i~[hOriOujO#WeOa|iz|i}|i!P|i#P|ib|i~TWOWWO[TOrUOuVO!X_O!YXO!fYO!hZO!j[O!m]O!s^O#RPO#WRO!V#_P#R#_P~TWOWWO[TOrUOuVO#RPO#WROb#XP~`yOg!POi!POo!OO#Q|O#RxO#]zOb#ZP~b#hOk!uO~!U#jO~i#kOp#kO~b!ZX!S!]X!_!ZX~!S#lO~b#mO!_!|O~a#OO!P#dX!U#dX~!_!|Oa!`a!P!`a!U!`ab!`a~!U#rO~!p#uO!q#uO#]#sO!V#eP~TWOWWO[TOrUOuVO!X_O!YXO!fYO!hZO!j[O!m]O!s^O#RPO#WRO!V#_X!U#_X~!V#{O#R#yO~[hOagOriOujOzkO}mO#PlO#WeOb#YP~b$OO~k!uO`!wZa!wZb!wZg!wZi!wZo!wZ#Q!wZ#R!wZ#]!wZ~`yOa$ROg!POi!POo!OO#Q|O#RxO#]zOb#^P~b$TO~k!uOx$UO~b$VO~!_!|Oa!|c!P!|c!U!|c~[hOb$XOriOujOzkO}mO#PlO#WeO~Q!tO!PhX~!p#uO!q#uO#]#sO!V#eX~!V$[O~k!uOx$]O~!S$^O~!U$`O!V#aP~a$ROb#^X~`yOb$dOg!POi!POo!OO#Q|O#RxO#]zO~!U$`O!V#aX~TWOWWO[TOrUOuVO!X_O!YXO!fYO!hZO!j[O!m]O!s^O#RPO#WRO!U#_P!V#_P#R#_P~!V$hO~`yOg!POi!POo!OO#Q|O#RxO#]zOa!xcb!xc~`yOa$kOg!POi!POk!uOo!OO#Q|O#RxO#]zO!T#`P!U#`P!V#`P~#R#yO!U!{c!V!{c~k!uO`!zZa!zZg!zZi!zZo!zZ!T!zZ!U!zZ!V!zZ#Q!zZ#R!zZ#]!zZ~`yOa$kOg!POi!POo!OO#Q|O#RxO#]zO!T#`X!U#`X!V#`X~!T$pO!U!Qq!V!Qq~k!uO`!zca!zcg!zci!zco!zc!T!zc!U!zc!V!zc#Q!zc#R!zc#]!zc~#TpR#]k}~#Q!X#R~",goto:",[#fPPPP#gP#n#{P#n$Y#nP$`P$fPPP$l$r${${P%_P${P${%u&XPP#nP&q#nP&wPP#nP#n#nP&}P'^'dPPPP#gPP'h'h'r'hP'hP'h'hP#gP#gP#gP'u#gP'x'{PP#gP#g(O(U(](k(q(x)O)U)[PPPPPP)b)kP*U*X*_*bP+W+Z+a+d+g+p,U,XZ`Ob!m#_$`gWObgklm!m!o#R#_$`gQObgklm!m!o#R#_$`QdRR!beQqTR!ehQ!erR#[!fQsTR!ghQ!esQ!w}R#[!gq!PXZy!p!r!u#^#e#l$R$W$^$c$e$j$kp!PXZy!p!r!u#^#e#l$R$W$^$c$e$j$kT#u#W#tq}XZy!p!r!u#^#e#l$R$W$^$c$e$j$kp!PXZy!p!r!u#^#e#l$R$W$^$c$e$j$kQ!Z[R#V![QuUR!hiQwVR!ijQ!nnQ#S!WQ#Y!_Q#Z!`R$Z#uQ#|#aR$m$gT#z#a$ga!VY^_{!R!T!|#OR!z!RR![[R!^]R#X!^QbOR!abSfS#bR!cfQ#e!pU$P#e$W$cQ$W#lR$c$RQ$Q#eR$b$QS#_!m$`R#x#_Q$j$eR$n$jQ$_#|R$f$_Q!}!SR#o!}Q#t#WR$Y#tSaObV#`!m#_$`YSOb!m#_$`Q!dgQ!jkQ!klQ!lmQ#b!oR#q#RR#c!oQnSR#}#bR#f!pQ{XQ!XZQ!sy[#d!p#e#l$R$W$cQ#g!rQ#i!uQ#w#^Q$e$^S$i$e$jR$o$kR$S#eQ#a!mR$g$`R$l$eR$a#|Q!WYQ!`_R!v{U!SY_{Q!_^Q!{!RQ#Q!TQ#n!|R#p#OR#P!SR#v#W",nodeNames:"⚠ StyleSheet Unit Comment RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector PseudoOp PseudoClassName not ArgList ( , ) PseudoClassName ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent IdSelector # IdName AttributeSelector [ AttributeName MatchOp ] ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp Block { Declaration PropertyName : Important ; } ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery callee MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList from to SupportsStatement supports AtRule",nodeProps:[[r.NodeProp.delim,15,"( )",20,"( )",22,"( )",46,"{ }",58,"( )",64,"( )",77,"{ }"]],repeatNodeCount:9,tokenData:"Bl~R![OX$wX^%]^p$wpq%]qr(crs+}st,otu2Uuv$wvw2rwx2}xy3jyz3uz{3z{|4_|}8u}!O9Q!O!P9i!P!Q9z!Q![<U![!]<y!]!^=k!^!_$w!_!`=v!`!a>R!a!b$w!b!c>q!c!}$w!}#O?}#O#P$w#P#Q@Y#Q#R2U#R#T$w#T#U@e#U#c$w#c#dAd#d#o$w#o#pAs#p#q2U#q#rBO#r#sBZ#s#y$w#y#z%]#z$f$w$f$g%]$g#BY$w#BY#BZ%]#BZ$IS$w$IS$I_%]$I_$I|$w$I|$JO%]$JO$JT$w$JT$JU%]$JU$KV$w$KV$KW%]$KW&FU$w&FU&FV%]&FV~$wS$zQOy%Qz~%QS%VQpSOy%Qz~%Q~%bf#T~OX%QX^&v^p%Qpq&vqy%Qz#y%Q#y#z&v#z$f%Q$f$g&v$g#BY%Q#BY#BZ&v#BZ$IS%Q$IS$I_&v$I_$I|%Q$I|$JO&v$JO$JT%Q$JT$JU&v$JU$KV%Q$KV$KW&v$KW&FU%Q&FU&FV&v&FV~%Q~&}f#T~pSOX%QX^&v^p%Qpq&vqy%Qz#y%Q#y#z&v#z$f%Q$f$g&v$g#BY%Q#BY#BZ&v#BZ$IS%Q$IS$I_&v$I_$I|%Q$I|$JO&v$JO$JT%Q$JT$JU&v$JU$KV%Q$KV$KW&v$KW&FU%Q&FU&FV&v&FV~%QV(fSOy%Qz#]%Q#]#^(r#^~%QV(wSpSOy%Qz#a%Q#a#b)T#b~%QV)YSpSOy%Qz#d%Q#d#e)f#e~%QV)kSpSOy%Qz#c%Q#c#d)w#d~%QV)|SpSOy%Qz#f%Q#f#g*Y#g~%QV*_SpSOy%Qz#h%Q#h#i*k#i~%QV*pSpSOy%Qz#T%Q#T#U*|#U~%QV+RSpSOy%Qz#b%Q#b#c+_#c~%QV+dSpSOy%Qz#h%Q#h#i+p#i~%QV+wQ!TRpSOy%Qz~%Q~,QUOY+}Zr+}rs,ds#O+}#O#P,i#P~+}~,iOi~~,lPO~+}V,tWrPOy%Qz!Q%Q!Q![-^![!c%Q!c!i-^!i#T%Q#T#Z-^#Z~%QU-cWpSOy%Qz!Q%Q!Q![-{![!c%Q!c!i-{!i#T%Q#T#Z-{#Z~%QU.QWpSOy%Qz!Q%Q!Q![.j![!c%Q!c!i.j!i#T%Q#T#Z.j#Z~%QU.qWgQpSOy%Qz!Q%Q!Q![/Z![!c%Q!c!i/Z!i#T%Q#T#Z/Z#Z~%QU/bWgQpSOy%Qz!Q%Q!Q![/z![!c%Q!c!i/z!i#T%Q#T#Z/z#Z~%QU0PWpSOy%Qz!Q%Q!Q![0i![!c%Q!c!i0i!i#T%Q#T#Z0i#Z~%QU0pWgQpSOy%Qz!Q%Q!Q![1Y![!c%Q!c!i1Y!i#T%Q#T#Z1Y#Z~%QU1_WpSOy%Qz!Q%Q!Q![1w![!c%Q!c!i1w!i#T%Q#T#Z1w#Z~%QU2OQgQpSOy%Qz~%QT2XSOy%Qz!_%Q!_!`2e!`~%QT2lQwPpSOy%Qz~%QT2wQWPOy%Qz~%Q~3QUOY2}Zw2}wx,dx#O2}#O#P3d#P~2}~3gPO~2}V3oQ`ROy%Qz~%Q~3zOb~V4RSTPkQOy%Qz!_%Q!_!`2e!`~%QV4fUkQ}POy%Qz!O%Q!O!P4x!P!Q%Q!Q![7_![~%QU4}SpSOy%Qz!Q%Q!Q![5Z![~%QU5bWpS#]QOy%Qz!Q%Q!Q![5Z![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%QU6PWpSOy%Qz{%Q{|6i|}%Q}!O6i!O!Q%Q!Q![6z![~%QU6nSpSOy%Qz!Q%Q!Q![6z![~%QU7RSpS#]QOy%Qz!Q%Q!Q![6z![~%QU7fYpS#]QOy%Qz!O%Q!O!P8U!P!Q%Q!Q![7_![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%QU8]WpS#]QOy%Qz!Q%Q!Q![8U![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%QV8zQaROy%Qz~%QU9VUkQOy%Qz!O%Q!O!P4x!P!Q%Q!Q![7_![~%QV9nS#WPOy%Qz!Q%Q!Q![5Z![~%Q~:PRkQOy%Qz{:Y{~%Q~:_SpSOy:Yyz:kz{;`{~:Y~:nROz:kz{:w{~:k~:zTOz:kz{:w{!P:k!P!Q;Z!Q~:k~;`OR~~;eUpSOy:Yyz:kz{;`{!P:Y!P!Q;w!Q~:Y~<OQpSR~Oy%Qz~%QU<ZY#]QOy%Qz!O%Q!O!P8U!P!Q%Q!Q![7_![!g%Q!g!h5z!h#X%Q#X#Y5z#Y~%QV=QS!SQ[POy%Qz![%Q![!]=^!]~%QT=eQ[PpSOy%Qz~%QV=pQ!UROy%Qz~%QT={QwPOy%Qz~%QT>WSzPOy%Qz!`%Q!`!a>d!a~%QT>kQzPpSOy%Qz~%QT>tUOy%Qz!c%Q!c!}?W!}#T%Q#T#o?W#o~%QT?_Y!XPpSOy%Qz}%Q}!O?W!O!Q%Q!Q![?W![!c%Q!c!}?W!}#T%Q#T#o?W#o~%QT@SQuPOy%Qz~%QV@_QxROy%Qz~%QV@hSOy%Qz#b%Q#b#c@t#c~%QV@ySpSOy%Qz#W%Q#W#XAV#X~%QVA^Q!_RpSOy%Qz~%QVAgSOy%Qz#f%Q#f#gAV#g~%QTAxQ!PPOy%Qz~%QVBTQ!VROy%Qz~%QTB`S}POy%Qz!_%Q!_!`2e!`~%Q",tokenizers:[h,a,o,0,1,2],specializeTable:1235,specializations:[{not:28,url:62,"url-prefix":62,domain:62,regexp:62,selector:132},{"@import":112,"@media":136,"@charset":140,"@namespace":144,"@keyframes":150,"@supports":162},{not:126,only:126,from:156,to:158}],tokenPrec:1228});e.parser=l},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r,n=i(0),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */!function(t){t[t.Unit=1e6]="Unit",t[t.Deduplicate=2e6]="Deduplicate",t[t.MaxRecoverStacks=25]="MaxRecoverStacks",t[t.TooBadToRecover=5e6]="TooBadToRecover",t[t.RecoverSiblingFactor=3]="RecoverSiblingFactor",t[t.MaxParallelBufferLength=800]="MaxParallelBufferLength"}(r||(r={}));var o,h=function(){function t(t,e,i,r,n,s,o,h,a){this.cx=t,this.stack=e,this.state=i,this.reducePos=r,this.pos=n,this.badness=s,this.buffer=o,this.bufferBase=h,this.parent=a}return t.prototype.toString=function(){return"["+this.stack.filter((function(t,e){return e%3==0})).concat(this.state).join(",")+"]"},t.start=function(e,i){return void 0===i&&(i=0),new t(e,[],e.parser.states[0],i,i,0,[],0,null)},t.prototype.pushState=function(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t},t.prototype.reduce=function(t){var e=t>>19,i=65535&t,r=this.cx.parser;if(0==e)return i<=r.maxNode&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.pushState(r.getGoto(this.state,i,!0),this.reducePos);var s=this.stack.length-3*(e-1)-(262144&t?6:0),o=this.stack[s-2],h=this.stack[s-1],a=this.bufferBase+this.buffer.length-h;if(i<=r.maxNode&&(131072&t||!r.group.types[i].prop(n.NodeProp.repeated))){var l=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,o,l,a+4,!0)}if(262144&t)this.state=this.stack[s];else{var c=this.stack[s-3];this.state=r.getGoto(c,i,!0)}for(;this.stack.length>s;)this.stack.pop()},t.prototype.storeNode=function(t,e,i,r,n){if(void 0===r&&(r=4),void 0===n&&(n=!1),0==t){var s=this,o=this.buffer.length;if(0==o&&s.parent&&(o=s.bufferBase-s.parent.bufferBase,s=s.parent),o>0&&0==s.buffer[o-4]&&s.buffer[o-1]>-1){if(e==i)return;if(s.buffer[o-2]>=e)return void(s.buffer[o-2]=i)}}if(n&&this.pos!=i){var h=this.buffer.length;if(h>0&&0!=this.buffer[h-4])for(;h>0&&this.buffer[h-2]>i;)this.buffer[h]=this.buffer[h-4],this.buffer[h+1]=this.buffer[h-3],this.buffer[h+2]=this.buffer[h-2],this.buffer[h+3]=this.buffer[h-1],h-=4,r>4&&(r-=4);this.buffer[h]=t,this.buffer[h+1]=e,this.buffer[h+2]=i,this.buffer[h+3]=r}else this.buffer.push(t,e,i,r)},t.prototype.shift=function(t,e,i){if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){var r=this.pos,n=t,s=this.cx.parser;i>this.pos&&(this.badness=(this.badness>>1)+(this.badness>>2)),(i>this.pos||e<=s.maxNode)&&(this.pos=i,s.stateFlag(n,1)||(this.reducePos=i)),this.pushState(n,r),e<=s.maxNode&&this.buffer.push(e,r,i,4)}else e<=this.cx.parser.maxNode&&this.buffer.push(e,this.pos,i,4),this.pos=i},t.prototype.apply=function(t,e,i){65536&t?this.reduce(t):this.shift(t,e,i)},t.prototype.useNode=function(t,e){var i=this.cx.reused.length-1;(i<0||this.cx.reused[i]!=t)&&(this.cx.reused.push(t),i++);var r=this.pos;this.reducePos=this.pos=r+t.length,this.pushState(e,r),this.badness>>=2,this.buffer.push(i,r,this.reducePos,-1)},t.prototype.split=function(){for(var e=this,i=e.buffer.length;i>0&&e.buffer[i-2]>e.reducePos;)i-=4;for(var r=e.buffer.slice(i),n=e.bufferBase+i;e&&n==e.bufferBase;)e=e.parent;return new t(this.cx,this.stack.slice(),this.state,this.reducePos,this.pos,this.badness,r,n,e)},t.prototype.recoverByDelete=function(t,e){var i=t<=this.cx.parser.maxNode;i&&this.storeNode(t,this.pos,e),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.badness+=1e6},t.prototype.canShift=function(t){for(var e=new a(this);;){var i=this.cx.parser.stateSlot(e.top,4)||this.cx.parser.hasAction(e.top,t);if(0==(65536&i))return!0;if(0==i)return!1;e.reduce(i)}},Object.defineProperty(t.prototype,"ruleStart",{get:function(){var t=this.cx.parser.stateSlot(this.state,5);if(!(65536&t))return 0;var e=this.stack.length-3*(t>>19);return this.stack[e+1]},enumerable:!0,configurable:!0}),t.prototype.startOf=function(t){for(var e=this.stack.length;e>=0;e-=3){var i=e==this.stack.length?this.state:this.stack[e],r=this.cx.parser.stateSlot(i,5);if(t.includes(65535&r)){var n=e-3*(r>>19);return this.stack[n+1]}}return-1},t.prototype.recoverByInsert=function(t){var e=this,i=this.cx.parser.nextStates(this.state);if(i.length>4){for(var r=i.filter((function(i){return i!=e.state&&e.cx.parser.hasAction(i,t)})),n=0;r.length<4&&n<i.length;n++)r.includes(i[n])||r.push(i[n]);i=r}var s=[];for(n=0;n<i.length&&s.length<4;n++)if(i[n]!=this.state){var o=this.split();o.storeNode(0,o.pos,o.pos,4,!0),o.pushState(i[n],this.pos),o.badness+=1e6,s.push(o)}return s},t.prototype.forceReduce=function(){var t=this.cx.parser.anyReduce(this.state);if(t>>19==0){if(0==(65536&(t=this.cx.parser.stateSlot(this.state,5))))return!1;this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.badness+=1e6}return this.reduce(t),!0},t.prototype.compare=function(t){return this.pos-t.pos||this.badness-t.badness},t.prototype.toTree=function(){return n.Tree.build(l.create(this),this.cx.parser.group,1,this.cx.maxBufferLength,this.cx.reused)},t}();!function(t){t[t.MaxNext=4]="MaxNext"}(o||(o={}));var a=function(){function t(t){this.stack=t,this.top=t.state,this.rest=t.stack,this.offset=this.rest.length}return t.prototype.reduce=function(t){var e=65535&t,i=t>>19;0==i?(this.rest==this.stack.stack&&(this.rest=this.rest.slice()),this.rest.push(this.top,0,0),this.offset+=3):this.offset-=3*(i-1);var r=this.stack.cx.parser.getGoto(this.rest[this.offset-3],e,!0);this.top=r},t}(),l=function(){function t(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}return t.create=function(e){return new t(e,e.bufferBase+e.buffer.length,e.buffer.length)},t.prototype.maybeNext=function(){var t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)},Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:!0,configurable:!0}),t.prototype.next=function(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()},t.prototype.fork=function(){return new t(this.stack,this.pos,this.index)},t}(),c=function(){function t(){this.start=-1,this.value=-1,this.end=-1}return t.prototype.accept=function(t,e){this.value=t,this.end=e},t}(),u=function(){function t(t,e){void 0===e&&(e=t.length),this.string=t,this.length=e}return t.prototype.get=function(t){return t<0||t>=this.length?-1:this.string.charCodeAt(t)},t.prototype.read=function(t,e){return this.string.slice(t,Math.min(this.length,e))},t.prototype.clip=function(e){return new t(this.string,e)},t}(),f=function(){function t(t,e){this.data=t,this.id=e}return t.prototype.token=function(t,e,i){!function(t,e,i,r,n){var s=0,o=1<<n;t:for(var h=i.start;0!=(o&t[s]);){for(var a=t[s+1],l=s+3;l<a;l+=2)if((t[l+1]&o)>0){var c=t[l];if(-1==i.value||i.value==c||r.cx.parser.overrides(c,i.value)){i.accept(c,h);break}}for(var u=e.get(h++),f=0,d=t[s+2];f<d;){var p=f+d>>1,g=a+p+(p<<1),m=t[g],O=t[g+1];if(u<m)d=p;else{if(!(u>=O)){s=t[g+2];continue t}f=p+1}}break}}(this.data,t,e,i,this.id)},t}();f.prototype.contextual=!1;var d=function(t,e){void 0===e&&(e={}),this.token=t,this.contextual=e&&e.contextual||!1};function p(t,e){void 0===e&&(e=Uint16Array);for(var i=null,r=0,n=0;r<t.length;){for(var s=0;;){var o=t.charCodeAt(r++),h=!1;if(126==o){s=65535;break}o>=92&&o--,o>=34&&o--;var a=o-32;if(a>=46&&(a-=46,h=!0),s+=a,h)break;s*=46}i?i[n++]=s:i=new e(s)}return i}var g=void 0!==t&&/\bparse\b/.test(t.env.LOG),m=function(){function t(t){this.start=[0],this.index=[0],this.nextStart=0,this.trees=[t]}return t.prototype.nodeAt=function(t){if(t<this.nextStart)return null;for(;;){var e=this.trees.length-1;if(e<0)return this.nextStart=1e9,null;var i=this.trees[e],r=this.index[e];if(r!=i.children.length){var s=i.children[r],o=this.start[e]+i.positions[r];if(s instanceof n.TreeBuffer)this.index[e]++,this.nextStart=o+s.length;else{if(o>=t)return o==t?s:null;this.index[e]++,o+s.length>=t&&(this.trees.push(s),this.start.push(o),this.index.push(0))}}else this.trees.pop(),this.start.pop(),this.index.pop()}},t}(),O=function(t){function e(e){var i=t.call(this)||this;return i.tokenizer=e,i.extended=-1,i.mask=0,i}return function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.clear=function(t){this.start=t,this.value=this.extended=-1},e}(c),v=new c,y=function(){function t(){this.tokens=[],this.mainToken=v,this.actions=[]}return t.prototype.getActions=function(t,e){for(var i=0,r=null,n=t.cx.parser,s=n.tokenizers,o=0;o<s.length;o++)if(0!=(1<<o&n.stateSlot(t.state,3))){for(var h=s[o],a=void 0,l=0,c=this.tokens;l<c.length;l++){var u=c[l];if(u.tokenizer==h){a=u;break}}a||this.tokens.push(a=new O(h));var f=n.stateSlot(t.state,3);(h.contextual||a.start!=t.pos||a.mask!=f)&&(this.updateCachedToken(a,t,e),a.mask=f);var d=i;if(a.extended>-1&&(i=this.addActions(t,a.extended,a.end,i)),(i=this.addActions(t,a.value,a.end,i))>d){r=a;break}r&&0==a.value||(r=a)}for(;this.actions.length>i;)this.actions.pop();return r||((r=v).start=t.pos,t.pos==e.length?r.accept(t.cx.parser.eofTerm,t.pos):r.accept(0,t.pos+1)),this.mainToken=r,this.actions},t.prototype.updateCachedToken=function(t,e,i){if(t.clear(e.pos),t.tokenizer.token(i,t,e),t.value>-1){var r=e.cx.parser,n=k(r.data,r.specializeTable,t.value);if(n>=0){var s=r.specializations[n][i.read(t.start,t.end)];null!=s&&(0==(1&s)?t.value=s>>1:t.extended=s>>1)}}else e.pos==i.length?t.accept(e.cx.parser.eofTerm,e.pos):t.accept(0,e.pos+1)},t.prototype.putAction=function(t,e,i,r){for(var n=0;n<r;n+=3)if(this.actions[n]==t)return r;return this.actions[r++]=t,this.actions[r++]=e,this.actions[r++]=i,r},t.prototype.addActions=function(t,e,i,r){for(var n=t.state,s=t.cx.parser,o=s.data,h=0;h<2;h++)for(var a=s.stateSlot(n,h?2:1),l=void 0;65535!=(l=o[a]);a+=3)(l==e||0==l&&0==r)&&(r=this.putAction(o[a+1]|o[a+2]<<16,e,i,r));return r},t}(),b=function(t,e,i,r,n){void 0===r&&(r=null),void 0===n&&(n=-1),this.parser=t,this.maxBufferLength=e,this.input=i,this.parent=r,this.wrapType=n,this.reused=[],this.tokens=new y},w=function(){function t(t,e,i){var r=void 0===i?{}:i,s=r.cache,o=void 0===s?void 0:s,a=r.strict,l=void 0!==a&&a,c=r.bufferLength,u=void 0===c?n.DefaultBufferLength:c;this.stoppedStacks=[],this.stacks=[h.start(new b(t,u,e))],this.strict=l,this.cache=o?new m(o):null}return t.prototype.putStack=function(t){if(t.badness>=2e6)for(var e=0;e<this.stacks.length;e++){var i=this.stacks[e];if(i.state==t.state&&i.pos==t.pos)return void((t.badness-i.badness||t.stack.length-i.stack.length)<0&&(this.stacks[e]=t))}else if(0==t.badness&&this.stacks.length&&t.buffer.length>800){if(this.stacks.reduce((function(t,e){return Math.max(t,e.buffer.length)}),0)>t.buffer.length)return}T(this.stacks,t)},t.prototype.advance=function(){return this.stoppedStacks.length>0&&(!this.stacks.length||this.stacks[0].pos>this.stoppedStacks[0].pos)?this.advanceStoppedStack(Q(this.stoppedStacks)):(this.advanceStack(Q(this.stacks)),null)},t.prototype.advanceStack=function(t){var e=t.pos,i=t.cx,r=i.input,s=i.parser,o=g?t+" -> ":"";if(this.cache)for(var a=this.cache.nodeAt(e);a;){var l=s.group.types[a.type.id]==a.type?s.getGoto(t.state,a.type.id):-1;if(l>-1&&!A(a))return t.useNode(a,l),g&&console.log(o+t+" (via reuse of "+s.getName(a.type.id)+")"),void this.putStack(t);if(0==a.children.length||a.positions[0]>0)break;var c=a.children[0];if(!(c instanceof n.Tree))break;a=c}var u=s.startNested(t.state);t:if(u>-1){var f=s.nested[u],d=f.grammar,p=f.end,m=f.placeholder,O=void 0,v=null,y=void 0,w=void 0;if("function"==typeof d){var S=d(r,t);if(S.stay)break t;v=S.parseNode,y=S.parser,O=S.filterEnd,w=S.wrapType}else y=d;var x=this.scanForNestEnd(t,p,O),k=t.cx.input.clip(x);if(v||!y){var P=v?v(k,t.pos):n.Tree.empty;P.length!=x-t.pos&&(P=new n.Tree(P.type,P.children,P.positions,x-t.pos)),null!=w&&(P=new n.Tree(s.group.types[w],[P],[0],P.length)),t.useNode(P,s.getGoto(t.state,m,!0)),this.putStack(t)}else{var Q=h.start(new b(y,t.cx.maxBufferLength,k,t,w),t.pos);g&&console.log(o+Q+" (nested)"),this.putStack(Q)}return}var C=s.stateSlot(t.state,4);if(C>0)return t.reduce(C),this.putStack(t),void(g&&console.log(o+t+" (via always-reduce "+s.getName(65535&C)+")"));for(var M=t.cx.tokens.getActions(t,r),D=0;D<M.length;){var N=M[D++],R=M[D++],E=(x=M[D++],D==M.length?t:t.split());E.apply(N,R,x),g&&console.log(o+E+" (via "+(0==(65536&N)?"shift":"reduce of "+s.getName(65535&N))+" for "+s.getName(R)+" @ "+e+(E==t?"":", split")+")"),this.putStack(E)}0==M.length&&T(this.stoppedStacks,t)},t.prototype.advanceStoppedStack=function(t){var e=t.cx,i=e.input,r=e.parser;if(t.pos==i.length&&r.stateFlag(t.state,2))return this.finishStack(t);var n=this.stacks.reduce((function(t,e){return Math.min(t,e.badness)}),1e9);if(this.stacks.length&&n<=t.badness&&(this.stacks.length>=25||t.badness>Math.min(5e6,3*n)))return null;var s=t.cx.tokens.mainToken,o=s.end,h=s.value;if(this.strict){if(this.stacks.length||this.stoppedStacks.length)return null;throw new SyntaxError("No parse at "+t.pos+" with "+r.getName(h)+" (stack is "+t+")")}for(var a=g?t+" -> ":"",l=0,c=t.recoverByInsert(h);l<c.length;l++){var u=c[l];g&&console.log(a+u+" (via recover-insert)"),this.putStack(u)}var f=t.split();if(f.forceReduce())g&&console.log(a+f+" (via force-reduce)"),this.putStack(f);else if(t.pos==i.length)return this.finishStack(t);if(o==t.pos){if(t.pos==i.length)return null;o++,h=0}return t.recoverByDelete(h,o),g&&console.log(a+t+" (via recover-delete "+r.getName(h)+")"),this.putStack(t),null},t.prototype.finishStack=function(t){return t.cx.parent?(this.putStack(this.finishNested(t)),null):t.toTree()},Object.defineProperty(t.prototype,"pos",{get:function(){return(this.stacks[0]||this.stoppedStacks[0]).pos},enumerable:!0,configurable:!0}),t.prototype.forceFinish=function(){for(var t=(this.stacks[0]||this.stoppedStacks[0]).split();!t.cx.parser.stateFlag(t.state,2)&&t.forceReduce(););return t.toTree()},t.prototype.scanForNestEnd=function(t,e,i){for(var r=t.cx.input,n=t.pos;n<r.length;n++)if(v.start=n,v.value=-1,e.token(r,v,t),v.value>-1&&(!i||i(r.read(n,v.end))))return n;return r.length},t.prototype.finishNested=function(t){var e=t.cx.parent,i=t.toTree(),r=e.cx.parser,s=r.nested[r.startNested(e.state)];return i=new n.Tree(i.type,i.children,i.positions.map((function(t){return t-e.pos})),t.pos-e.pos),t.cx.wrapType>-1&&(i=new n.Tree(r.group.types[t.cx.wrapType],[i],[0],i.length)),e.useNode(i,r.getGoto(e.state,s.placeholder,!0)),g&&console.log(e+" (via unnest "+(t.cx.wrapType>-1?r.getName(t.cx.wrapType):i.type.name)+")"),this.stacks=C(this.stacks,e),this.stoppedStacks=C(this.stoppedStacks,e),e},t}(),S=function(){function t(t,e,i,r,n,s,o,h,a,l){void 0===l&&(l=null),this.states=t,this.data=e,this.goto=i,this.group=r,this.tokenizers=n,this.nested=s,this.specializeTable=o,this.specializations=h,this.tokenPrecTable=a,this.termNames=l,this.nextStateCache=[],this.maxNode=this.group.types.length-1;for(var c=0,u=this.states.length/6;c<u;c++)this.nextStateCache[c]=null}return t.prototype.parse=function(t,e){"string"==typeof t&&(t=new u(t));for(var i=new w(this,t,e);;){var r=i.advance();if(r)return r}},t.prototype.startParse=function(t,e){return new w(this,t,e)},t.prototype.getGoto=function(t,e,i){void 0===i&&(i=!1);var r=this.goto;if(e>=r[0])return-1;for(var n=r[e+1];;){var s=r[n++],o=1&s,h=r[n++];if(o&&i)return h;for(var a=n+(s>>1);n<a;n++)if(r[n]==t)return h;if(o)return-1}},t.prototype.hasAction=function(t,e){for(var i=this.data,r=0;r<2;r++)for(var n=this.stateSlot(t,r?2:1),s=void 0;65535!=(s=i[n]);n+=3)if(s==e||0==s)return i[n+1]|i[n+2]<<16;return 0},t.prototype.stateSlot=function(t,e){return this.states[6*t+e]},t.prototype.stateFlag=function(t,e){return(this.stateSlot(t,0)&e)>0},t.prototype.startNested=function(t){var e=this.stateSlot(t,0);return 4&e?e>>10:-1},t.prototype.anyReduce=function(t){var e=this.stateSlot(t,4);if(e>0)return e;for(var i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i])return 0;var r=this.data[i+2];if(1&r)return this.data[i+1]|r<<16}},t.prototype.nextStates=function(t){var e=this.nextStateCache[t];if(e)return e;for(var i=[],r=this.stateSlot(t,1);65535!=this.data[r];r+=3)0!=(1&this.data[r+2])||i.includes(this.data[r+1])||i.push(this.data[r+1]);for(var n=this.goto,s=n[0],o=0;o<s;o++)for(var h=n[o+1];;){for(var a=n[h++],l=n[h++],c=h+(a>>1);h<c;h++)n[h]!=t||i.includes(l)||i.push(l);if(1&a)break}return this.nextStateCache[t]=i},t.prototype.overrides=function(t,e){var i=k(this.data,this.tokenPrecTable,e);return i<0||k(this.data,this.tokenPrecTable,t)<i},t.prototype.withNested=function(e){return new t(this.states,this.data,this.goto,this.group,this.tokenizers,this.nested.map((function(t){return Object.prototype.hasOwnProperty.call(e,t.name)?{name:t.name,grammar:e[t.name],end:t.end,placeholder:t.placeholder}:t})),this.specializeTable,this.specializations,this.tokenPrecTable,this.termNames)},t.prototype.withProps=function(){for(var e,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return new t(this.states,this.data,this.goto,(e=this.group).extend.apply(e,i),this.tokenizers,this.nested,this.specializeTable,this.specializations,this.tokenPrecTable,this.termNames)},t.prototype.getName=function(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.group.types[t].name||t)},Object.defineProperty(t.prototype,"eofTerm",{get:function(){return this.maxNode+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasNested",{get:function(){return this.nested.length>0},enumerable:!0,configurable:!0}),t.deserialize=function(e){for(var i=p(e.tokenData),r=e.nodeNames.split(" "),s=0;s<e.repeatNodeCount;s++)r.push("");var o=[];for(s=0;s<r.length;s++)o.push(x);function h(t,e,i){o[t]==x&&(o[t]=Object.create(null)),e.set(o[t],e.deserialize(i))}h(0,n.NodeProp.error,"");for(s=o.length-e.repeatNodeCount;s<o.length;s++)h(s,n.NodeProp.repeated,"");if(e.nodeProps)for(var a=0,l=e.nodeProps;a<l.length;a++){var c=l[a],u=c[0];for(s=1;s<c.length;s+=2)h(c[s],u,c[s+1])}var d=new n.NodeGroup(r.map((function(t,e){return new n.NodeType(t,o[e],e)})));return new t(p(e.states,Uint32Array),p(e.stateData),p(e.goto),d,e.tokenizers.map((function(t){return"number"==typeof t?new f(i,t):t})),(e.nested||[]).map((function(t){var e=t[0],i=t[1],r=t[2],n=t[3];return{name:e,grammar:i,end:new f(p(r),0),placeholder:n}})),e.specializeTable,(e.specializations||[]).map(P),e.tokenPrec,e.termNames)},t}(),x=Object.create(null);function k(t,e,i){for(var r=e,n=void 0;65535!=(n=t[r]);r++)if(n==i)return r-e;return-1}function P(t){if(!(t instanceof Object))return t;var e=Object.create(null);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function A(t){var e=!1,i=!1,r=0==t.type.id;return r||t.iterate({enter:function(t){return e||(0==t.id?r=e=!0:void 0)},leave:function(t){e=!0}}),r||t.iterate({from:t.length,to:0,enter:function(t){return i||(0==t.id?r=i=!0:void 0)},leave:function(t){i=!0}}),r}function T(t,e){for(var i=t.push(e)-1;i>0;){var r=i-1>>1,n=t[r];if(e.compare(n)>=0)break;t[i]=n,t[r]=e,i=r}}function Q(t){var e=t[0],i=t.pop();if(0==t.length)return e;t[0]=i;for(var r=0;;){var n=1+(r<<1);if(n>=t.length)break;var s=t[n];if(n+1<t.length&&s.compare(t[n+1])>=0&&(s=t[n+1],n++),i.compare(s)<0)break;t[n]=i,t[r]=s,r=n}return e}function C(t,e){return t.some((function(t){return t.cx.parent==e}))?t.filter((function(t){return t.cx.parent!=e})).sort((function(t,e){return t.compare(e)})):t}e.NodeGroup=n.NodeGroup,e.NodeProp=n.NodeProp,e.NodeType=n.NodeType,e.Subtree=n.Subtree,e.Tree=n.Tree,e.ExternalTokenizer=d,e.ParseContext=w,e.Parser=S,e.Stack=h,e.Token=c,e.TokenGroup=f}).call(this,i(8))},function(t,e){var i,r,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function h(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(t){i=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var a,l=[],c=!1,u=-1;function f(){c&&a&&(c=!1,a.length?l=a.concat(l):u=-1,l.length&&d())}function d(){if(!c){var t=h(f);c=!0;for(var e=l.length;e;){for(a=l,l=[];++u<e;)a&&a[u].run();u=-1,e=l.length}a=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new p(t,e)),1!==l.length||c||h(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,i){"use strict";i.r(e);var r=i(3),n=i.n(r),s=i(2),o={insert:"head",singleton:!1};n()(s.a,o),s.a.locals;let h=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u180b-\u180d\u18a9\u200c\u200d]/;try{h=new RegExp("\\p{Grapheme_Extend}","u")}catch(t){}function a(t){return t>=768&&(t>=56320&&t<57344||h.test(String.fromCharCode(t)))}const l=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let c;try{c=new RegExp("[\\p{Alphabetic}_]","u")}catch(t){}function u(t){return c?c.test(t):/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||l.test(t))}var f;function d(t,e){return/\s/.test(t)?f.Space:function(t,e){return e?!!(e.source.indexOf("\\w")>-1&&u(t))||e.test(t):u(t)}(t,e)?f.Word:f.Other}!function(t){t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other"}(f||(f={}));function p(t,e,i){for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);9==n?e+=i-e%i:(n<768||!a(n))&&e++}return e}function g(t,e,i,r){for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(!a(s)){if(e>=i)return{offset:n,leftOver:0};e+=9==s?r-e%r:1}}return{offset:t.length,leftOver:i-e}}class m{constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);for(let e=0;e<O.length;e+=2){if(O[e]!=this)continue;let i=O[e+1];if(i.start<=t&&i.end>=t)return i}return y(this,this.lineInner(t,!1,1,0).finish(this))}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);for(let e=0;e<O.length;e+=2){if(O[e]!=this)continue;let i=O[e+1];if(i.number==t)return i}return y(this,this.lineInner(t,!0,1,0).finish(this))}replace(t,e,i){if(0==i.length)throw new RangeError("An inserted range must have at least one line");return this.replaceInner(t,e,i,S(i))}sliceLines(t,e=this.length){return this.sliceTo(t,e,[""])}slice(t,e,i="\n"){return this.sliceLines(t,e).join(i)}eq(t){return this==t||function(t,e){if(t.length!=e.length||t.lines!=e.lines)return!1;let i=new P(t),r=new P(e);for(let t=0,e=0;;){if(i.lineBreak!=r.lineBreak||i.done!=r.done)return!1;if(i.done)return!0;if(i.lineBreak)i.next(),r.next(),t=e=0;else{let n=i.value.slice(t),s=r.value.slice(e);if(n.length==s.length){if(n!=s)return!1;i.next(),r.next(),t=e=0}else if(n.length>s.length){if(n.slice(0,s.length)!=s)return!1;t+=s.length,r.next(),e=0}else{if(s.slice(0,n.length)!=n)return!1;e+=n.length,i.next(),t=0}}}}(this,t)}iter(t=1){return new P(this,t)}iterRange(t,e=this.length){return new A(this,t,e)}iterLines(t=0){return new T(this,t)}toString(){return this.slice(0,this.length)}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");let e=S(t);return e<1024?new b(t,e):w.from(b.split(t,[]),e)}}let O=[],v=-2;function y(t,e){return v=(v+2)%12,O[v]=t,O[v+1]=e,e}class b extends m{constructor(t,e=S(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}replaceInner(t,e,i,r){return m.of(x(this.text,x(i,k(this.text,0,t)),e))}sliceTo(t,e=this.length,i){return x(this.text,i,t,e)}lineInner(t,e,i,r){for(let n=0;;n++){let s=this.text[n],o=r+s.length;if((e?i:o)>=t)return new Q(r,o,i,s);r=o+1,i++}}decomposeStart(t,e){e.push(new b(k(this.text,0,t),t))}decomposeEnd(t,e){e.push(new b(k(this.text,t),this.length-t))}lastLineLength(){return this.text[this.text.length-1].length}firstLineLength(){return this.text[0].length}static split(t,e){let i=[],r=-1;for(let n of t)for(;;){let t=r+n.length+1;if(t<512){r=t,i.push(n);break}let s=512-r-1,o=n.charCodeAt(s);o>=56320&&o<57344&&s++,i.push(n.slice(0,s)),e.push(new b(i,512)),n=n.slice(s),r=-1,i=[]}return-1!=r&&e.push(new b(i,r)),e}}class w extends m{constructor(t,e){super(),this.children=t,this.length=e,this.lines=1;for(let e of t)this.lines+=e.lines-1}replaceInner(t,e,i,r){let n,s=r-(e-t),o=this.length+s;if(o<=512)return new b(x(this.sliceLines(e),x(i,this.sliceTo(0,t,[""]))),o);for(let r=0,h=0;r<this.children.length;r++){let a=this.children[r],l=h+a.length;if(t>=h&&e<=l&&(s>0?a.length+s<Math.max(o>>2,1024):a.length+s>o>>4))return n=this.children.slice(),n[r]=a.replace(t-h,e-h,i),new w(n,o);l>=t&&(null==n&&(n=this.children.slice(0,r)),h<t&&(l==t?n.push(a):a.decomposeStart(t-h,n)),h<=t&&l>=t&&b.split(i,n),h>=e?n.push(a):l>e&&a.decomposeEnd(e-h,n)),h=l}return n?w.from(n,o):this}sliceTo(t,e,i){let r=0;for(let n of this.children){let s=r+n.length;e>r&&t<s&&n.sliceTo(Math.max(0,t-r),Math.min(n.length,e-r),i),r=s}return i}lineInner(t,e,i,r){for(let n=0;;n++){let s=this.children[n],o=r+s.length,h=i+s.lines-1;if((e?h:o)>=t){let h,a=s.lineInner(t,e,i,r);return a.start==r&&(h=this.lineLengthTo(n))&&(a.start-=h,a.content=null),a.end==o&&(h=this.lineLengthFrom(n+1))&&(a.end+=h,a.content=null),a}r=o,i=h}}decomposeStart(t,e){for(let i=0,r=0;;i++){let n=this.children[i],s=r+n.length;if(!(s<=t)){r<t&&n.decomposeStart(t-r,e);break}e.push(n),r=s}}decomposeEnd(t,e){let i=0;for(let r of this.children){let n=i+r.length;i>=t?e.push(r):n>t&&i<t&&r.decomposeEnd(t-i,e),i=n}}lineLengthTo(t){let e=0;for(let i=t-1;i>=0;i--){let t=this.children[i];if(t.lines>1)return e+t.lastLineLength();e+=t.length}return e}lastLineLength(){return this.lineLengthTo(this.children.length)}lineLengthFrom(t){let e=0;for(let i=t;i<this.children.length;i++){let t=this.children[i];if(t.lines>1)return e+t.firstLineLength();e+=t.length}return e}firstLineLength(){return this.lineLengthFrom(0)}static from(t,e){if(e<1024){let i=[""];for(let e of t)e.sliceTo(0,e.length,i);return new b(i,e)}let i=Math.max(512,e>>3),r=i<<1,n=i>>1,s=[],o=0,h=[];function a(t){let e,c=t.length;if(c>r&&t instanceof w)for(let e of t.children)a(e);else c>n&&(o>n||0==o)?(l(),s.push(t)):t instanceof b&&o>0&&(e=h[h.length-1])instanceof b&&t.length+e.length<=512?(o+=c,h[h.length-1]=new b(x(t.text,e.text.slice()),t.length+e.length)):(o+c>i&&l(),o+=c,h.push(t))}function l(){0!=o&&(s.push(1==h.length?h[0]:w.from(h,o)),o=0,h.length=0)}for(let e of t)a(e);return l(),1==s.length?s[0]:new w(s,e)}}function S(t){let e=-1;for(let i of t)e+=i.length+1;return e}function x(t,e,i=0,r=1e9){for(let n=0,s=0,o=!0;s<t.length&&n<=r;s++){let h=t[s],a=n+h.length;a>=i&&(a>r&&(h=h.slice(0,r-n)),n<i&&(h=h.slice(i-n)),o?(e[e.length-1]+=h,o=!1):e.push(h)),n=a+1}return e}function k(t,e,i){return x(t,[""],e,i)}m.empty=m.of([""]);class P{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?0:t instanceof b?t.text.length:t.children.length]}next(t=0){for(;;){let e=this.nodes.length-1;if(e<0)return this.done=!0,this.value="",this.lineBreak=!1,this;let i=this.nodes[e],r=this.offsets[e];if(i instanceof b){if(r!=(this.dir>0?0:i.text.length)&&!this.lineBreak){if(this.lineBreak=!0,0==t)return this.value="\n",this;t--;continue}let n=i.text[r-(this.dir<0?1:0)];if(this.offsets[e]=r+=this.dir,r==(this.dir>0?i.text.length:0)&&(this.nodes.pop(),this.offsets.pop()),this.lineBreak=!1,n.length>t)return this.value=0==t?n:this.dir>0?n.slice(t):n.slice(0,n.length-t),this;t-=n.length}else if(r==(this.dir>0?i.children.length:0))this.nodes.pop(),this.offsets.pop();else{let n=i.children[this.dir>0?r:r-1],s=n.length;this.offsets[e]=r+this.dir,t>s?t-=s:(this.nodes.push(n),this.offsets.push(this.dir>0?0:n instanceof b?n.text.length:n.children.length))}}}}class A{constructor(t,e,i){this.value="",this.cursor=new P(t,e>i?-1:1),e>i?(this.skip=t.length-e,this.limit=e-i):(this.skip=e,this.limit=i-e)}next(){if(this.limit<=0)this.limit=-1;else{let{value:t,lineBreak:e}=this.cursor.next(this.skip);this.skip=0,this.value=t;let i=e?1:t.length;i>this.limit&&(this.value=this.cursor.dir>0?t.slice(0,this.limit):t.slice(i-this.limit)),this.limit-=this.value.length}return this}get lineBreak(){return this.cursor.lineBreak}get done(){return this.limit<0}}class T{constructor(t,e=0){this.value="",this.done=!1,this.cursor=t.iter(),this.skip=e}next(){if(this.cursor.done)return this.done=!0,this.value="",this;for(this.value="";;){let{value:t,lineBreak:e,done:i}=this.cursor.next(this.skip);if(this.skip=0,i||e)return this;this.value+=t}}get lineBreak(){return!1}}class Q{constructor(t,e,i,r){this.start=t,this.end=e,this.number=i,this.content=r}get length(){return this.end-this.start}slice(t=0,e=this.length){if("string"==typeof this.content)return e==t+1?this.content.charAt(t):this.content.slice(t,e);if(t==e)return"";let i=this.content.slice(t,e);return 0==t&&e==this.length&&(this.content=i),i}finish(t){return null==this.content&&(this.content=new C(t,this.start)),this}}class C{constructor(t,e){this.doc=t,this.start=e,this.cursor=null,this.strings=null}slice(t,e){this.cursor||(this.cursor=this.doc.iter(),this.strings=[this.cursor.next(this.start).value]);for(let i="",r=0,n=0;;n++){n==this.strings.length&&this.strings.push(this.cursor.next().value);let s=this.strings[n],o=r+s.length;if(!(o<=t)){if(i+=s.slice(Math.max(0,t-r),Math.min(s.length,e-r)),o>=e)return i;r+=s.length}}}}class M{constructor(t,e,i){this.combine=t,this.id=i,this.static=e,this.empty=t(E)}static get(t){let e=t._data;if(!e)throw new RangeError("Not a behavior");return e}}class D{constructor(t){this.getStore=t,this.nextStorageID=0,this.fallback=N(-1),this.normal=N(0),this.extend=N(1),this.override=N(2)}behavior(t={}){let e=t=>new R(0,e,{static:t},this);return e._data=new M(t.combine||(t=>t),!!t.static,this.storageID()),e}dynamic(t,e){if(M.get(t).static)throw new Error("Can't create a dynamic source for a static behavior");return new R(0,t,{dynamic:e},this)}resolve(t){let e=[];!function t(e,i,r,n=[]){if(r.has(e))return;if(r.add(e),Array.isArray(e))for(let s of e)t(s,i,r,n);else{let s=e;if(1==s.kind)for(let e of s.value)t(e,-2==s.prec?i:s.prec,r,n);else n.push(-2!=s.prec?s:new R(s.kind,s.id,s.value,s.type,i))}}(t,0,new Set,e);let i=[],r=Object.create(null);for(let t of e){if(t.type!=this){i.push(t);continue}let n=M.get(t.id);if(Object.prototype.hasOwnProperty.call(r,n.id))continue;let s=[];for(let i of e)i.id==t.id&&i.collect(s);let o=[],h=[];if(s.forEach(t=>{t.value.dynamic?(o.push({read:t.value.dynamic,index:h.length}),h.push(null)):h.push(t.value.static)}),0==o.length){let t=n.combine(h);r[n.id]=()=>t}else{let t,e;r[n.id]=i=>{let r=this.getStore(i),s=r[n.id];if(void 0!==s||Object.prototype.hasOwnProperty.call(r,n.id))return s;let a=h.slice(),l=!1;for(let{read:e,index:r}of o){let n=a[r]=e(i);t&&t[r]==n||(l=!0)}return t=a,r[n.id]=l?e=n.combine(a):e}}}return new z(this,t,r,i)}storageID(){return++this.nextStorageID}}function N(t){return e=>e instanceof R?new R(e.kind,e.id,e.value,e.type,t):new R(1,null,e,null,t)}class R{constructor(t,e,i,r,n=-2){this.kind=t,this.id=e,this.value=i,this.type=r,this.prec=n}collect(t){let e=0;for(;e<t.length&&t[e].prec>=this.prec;)e++;t.splice(e,0,this)}}const E=[];class z{constructor(t,e,i,r=[]){this.type=t,this.extensions=e,this.readBehavior=i,this.foreign=r}getBehavior(t,e){let i=M.get(t);if(!e&&!i.static)throw new RangeError("Need a context to retrieve non-static behavior");let r=this.readBehavior[i.id];return r?r(e):i.empty}replaceExtensions(t){let e=this.extensions.map(e=>{for(let[i,r]of t)if(e==i)return r;return e});return this.type.resolve(e)}}function W(t,e,i={}){let r={};for(let e of t)for(let t of Object.keys(e)){let n=e[t],s=r[t];if(void 0===s)r[t]=n;else if(s===n||void 0===n);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);r[t]=i[t](s,n)}}for(let t in e)void 0===r[t]&&(r[t]=e[t]);return r}function B(t,e){let i={};for(let e in t)i[e]=t[e];for(let t in e)void 0===i[t]&&(i[t]=e[t]);return i}var $=i(0);class U{constructor(t,e=t){this.anchor=t,this.head=e}get from(){return Math.min(this.anchor,this.head)}get to(){return Math.max(this.anchor,this.head)}get empty(){return this.anchor==this.head}map(t){let e=t.mapPos(this.anchor),i=t.mapPos(this.head);return e==this.anchor&&i==this.head?this:new U(e,i)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return new U(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return new U(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return this}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return new U(t.anchor,t.head)}static groupAt(t,e,i=1){let r=t.doc.lineAt(e),n=e-r.start;if(0==r.length)return new U(e);0==n?i=1:n==r.length&&(i=-1);let s=n+(i<0?-1:0),o=d(r.slice(s,s+1)),h=e,a=e;for(let t=n;t>0&&d(r.slice(t-1,t))==o;t--)h--;for(let t=n;t<r.length&&d(r.slice(t,t+1))==o;t++)a++;return new U(a,h)}}class V{constructor(t,e=0){this.ranges=t,this.primaryIndex=e}map(t){return V.create(this.ranges.map(e=>e.map(t)),this.primaryIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.primaryIndex!=t.primaryIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get primary(){return this.ranges[this.primaryIndex]}asSingle(){return 1==this.ranges.length?this:new V([this.primary])}addRange(t,e=!0){return V.create([t].concat(this.ranges),e?0:this.primaryIndex+1)}replaceRange(t,e=this.primaryIndex){let i=this.ranges.slice();return i[e]=t,V.create(i,this.primaryIndex)}toJSON(){return 1==this.ranges.length?this.ranges[0].toJSON():{ranges:this.ranges.map(t=>t.toJSON()),primaryIndex:this.primaryIndex}}static fromJSON(t){if(t&&Array.isArray(t.ranges)){if("number"!=typeof t.primaryIndex||t.primaryIndex>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new V(t.ranges.map(t=>U.fromJSON(t)),t.primaryIndex)}return new V([U.fromJSON(t)])}static single(t,e=t){return new V([new U(t,e)],0)}static create(t,e=0){for(let i=0,r=0;r<t.length;r++){let n=t[r];if(n.empty?n.from<=i:n.from<i)return L(t.slice(),e);i=n.to}return new V(t,e)}}function L(t,e=0){let i=t[e];t.sort((t,e)=>t.from-e.from),e=t.indexOf(i);for(let i=1;i<t.length;i++){let r=t[i],n=t[i-1];if(r.empty?r.from<=n.to:r.from<n.to){let s=n.from,o=Math.max(r.to,n.to);i<=e&&e--,t.splice(--i,2,r.anchor>r.head?new U(o,s):new U(s,o))}}return new V(t,e)}const I=new D(t=>t.values),j=I.behavior({static:!0}),_=I.behavior({combine:t=>t.some(t=>t),static:!0});class H{constructor(t){this.id=I.storageID(),this.init=t.init,this.apply=t.apply,this.extension=j(this)}}class F{constructor(t,e){this.type=t,this.value=e}static define(){return function t(e){return new F(t,e)}}}const X=new $.NodeProp,q=[];var G;!function(t){t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter"}(G||(G={}));class Z{constructor(t,e,i){this.from=t,this.to=e,this.length=i}get invertedDesc(){return new Z(this.from,this.from+this.length,this.to-this.from)}mapPos(t,e=-1,i=G.Simple){let{from:r,to:n,length:s}=this;return t<r?t:t>n?t+(s-(n-r)):t==n||t==r?r<t&&i==G.TrackBefore||n>t&&i==G.TrackAfter?-t-1:(r==n?e<=0:t==r)?r:r+s:(t=r+(e<=0?0:s),i!=G.Simple?-t-1:t)}toJSON(){return this}static fromJSON(t){if(!t||"number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.length)throw new RangeError("Invalid JSON representation for ChangeDesc");return new Z(t.from,t.to,t.length)}}class Y extends Z{constructor(t,e,i){super(t,e,function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(i)),this.from=t,this.to=e,this.text=i}invert(t){return new Y(this.from,this.from+this.length,t.sliceLines(this.from,this.to))}apply(t){return t.replace(this.from,this.to,this.text)}map(t){let e=t.mapPos(this.from,1),i=t.mapPos(this.to,-1);return e>i?null:new Y(e,i,this.text)}get desc(){return new Z(this.from,this.to,this.length)}toJSON(){return{from:this.from,to:this.to,text:this.text}}static fromJSON(t){if(!t||"number"!=typeof t.from||"number"!=typeof t.to||!Array.isArray(t.text)||0==t.text.length||t.text.some(t=>"string"!=typeof t))throw new RangeError("Invalid JSON representation for Change");return new Y(t.from,t.to,t.text)}}class K{constructor(t,e=q){this.changes=t,this.mirror=e}get length(){return this.changes.length}getMirror(t){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)];return null}append(t,e){return new K(this.changes.concat(t),null!=e?this.mirror.concat(this.length,e):this.mirror)}appendSet(t){return 0==t.length?this:0==this.length?t:new K(this.changes.concat(t.changes),this.mirror.concat(t.mirror.map(t=>t+this.length)))}mapPos(t,e=-1,i=G.Simple){return this.mapInner(t,e,i,0,this.length)}mapInner(t,e,i,r,n){let s,o,h=n<r?-1:1,a=null,l=this.mirror.length>0,c=!1;for(let u=r-(h<0?1:0),f=n-(h<0?1:0);u!=f;u+=h){let{from:r,to:f,length:d}=this.changes[u];if(h<0){let t=f-r;f=r+d,d=t}if(!(t<r))if(t>f)t+=d-(f-r);else if(a&&null!=(s=a[u]))t=r+s;else{if(l&&null!=(o=this.getMirror(u))&&(h>0?o>u&&o<n:o<u&&o>=n)){if(t>r&&t<f){u=o,t=this.changes[u].from+(t-r);continue}(a||(a={}))[o]=t-r}t>r&&t<f?(i!=G.Simple&&(c=!0),t=e<=0?r:r+d):((r<t&&i==G.TrackBefore||f>t&&i==G.TrackAfter)&&(c=!0),t=(r==f?e<=0:t==r)?r:r+d)}}return c?-t-1:t}partialMapping(t,e=this.length){return 0==t&&e==this.length?this:new J(this,t,e)}changedRanges(){let t=[];for(let e=0;e<this.length;e++){let i=this.changes[e],r=i.from,n=i.to,s=i.from,o=i.from+i.length;if(e<this.length-1){let t=this.partialMapping(e+1);s=t.mapPos(s,1),o=t.mapPos(o,-1)}if(e>0){let t=this.partialMapping(e,0);r=t.mapPos(r,1),n=t.mapPos(n,-1)}new tt(r,n,s,o).addToSet(t)}return t}get desc(){return 0==this.changes.length||this.changes[0]instanceof Z?this:new K(this.changes.map(t=>t.desc),this.mirror)}toJSON(){let t=this.changes.map(t=>t.toJSON());return 0==this.mirror.length?t:{mirror:this.mirror,changes:t}}static fromJSON(t,e){let i,r;if(Array.isArray(e))i=q,r=e;else{if(!(e&&Array.isArray(e.mirror)&&Array.isArray(e.changes)))throw new RangeError("Invalid JSON representation for ChangeSet");({mirror:i,changes:r}=e)}return new K(r.map(e=>t.fromJSON(e)),i)}}K.empty=new K(q);class J{constructor(t,e,i){this.changes=t,this.from=e,this.to=i}mapPos(t,e=-1,i=G.Simple){return this.changes.mapInner(t,e,i,this.from,this.to)}}class tt{constructor(t,e,i,r){this.fromA=t,this.toA=e,this.fromB=i,this.toB=r}join(t){return new tt(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let r=t[e-1];if(!(r.fromA>i.toA)){if(r.toA<i.fromA)break;i=i.join(r),t.splice(e-1,1)}}return t.splice(e,0,i),t}get lenDiff(){return this.toB-this.fromB-(this.toA-this.fromA)}static mapPos(t,e,i){let r=0;for(let n of i){if(t<n.fromA)break;if(t<=n.toA){return(n.toA==n.fromA?e:t==n.fromA?-1:t==n.toA?1:e)<0?n.fromB:n.toB}r=n.toB-n.toA}return t+r}}class et{constructor(t,e=Date.now()){this.startState=t,this.changes=K.empty,this.docs=[],this.flags=0,this.state=null,this.selection=t.selection,this._annotations=[et.time(e)],this.configuration=t.configuration}get doc(){let t=this.docs.length-1;return t<0?this.startState.doc:this.docs[t]}annotate(...t){this.ensureOpen();for(let e of t)this._annotations.push(e);return this}annotation(t){for(let e=this._annotations.length-1;e>=0;e--)if(this._annotations[e].type==t)return this._annotations[e].value}annotations(t){let e=it;for(let i of this._annotations)i.type==t&&(e==it&&(e=[]),e.push(i.value));return e}change(t,e){if(this.ensureOpen(),t.from==t.to&&0==t.length)return this;if(t.from<0||t.to<t.from||t.to>this.doc.length)throw new RangeError(`Invalid change ${t.from} to ${t.to}`);return this.changes=this.changes.append(t,e),this.docs.push(t.apply(this.doc)),this.selection=this.selection.map(t),this}get docChanged(){return this.changes.length>0}replace(t,e,i){return this.change(new Y(t,e,"string"==typeof i?this.startState.splitLines(i):i))}replaceSelection(t){let e="string"==typeof t?this.startState.splitLines(t):t;return this.forEachRange(t=>{let i=new Y(t.from,t.to,e);return this.change(i),new U(t.from+i.length)})}forEachRange(t){let e=this.selection,i=this.changes.length,r=[];for(let n of e.ranges){let e=this.changes.length,s=t(n.map(this.changes.partialMapping(i)),this);if(this.changes.length>e){let t=this.changes.partialMapping(e);for(let e=0;e<r.length;e++)r[e]=r[e].map(t)}r.push(s)}return this.setSelection(V.create(r,e.primaryIndex))}setSelection(t){return this.ensureOpen(),this.selection=this.startState.behavior(_)?t:t.asSingle(),this.flags|=1,this}get selectionSet(){return(1&this.flags)>0}scrollIntoView(){return this.ensureOpen(),this.flags|=2,this}get scrolledIntoView(){return(2&this.flags)>0}replaceExtensions(t){return this.ensureOpen(),this.configuration=this.configuration.replaceExtensions(t),this.flags|=4,this}reconfigure(t){return this.ensureOpen(),this.configuration=I.resolve(t),this.flags|=4,this}get reconfigured(){return(4&this.flags)>0}ensureOpen(){if(this.state)throw new Error("Transactions may not be modified after being applied")}apply(){return this.state||(this.state=this.startState.applyTransaction(this))}invertedChanges(){if(!this.changes.length)return K.empty;let t=[],e=this.changes;for(let i=e.length-1;i>=0;i--)t.push(e.changes[i].invert(0==i?this.startState.doc:this.docs[i-1]));return new K(t,e.mirror.length?e.mirror.map(t=>e.length-t-1):e.mirror)}}et.time=F.define(),et.preserveGoalColumn=F.define(),et.userEvent=F.define(),et.addToHistory=F.define();const it=[],rt=/\r\n?|\n/;class nt{constructor(t,e,i,r){this.configuration=t,this.values=e,this.doc=i,this.selection=r;for(let t of r.ranges)if(t.to>i.length)throw new RangeError("Selection points outside of document")}field(t,e=!0){let i=this.values[t.id];if(void 0!==i||Object.prototype.hasOwnProperty.call(this.values,t.id))return i;if(this.behavior(j).indexOf(t)>-1)throw new RangeError("Field hasn't been initialized yet");if(e)throw new RangeError("Field is not present in this state")}applyTransaction(t){let e=Object.create(null),i=t.configuration,r=new nt(i,e,t.doc,t.selection);for(let n of i.getBehavior(j)){let s=i==this.configuration||Object.prototype.hasOwnProperty.call(this.values,n.id);e[n.id]=s?n.apply(t,this.values[n.id],r):n.init(r)}return r}t(t){return new et(this,t)}joinLines(t){return t.join(this.behavior(nt.lineSeparator)||"\n")}splitLines(t){return t.split(this.behavior(nt.lineSeparator)||rt)}behavior(t){return this.configuration.getBehavior(t,this)}toJSON(){return{doc:this.joinLines(this.doc.sliceLines(0,this.doc.length)),selection:this.selection.toJSON()}}static fromJSON(t,e={}){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");return nt.create({doc:t.doc,selection:V.fromJSON(t.selection),extensions:e.extensions})}static create(t={}){let e=I.resolve(t.extensions||[]),i=Object.create(null),r=t.doc instanceof m?t.doc:m.of((t.doc||"").split(e.getBehavior(nt.lineSeparator)||rt)),n=t.selection||V.single(0);e.getBehavior(nt.allowMultipleSelections)||(n=n.asSingle());let s=new nt(e,i,r,n);for(let t of s.behavior(j)){let e=i[t.id];if(e)throw new Error("Duplicate use of state field"+((e.constructor||Object)!=Object&&e.constructor.name?` (${e.constructor.name})`:""));i[t.id]=t.init(s)}return s}get tabSize(){return this.behavior(nt.tabSize)}get indentUnit(){return this.behavior(nt.indentUnit)}}nt.extend=I,nt.allowMultipleSelections=_,nt.indentation=I.behavior(),nt.tabSize=I.behavior({combine:t=>t.length?t[0]:4}),nt.lineSeparator=I.behavior({combine:t=>t.length?t[0]:void 0,static:!0}),nt.indentUnit=I.behavior({combine:t=>t.length?t[0]:2}),nt.syntax=I.behavior(),nt.foldable=I.behavior();var st=i(1);class ot{eq(t){return this==t}}ot.prototype.startSide=ot.prototype.endSide=0,ot.prototype.point=!1;class ht{constructor(t,e,i){this.from=t,this.to=e,this.value=i}map(t,e,i){let r=this.value.map(t,this.from+e,this.to+e);return r&&(r.from-=i,r.to-=i),r}move(t){return t?new ht(this.from+t,this.to+t,this.value):this}get heapPos(){return this.to}get heapSide(){return this.value.endSide}}const at=[];function lt(t){return t.length?t:at}class ct{constructor(t,e,i,r){this.length=t,this.size=e,this.local=i,this.children=r}update(t=at,e=null,i=0,r=this.length){let n=t.reduce((t,e)=>Math.max(t,e.to),this.length);if(t.length)for(let e=1,i=t[0];e<t.length;e++){let r=t[e];if(vt(i,r)>0){t=t.slice().sort(vt);break}i=r}return this.updateInner(t,e,i,r,0,n)}updateInner(t,e,i,r,n,s){let o=function(t,e,i,r,n){if(!e)return null;let s=null;for(let o=0;o<t.length;o++){let h=t[o],a=h.from+n,l=h.to+n;i>l||r<a||e(a,l,h.value)?null!=s&&s.push(h):null==s&&(s=t.slice(0,o))}return s}(this.local,e,i,r,n),h=null,a=0,l=0,c=n;for(let s=0;s<this.children.length;s++){let u=this.children[s],f=c+u.length,d=null;for(;l<t.length;){let e=t[l];if(e.from>=f)break;l++,e.to>f?(o||(o=this.local.slice()),yt(o,e.move(-n))):(d||(d=[])).push(e)}let p=u;(d||e&&i<=f&&r>=c)&&(p=p.updateInner(d||at,e,i,r,c,p.length)),p!=u?(h||(h=this.children.slice(0,s))).push(p):h&&h.push(p),a+=p.size,c=f}if(!o&&!h&&l==t.length)return this;if(a+=(o||this.local).length+t.length-l,a<=32)return function(t,e,i,r,n,s){let o=e.length>0&&i.length>0,h=0;for(let i of t)i.collect(e,-h),h+=i.length;for(let t of i)e.push(t.move(-n));o&&e.sort(vt);return new ct(s,e.length,e,at)}(h||this.children,o||this.local.slice(),t,0,n,s);let u=Math.max(32,a>>5);return l<t.length&&(h||(h=this.children.slice()),o||(o=this.local.slice()),function(t,e,i,r,n,s,o,h){for(let a=r;a<i.length;){let r=[],l=Math.min(a+h,i.length),c=l==i.length?n+s:i[l].from;for(;a<l;a++){let e=i[a];e.to>c?yt(t,e.move(-n)):r.push(e)}for(let e=0;e<t.length;e++){let i=t[e];i.from>=o&&i.to<=c&&(t.splice(e--,1),yt(r,i.move(n)))}r.length&&(r.length==i.length?e.push(new ct(c-o,r.length,r.map(t=>t.move(-o)),at)):e.push(ct.empty.updateInner(r,null,0,0,o,c-o)),o=c)}}(o,h,t,l,n,s,c,u)),h&&(o||(o=this.local.slice()),function(t,e,i){for(let r=0,n=0;r<e.length;){let s,o=e[r];if(0==o.size&&(r>0||1==e.length))e.splice(r--,1),r>=0&&(e[r]=e[r].grow(o.length));else if(o.size>i<<1&&o.local.length<o.length>>1){for(let e of o.local)yt(t,e.move(n));e.splice(r,1,...o.children)}else if(0==o.children.length&&r<e.length-1&&(s=e[r+1]).size+o.size<=32&&0==s.children.length)e.splice(r,2,new ct(o.length+s.length,o.size+s.size,o.local.concat(s.local.map(t=>t.move(o.length))),at));else{let s=r+1,h=o.size,a=o.length;if(o.size<i>>1)for(;s<e.length;s++){let t=e[s],r=h+t.size;if(r>i)break;h=r,a+=t.length}if(s>r+1){let i=new ct(a,h,at,e.slice(r,s)),o=[];for(let e=0;e<t.length;e++){let i=t[e];i.from>=n&&i.to<=n+a&&(t.splice(e--,1),o.push(i.move(-n)))}o.length&&(i=i.update(o.sort(vt))),e.splice(r,s-r,i),r++,n+=a}else r++,n+=o.length}}}(o,h,u)),new ct(s,a,lt(o||this.local),lt(h||this.children))}grow(t){return new ct(this.length+t,this.size,this.local,this.children)}collect(t,e){for(let i of this.local)t.push(i.move(e));for(let i of this.children)i.collect(t,e),e+=i.length}map(t){return 0==t.length||this==ct.empty?this:this.mapInner(t,0,0,t.mapPos(this.length,1)).set}mapInner(t,e,i,r){let n=null,s=null,o=r-i,h=0;for(let r=0;r<this.local.length;r++){let h=this.local[r],a=h.map(t,e,i),l=null!=a&&(a.from<0||a.to>o);null!=n||h==a&&!l||(n=this.local.slice(0,r)),l?(s||(s=[])).push(a):n&&a&&n.push(a)}let a=null;for(let r=0,l=e,c=i;r<this.children.length;r++){let e=this.children[r],u=e,f=l+e.length,d=t.mapPos(l+e.length,1),p=kt(l,f,t.changes);if(0==p){let r=e.mapInner(t,l,c,d);if(u=r.set,r.escaped)for(let t of r.escaped)t=t.move(c-i),t.from<0||t.to>o?yt(s||(s=[]),t):yt(n||(n=this.local.slice()),t)}else 2==p&&(u=ct.empty.grow(d-c));if(u!=e){if(null==a&&(a=this.children.slice(0,r)),0!=u.size||0!=u.length&&!a.length&&r!=this.children.length)a.push(u);else if(u.length>0&&r>0){let t=a.length-1,e=a[t];a[t]=new ct(e.length+u.length,e.size,e.local,e.children)}}else a&&a.push(u);h+=u.size,l=f,c=d}return{set:o==this.length&&null==a&&null==n?this:new ct(o,h+(n||this.local).length,n||this.local,a||this.children),escaped:s}}between(t,e,i){this.betweenInner(t,e,i,0)}betweenInner(t,e,i,r){for(let n of this.local)n.from+r<=e&&n.to+r>=t&&i(n.from+r,n.to+r,n.value);for(let n of this.children){let s=r+n.length;r<=e&&s>=t&&n.betweenInner(t,e,i,r),r=s}}iter(t=0,e=this.length){const i=[];return gt(i,[new ut(0,this)],t),this.local.length&&mt(i,new ft(0,this.local)),{next(){for(;;){if(0==i.length)return;const r=Ot(i),n=r.ranges[r.index++].move(r.offset);if(n.from>e)return;if(r.index<r.ranges.length?mt(i,r):r.next&&gt(i,r.next,0),n.to>=t)return n}}}}compare(t,e,i,r){let n=0,s=0;for(let r of e)r.fromB>s&&(this!=t||n!=s)&&new St(this,n,t,s,r.fromB,i).run(),n=r.toA,s=r.toB;(n<this.length||s<t.length||0==e.length)&&new St(this,n,t,s,s+(r-n),i).run()}static iterateSpans(t,e,i,r){let n=[],s=e,o=-bt;for(let e of t)e.size>0&&(gt(n,[new ut(0,e)],s),e.local.length&&mt(n,new ft(0,e.local)));let h=[];for(;n.length>0;){let t=Ot(n);if(t instanceof ft){let e=t.ranges[t.index],a=e.from+t.offset,l=e.to+t.offset;if(a>i)break;if(++t.index<t.ranges.length?mt(n,t):t.next&&gt(n,t.next,s),(l-s||e.value.endSide-o)>=0&&!r.ignore(a,l,e.value))if(a>s&&(r.span(s,a,h),s=a,o=e.value.startSide),e.value.point){if(r.point(s,Math.min(l,i),e.value,a<s,l>i),s=l,l>i)break;o=e.value.endSide}else l>s&&(h.push(e.value),mt(n,new ht(a,l,e.value)))}else{let e=t;if(e.to>i)break;e.to>s&&(r.span(s,e.to,h),s=e.to,o=e.value.endSide),h.splice(h.indexOf(e.value),1)}}s<i&&r.span(s,i,h)}static of(t){return ct.empty.update(t instanceof ht?[t]:t)}}ct.empty=new ct(0,0,at,at);class ut{constructor(t,e){this.offset=t,this.set=e,this.index=0}}class ft{constructor(t,e,i=null){this.offset=t,this.ranges=e,this.next=i,this.index=0}get heapPos(){return this.ranges[this.index].from+this.offset}get heapSide(){return this.ranges[this.index].value.startSide}}function dt(t,e=0){for(;0!=t.length;){let i=t[t.length-1];if(i.index==i.set.children.length)t.pop();else{let r=i.set.children[i.index],n=i.offset;if(i.index++,i.offset+=r.length,i.offset>=e){t.push(new ut(n,r));break}}}}function pt(t,e){return t.heapPos-e.heapPos||t.heapSide-e.heapSide}function gt(t,e,i=0){for(;dt(e,i),0!=e.length;){let i=e[e.length-1],r=i.set.local,n=i.set.children.length?null:e;if(r.length&&mt(t,new ft(i.offset,r,n)),n)break}}function mt(t,e){let i=t.push(e)-1;for(;i>0;){let r=i>>1,n=t[r];if(pt(e,n)>=0)break;t[i]=n,t[r]=e,i=r}}function Ot(t){let e=t[0],i=t.pop();if(0==t.length)return e;t[0]=i;for(let e=0;;){let r=1+(e<<1);if(r>=t.length)break;let n=t[r];if(r+1<t.length&&pt(n,t[r+1])>=0&&(n=t[r+1],r++),pt(i,n)<0)break;t[r]=i,t[e]=n,e=r}return e}function vt(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}function yt(t,e){let i=t.length;for(;i>0&&vt(t[i-1],e)>=0;)i--;t.splice(i,0,e)}const bt=1e9;class wt{constructor(t){this.stack=t,this.heap=[],this.active=[],this.activeTo=[],this.tip=null,this.point=null,this.pointTo=-bt}forward(t,e){let i=!1;if(e.set.local.length){let t=new ft(e.offset,e.set.local);mt(this.heap,t),e.set.children.length||(this.tip=t,i=!0)}return dt(this.stack,t),i}findActive(t,e){for(let i=0;i<this.active.length;i++)if(this.activeTo[i]==t&&(this.active[i]==e||this.active[i].eq(e)))return i;return-1}clearPoint(){this.pointTo=-bt,this.point=null}get nextPos(){return this.pointTo>-bt?this.pointTo:this.heap.length?this.heap[0].heapPos:bt}get nextSide(){return this.pointTo>-bt?this.point.endSide:this.heap.length?this.heap[0].heapSide:bt}}class St{constructor(t,e,i,r,n,s){this.comparator=s,this.a=new wt([new ut(r-e,t)]),this.b=new wt([new ut(0,i)]),this.pos=r,this.end=n,this.forwardIter(3)}forwardIter(t){for(;t>0;){let e=this.a.stack.length?this.a.stack[this.a.stack.length-1]:null,i=this.b.stack.length?this.b.stack[this.b.stack.length-1]:null;!e&&1&t?t&=-2:!i&&2&t?t&=-3:e&&i&&e.offset==i.offset&&e.set==i.set?(dt(this.a.stack,this.pos),dt(this.b.stack,this.pos)):e&&(!i||e.offset<i.offset||e.offset==i.offset&&(1==this.a.stack.length||e.set.length>=i.set.length))?this.a.forward(this.pos,e)&&(t&=-2):this.b.forward(this.pos,i)&&(t&=-3)}}run(){for(;;){let t=this.a.nextPos,e=this.b.nextPos;if(t==bt&&e==bt)break;(t-e||this.a.nextSide-this.a.nextSide)<0?this.advance(this.a,this.b):this.advance(this.b,this.a)}}advance(t,e){if(t.pointTo>-1){let i=Math.min(this.end,t.pointTo);return e.point&&t.point.eq(e.point)||this.comparator.comparePoint(this.pos,i,t.point,e.point),this.pos=i,(i==this.end||e.pointTo==i&&e.point.endSide==t.point.endSide)&&e.clearPoint(),void t.clearPoint()}let i=Ot(t.heap);if(i instanceof ft){let r=i.ranges[i.index++],n=r.from+i.offset,s=r.to+i.offset;if(n>this.end)return void(t.heap.length=0);if(i.index<i.ranges.length?mt(t.heap,i):this.forwardIter(t==this.a?1:2),s<this.pos||s<e.pointTo||s==e.pointTo&&r.value.startSide<e.point.endSide)return;if(e.pointTo<0&&this.advancePos(n),r.value.point)t.point=r.value,t.pointTo=s;else{s=Math.min(s,this.end);let i=e.findActive(s,r.value);i>-1?(xt(e.active,i),xt(e.activeTo,i)):(t.active.push(r.value),t.activeTo.push(s),mt(t.heap,new ht(this.pos,s,r.value)))}}else{let r=i;e.pointTo<0&&this.advancePos(r.to);let n=t.findActive(r.to,r.value);n>-1&&(xt(t.active,n),xt(t.activeTo,n))}}advancePos(t){t>this.end&&(t=this.end),t<=this.pos||(function(t,e){if(t.length!=e.length)return!1;t:for(let i=0;i<t.length;i++){for(let r=0;r<e.length;r++)if(t[i].eq(e[r]))continue t;return!1}return!0}(this.a.active,this.b.active)||this.comparator.compareRange(this.pos,t,this.a.active,this.b.active),this.pos=t)}}function xt(t,e){let i=t.pop();e!=t.length&&(t[e]=i)}function kt(t,e,i){let r=1;for(let n of i){n.to>=t&&n.from<=e&&(n.from<t&&n.to>e?r=2:1==r&&(r=0));let i=n.length-(n.to-n.from);t>n.from&&(t+=i),e>n.to&&(e+=i)}return r}let[Pt,At]="undefined"!=typeof navigator?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}];const Tt=/Edge\/(\d+)/.exec(Pt.userAgent),Qt=/MSIE \d/.test(Pt.userAgent),Ct=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pt.userAgent),Mt=!!(Qt||Ct||Tt),Dt=!Mt&&/gecko\/(\d+)/i.test(Pt.userAgent),Nt=!Mt&&/Chrome\/(\d+)/.exec(Pt.userAgent),Rt=!Mt&&"WebkitAppearance"in At.documentElement.style;var Et={mac:/Mac/.test(Pt.platform),ie:Mt,ie_version:Qt?At.documentMode||6:Ct?+Ct[1]:Tt?+Tt[1]:0,gecko:Dt,gecko_version:Dt?+(/Firefox\/(\d+)/.exec(Pt.userAgent)||[0,0])[1]:0,chrome:!!Nt,chrome_version:Nt?+Nt[1]:0,ios:!Mt&&/AppleWebKit/.test(Pt.userAgent)&&/Mobile\/\w+/.test(Pt.userAgent),android:/Android\b/.test(Pt.userAgent),webkit:Rt,safari:/Apple Computer/.test(Pt.vendor),webkit_version:Rt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=At.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};function zt(t){if(3==t.nodeType){let e=document.createRange();return e.setEnd(t,t.nodeValue.length),e.setStart(t,0),e.getClientRects()}return 1==t.nodeType?t.getClientRects():[]}function Wt(t,e,i,r){return!!i&&($t(t,e,i,r,-1)||$t(t,e,i,r,1))}function Bt(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function $t(t,e,i,r,n){for(;;){if(t==i&&e==r)return!0;if(e==(n<0?0:Ut(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Bt(t)+(n<0?0:1),t=i}else{if(1!=t.nodeType)return!1;t=t.childNodes[e+(n<0?-1:0)],e=n<0?Ut(t):0}}}function Ut(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Vt(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}class Lt{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}}class It{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new It(t.parentNode,Bt(t),e)}static after(t,e){return new It(t.parentNode,Bt(t)+1,e)}}const jt=[];class _t{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t){return null}sync(){if(2&this.dirty){let t=this.dom,e=t.firstChild;for(let i of this.children){if(i.dirty){if(e&&!i.dom&&!e.cmView){let r=e.previousSibling;i.reuseDOM(e)&&(e=r?r.nextSibling:t.firstChild)}i.sync(),i.dirty=0}e=Ft(t,e,i.dom)}for(;e;)e=Ht(e)}else if(1&this.dirty)for(let t of this.children)t.dirty&&(t.sync(),t.dirty=0)}reuseDOM(t){return!1}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let r=0==Ut(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==r&&e.firstChild!=e.lastChild&&(r=t==e.firstChild?-1:1),t=e}i=r<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!i.cmView;)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let r=this.children[t];if(r.dom==i)return e;e+=r.length+r.breakAfter}}domBoundsAround(t,e,i=0){let r=-1,n=-1,s=-1,o=-1;for(let h=0,a=i;h<this.children.length;h++){let i=this.children[h],l=a+i.length;if(a<t&&l>e)return i.domBoundsAround(t,e,a);if(l>=t&&-1==r&&(r=h,n=a),l>=e&&-1==s){s=h,o=l;break}a=l+i.breakAfter}return{from:n,to:o,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length-1?this.children[s+1].dom:null}}markDirty(t=!1){2&this.dirty||(this.dirty|=2,this.markParentsDirty(t))}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),1&e.dirty)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=jt){this.markDirty();for(let i=t;i<e;i++)this.children[i].parent=null;this.children.splice(t,e-t,...i);for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Xt(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}}function Ht(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}function Ft(t,e,i){if(i.parentNode==t){for(;e!=i;)e=Ht(e);e=i.nextSibling}else t.insertBefore(i,e);return e}_t.prototype.breakAfter=0;class Xt{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function qt(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}function Gt(t,e){if(t==e)return!0;if(!t||!e)return!1;let i=Object.keys(t),r=Object.keys(e);if(i.length!=r.length)return!1;for(let n of i)if(-1==r.indexOf(n)||t[n]!==e[n])return!1;return!0}function Zt(t,e,i){if(e)for(let r in e)i&&r in i||t.removeAttribute(r);if(i)for(let r in i)e&&e[r]==i[r]||t.setAttribute(r,i[r])}const Yt=[];class Kt extends _t{match(t){return!1}get children(){return Yt}getSide(){return 0}}class Jt extends Kt{constructor(t,e,i,r){super(),this.text=t,this.tagName=e,this.attrs=r,this.textDOM=null,this.class=i}get length(){return this.text.length}createDOM(t){let e=this.tagName||(this.attrs||this.class?"span":null);if(this.textDOM=t||document.createTextNode(this.text),e){let t=document.createElement(e);if(t.appendChild(this.textDOM),this.class&&(t.className=this.class),this.attrs)for(let e in this.attrs)t.setAttribute(e,this.attrs[e]);this.setDOM(t)}else this.setDOM(this.textDOM)}sync(){if(this.dom||this.createDOM(),this.textDOM.nodeValue!=this.text){this.textDOM.nodeValue=this.text;let t=this.dom;if(this.textDOM!=t&&(this.dom.firstChild!=this.textDOM||t.lastChild!=this.textDOM)){for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(this.textDOM)}}}reuseDOM(t){return 3==t.nodeType&&(this.createDOM(t),!0)}merge(t,e=this.length,i=null){return!(i&&(!(i instanceof Jt&&i.tagName==this.tagName&&i.class==this.class&&Gt(i.attrs,this.attrs))||this.length-(e-t)+i.length>256))&&(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}slice(t,e=this.length){return new Jt(this.text.slice(t,e),this.tagName,this.class,this.attrs)}localPosFromDOM(t,e){return t==this.textDOM?e:e?this.text.length:0}domAtPos(t){return new It(this.textDOM,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t){return te(this.textDOM,t)}}function te(t,e){let i=document.createRange();if(Et.chrome||Et.gecko)return i.setEnd(t,e),i.setStart(t,e),i.getBoundingClientRect();{let r=0==e?1:-1;i.setEnd(t,e+(r>0?1:0)),i.setStart(t,e-(r<0?1:0));let n=i.getBoundingClientRect(),s=r<0?n.right:n.left;return{left:s,right:s,top:n.top,bottom:n.bottom}}}class ee extends Kt{constructor(t,e,i,r){super(),this.widget=t,this.length=e,this.side=i,this.open=r}static create(t,e,i,r=0){return new(t.customView||ee)(t,e,i,r)}slice(t,e=this.length){return ee.create(this.widget,e-t,this.side)}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e=this.length,i=null){if(i){if(!(i instanceof ee)||!i.open||t>0&&!(1&i.open)||e<this.length&&!(2&i.open))return!1;if(!this.widget.compare(i.widget))throw new Error("Trying to merge incompatible widgets")}return this.length=t+(i?i.length:0)+(this.length-e),!0}match(t){return t.length==this.length&&t instanceof ee&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.eq(t.widget.value)||this.markDirty(!0),this.widget=t.widget,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return[""];let t=this;for(;t.parent;)t=t.parent;let e=t.state,i=e&&e.doc,r=this.posAtStart;return i?i.sliceLines(r,r+this.length):[""]}domAtPos(t){return 0==t?It.before(this.dom):It.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getClientRects();for(let i=t>0?e.length-1:0;;i+=t>0?-1:1){let r=e[i];if(t>0?0==i:i==e.length-1||r.top<r.bottom)return e[i]}return null}}class ie extends ee{domAtPos(t){return new It(this.widget.value.text,t)}sync(){this.dom||this.setDOM(this.widget.toDOM(this.editorView))}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t){return te(this.widget.value.text,t)}}class re{constructor(t){this.value=t}eq(t){return this.value===t}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t.value)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}}var ne;!function(t){t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange"}(ne||(ne={}));class se extends ot{constructor(t,e,i,r){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=r}get point(){return!1}get heightRelevant(){return!1}static mark(t,e,i){if(t>=e)throw new RangeError("Mark decorations may not be empty");return new ht(t,e,new oe(i))}static widget(t,e){let i=e.side||0;return e.block&&(i+=200000001*(i>0?1:-1)),new ht(t,t,new ae(e,i,i,!!e.block,e.widget))}static replace(t,e,i){let r=!!i.block,{start:n,end:s}=le(i),o=r?-2e8*(n?2:1):1e8*(n?-1:1),h=r?2e8*(s?2:1):1e8*(s?1:-1);if(t>e||t==e&&o>0&&h<0)throw new RangeError("Invalid range for replacement decoration");return new ht(t,Math.max(t,e),new ae(i,o,h,r,i.widget||null))}static line(t,e){return new ht(t,t,new he(e))}static set(t){return ct.of(t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}mapSimple(t,e,i){let r=t.mapPos(e,this.startSide,G.TrackDel);if(e==i&&this.startSide==this.endSide)return r<0?null:new ht(r,r,this);let n=t.mapPos(i,this.endSide,G.TrackDel);if(r<0){if(n<0)return null;r=this.startSide>=0?-(r+1):t.mapPos(e,1)}else n<0&&(n=this.endSide<0?-(n+1):t.mapPos(i,-1));return r<n?new ht(r,n,this):null}}se.none=ct.empty;class oe extends se{constructor(t){let{start:e,end:i}=le(t);super(1e8*(e?-1:1),1e8*(i?1:-1),null,t)}map(t,e,i){return this.mapSimple(t,e,i)}eq(t){return this==t||t instanceof oe&&this.spec.tagName==t.spec.tagName&&this.spec.class==t.spec.class&&Gt(this.spec.attributes||null,t.spec.attributes||null)}}class he extends se{constructor(t){super(-1e8,-1e8,null,t)}get point(){return!0}map(t,e){return(e=t.mapPos(e,-1,G.TrackBefore))<0?null:new ht(e,e,this)}eq(t){return t instanceof he&&Gt(this.spec.attributes,t.spec.attributes)}}class ae extends se{constructor(t,e,i,r,n){super(e,i,n,t),this.block=r}get point(){return!0}get type(){return this.startSide<this.endSide?ne.WidgetRange:this.startSide<0?ne.WidgetBefore:ne.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}map(t,e,i){if(this.block){let{type:r}=this,n=r==ne.WidgetAfter?t.mapPos(e,1,G.TrackAfter):t.mapPos(e,-1,G.TrackBefore),s=r==ne.WidgetRange?t.mapPos(i,1,G.TrackAfter):n;return n<0||s<0?null:new ht(n,s,this)}return this.mapSimple(t,e,i)}eq(t){return t instanceof ae&&(e=this.widget,i=t.widget,e==i||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}}function le(t){let{inclusiveStart:e,inclusiveEnd:i}=t;return null==e&&(e=t.inclusive),null==i&&(i=t.inclusive),{start:e||!1,end:i||!1}}function ce(t,e,i){i[i.length-1]+4>t?i[i.length-1]=e:i.push(t,e)}function ue(t,e){if(0==t.length)return e;if(0==e.length)return t;let i=[];for(let r=0,n=0;;)if(r<t.length&&(n==e.length||t[r]<e[n]))ce(t[r++],t[r++],i);else{if(!(n<e.length))break;ce(e[n++],e[n++],i)}return i}class fe{constructor(){this.content=[],this.height=[]}}class de{constructor(){this.changes=new fe}compareRange(t,e,i,r){ce(t,e,this.changes.content)}comparePoint(t,e,i,r){ce(t,e,this.changes.content),(t<e||i.heightRelevant||r&&r.heightRelevant)&&ce(t,e,this.changes.height)}}function pe(t,e,i,r){let n=new de;return t.compare(e,i,n,r),n.changes}const ge=new st.a({wrapper:{position:"relative !important",boxSizing:"border-box","&.codemirror-focused":{outline_fallback:"1px dotted #212121",outline:"5px auto -webkit-focus-ring-color"},display:"flex !important",flexDirection:"column"},scroller:{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%"},content:{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",boxSizing:"border-box",padding:"4px 0",outline:"none",caretColor:"black"},line:{display:"block",padding:"0 2px 0 4px"}},{priority:0});class me extends _t{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,r){if(i){if(!(i instanceof me))return!1;this.dom||i.transferDOM(this)}r&&this.setDeco(i?i.attrs:null);let n=i?i.children:[],s=this.childCursor(),{i:o,off:h}=s.findPos(e,1),{i:a,off:l}=s.findPos(t,-1),c=t-e;for(let t of n)c+=t.length;if(this.length+=c,a==o&&l){let t=this.children[a];if(1==n.length&&t.merge(l,h,n[0]))return!0;if(0==n.length)return t.merge(l,h,null),!0;let e=t.slice(h);e.merge(0,0,n[n.length-1])?n[n.length-1]=e:n.push(e),o++,h=0}if(h){let t=this.children[o];n.length&&t.merge(0,h,n[n.length-1])?n.pop():t.merge(0,h,null)}else o<this.children.length&&n.length&&this.children[o].merge(0,0,n[n.length-1])&&n.pop();if(l){let t=this.children[a];n.length&&t.merge(l,void 0,n[0])?n.shift():t.merge(l,void 0,null),a++}else a&&n.length&&this.children[a-1].merge(this.children[a-1].length,void 0,n[0])&&n.shift();for(;a<o&&n.length&&this.children[o-1].match(n[n.length-1]);)n.pop(),o--;for(;a<o&&n.length&&this.children[a].match(n[0]);)n.shift(),a++;return(n.length||a!=o)&&this.replaceChildren(a,o,n),!0}split(t){let e=new me;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:r}=this.childPos(t);r&&(e.append(this.children[i].slice(r)),this.children[i].merge(r,void 0,null),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t]);for(;i>0&&0==this.children[i-1].length;)this.children[i-1].parent=null,i--;return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Gt(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t){this.children.push(t),t.setParent(this),this.length+=t.length}addLineDeco(t){let e=t.spec.attributes;e&&(this.attrs=qt(e,this.attrs||{}))}domAtPos(t){let e=0;for(let i=0;e<this.children.length;e++){let r=this.children[e],n=i+r.length;if(!(n==i&&r.getSide()<=0)){if(t>i&&t<n&&r.dom.parentNode==this.dom)return r.domAtPos(t-i);if(t<=i)break;i=n}}for(;e>0;e--){let t=this.children[e-1].dom;if(t.parentNode==this.dom)return It.after(t)}return new It(this.dom,0)}sync(){this.dom||(this.setDOM(document.createElement("div")),this.dom.className="codemirror-line "+ge.line,this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Zt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("codemirror-line"),this.dom.classList.add(ge.line),this.prevAttrs=void 0),super.sync();let t=this.dom.lastChild;if(!t||"BR"!=t.nodeName&&!(t.cmView instanceof Jt)){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof Jt))return null;let i=zt(e.dom);if(1!=i.length)return null;t+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}coordsAt(t){for(let e=0,i=0;i<this.children.length;i++){let r=this.children[i],n=e+r.length;if(n>=t)return r.coordsAt(t-e);e=n}return this.dom.lastChild.getBoundingClientRect()}match(t){return!1}get type(){return ne.Text}}const Oe=[];class ve extends _t{constructor(t,e,i,r=0){super(),this.widget=t,this.length=e,this.type=i,this.open=r,this.breakAfter=0}merge(t,e,i){if(!(i instanceof ve)||!i.open||t>0&&!(1&i.open)||e<this.length&&!(2&i.open))return!1;if(!this.widget.compare(i.widget))throw new Error("Trying to merge an open widget with an incompatible node");return this.length=t+i.length+(this.length-e),!0}domAtPos(t){return 0==t?It.before(this.dom):It.after(this.dom,t==this.length)}split(t){let e=this.length-t;return this.length=t,new ve(this.widget,e,this.type)}get children(){return Oe}sync(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.state.doc.sliceLines(this.posAtStart,this.posAtEnd):[""]}domBoundsAround(){return null}match(t){return t instanceof ve&&t.type==this.type&&t.widget.constructor==this.widget.constructor&&(t.widget.eq(this.widget.value)||this.markDirty(!0),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0)}}class ye{constructor(t,e,i){this.doc=t,this.pos=e,this.end=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).start!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof ve&&t.type==ne.WidgetBefore)}getLine(){return this.curLine||this.content.push(this.curLine=new me),this.curLine}addWidget(t){this.curLine=null,this.content.push(t)}finish(){this.posCovered()||this.getLine()}buildText(t,e,i,r,n){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:r}=this.cursor.next(this.skip);if(this.skip=0,r)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.curLine=null,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t);this.getLine().append(new Jt(this.text.slice(this.textOff,this.textOff+n),e,i,r)),t-=n,this.textOff+=n}}span(t,e,i){let r=null,n=null,s=null;for(let{spec:t}of i)if(t.tagName&&(r=t.tagName),t.class&&(n=n?n+" "+t.class:t.class),t.attributes)for(let e in t.attributes){let i=t.attributes[e];null!=i&&("class"==e?n=n?n+" "+i:i:(s||(s={}),"style"==e&&s.style&&(i=s.style+";"+i),s[e]=i))}this.buildText(e-t,r,n,s,i),this.pos=e}point(t,e,i,r,n){let s=(r?1:0)|(n?2:0),o=e-t;if(i instanceof ae)if(i.block){let{type:t}=i;t!=ne.WidgetAfter||this.posCovered()||this.getLine(),this.addWidget(new ve(i.widget||new be("div"),o,t,s))}else this.getLine().append(ee.create(i.widget||new be("span"),o,i.startSide,s));else this.doc.lineAt(this.pos).start==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e)}ignore(){return!1}static build(t,e,i,r){let n=new ye(t,e,i);return ct.iterateSpans(r,e,i,n),n.finish(),n}}class be extends re{toDOM(){return document.createElement(this.value)}updateDOM(t){return t.nodeName.toLowerCase()==this.value}}const we=["pre-wrap","normal","pre-line"];class Se{constructor(){this.doc=m.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(t){return this.doc=t,this}mustRefresh(t){let e=!1;for(let i=0;i<t.length;i++){let r=t[i];r<0?i++:this.heightSamples[Math.floor(10*r)]||(e=!0,this.heightSamples[Math.floor(10*r)]=!0)}return e}refresh(t,e,i,r,n){let s=we.indexOf(t)>-1,o=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=r,o){this.heightSamples={};for(let t=0;t<n.length;t++){let e=n[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return o}}class xe{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class ke{constructor(t,e,i,r,n){this.from=t,this.length=e,this.top=i,this.height=r,this.type=n}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new ke(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var Pe;!function(t){t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight"}(Pe||(Pe={}));class Ae{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t,e){this.height!=e&&(this.height=e,t.heightChanged=!0)}replace(t,e,i){return Ae.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,r){let n=this;for(let s=r.length-1;s>=0;s--){let{fromA:o,toA:h,fromB:a,toB:l}=r[s],c=n.lineAt(o,Pe.ByPosNoHeight,e,0,0),u=c.to>=h?c:n.lineAt(h,Pe.ByPosNoHeight,e,0,0);for(l+=u.to-h,h=u.to;s>0&&c.from<=r[s-1].toA;)o=r[s-1].fromA,a=r[s-1].fromB,s--,o<c.from&&(c=n.lineAt(o,Pe.ByPosNoHeight,e,0,0));a+=c.from-o,o=c.from;let f=Ne.build(i,t,a,l);n=n.replace(o,h,f)}return n.updateHeight(i,0)}static empty(){return new Qe(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,r=0,n=0;for(;;)if(e==i)if(r>2*n){let n=t[e-1];n.break?t.splice(--e,1,n.left,null,n.right):t.splice(--e,1,n.left,n.right),i+=1+n.break,r-=n.size}else{if(!(n>2*r))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,n-=e.size}}else if(r<n){let i=t[e++];i&&(r+=i.size)}else{let e=t[--i];e&&(n+=e.size)}let s=0;return null==t[e-1]?(s=1,e--):null==t[e]&&(s=1,i++),new Me(Ae.of(t.slice(0,e)),s,Ae.of(t.slice(i)))}}Ae.prototype.size=1;class Te extends Ae{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,r){return new ke(r,this.length,i,this.height,this.type)}lineAt(t,e,i,r,n){return this.blockAt(0,i,r,n)}forEachLine(t,e,i,r,n,s){s(this.blockAt(0,i,r,n))}updateHeight(t,e=0,i=!1,r){return r&&r.from<=e&&r.more&&this.setHeight(t,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Qe extends Te{constructor(t,e){super(t,e,ne.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){return 1==i.length&&i[0]instanceof Qe&&Math.abs(this.length-i[0].length)<10?(i[0].height=this.height,i[0]):Ae.of(i)}updateHeight(t,e=0,i=!1,r){return r&&r.from<=e&&r.more?this.setHeight(t,r.heights[r.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ce extends Ae{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,r=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:r,lineHeight:this.height/(r-i+1)}}blockAt(t,e,i,r){let{firstLine:n,lastLine:s,lineHeight:o}=this.lines(e,r),h=Math.max(0,Math.min(s-n,Math.floor((t-i)/o))),{start:a,length:l}=e.line(n+h);return new ke(a,l,i+o*h,o,ne.Text)}lineAt(t,e,i,r,n){if(e==Pe.ByHeight)return this.blockAt(t,i,r,n);if(e==Pe.ByPosNoHeight){let{start:e,end:r}=i.lineAt(t);return new ke(e,r-e,0,0,ne.Text)}let{firstLine:s,lineHeight:o}=this.lines(i,n),{start:h,length:a,number:l}=i.lineAt(t);return new ke(h,a,r+o*(l-s),o,ne.Text)}forEachLine(t,e,i,r,n,s){let{firstLine:o,lastLine:h,lineHeight:a}=this.lines(i,n);for(let n=o;n<=h;n++){let{start:o,end:h}=i.line(n);if(o>e)break;h>=t&&s(new ke(o,h-o,r,r+=a,ne.Text))}}replace(t,e,i){let r=this.length-e;if(r>0){let t=i[i.length-1];t instanceof Ce?i[i.length-1]=new Ce(t.length+r):i.push(null,new Ce(r-1))}if(t>0){let e=i[0];e instanceof Ce?i[0]=new Ce(t+e.length):i.unshift(new Ce(t-1),null)}return Ae.of(i)}decomposeLeft(t,e){e.push(t==this.length?this:new Ce(t))}decomposeRight(t,e){e.push(0==t?this:new Ce(this.length-t))}updateHeight(t,e=0,i=!1,r){let n=e+this.length;if(r&&r.from<=e+this.length&&r.more){let i=[],s=Math.max(e,r.from);for(r.from>e&&i.push(new Ce(r.from-e-1).updateHeight(t,e));s<=n&&r.more;){let e=t.doc.lineAt(s).length;i.length&&i.push(null);let n=new Qe(e,r.heights[r.index++]);n.outdated=!1,i.push(n),s+=e+1}return s<=n&&i.push(null,new Ce(n-s).updateHeight(t,s)),t.heightChanged=!0,Ae.of(i)}return(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Me extends Ae{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,r){let n=i+this.left.height;return t<n||0==this.right.height?this.left.blockAt(t,e,i,r):this.right.blockAt(t,e,n,r+this.left.length+this.break)}lineAt(t,e,i,r,n){let s=r+this.left.height,o=n+this.left.length+this.break,h=e==Pe.ByHeight?t<s||0==this.right.height:t<o,a=h?this.left.lineAt(t,e,i,r,n):this.right.lineAt(t,e,i,s,o);if(this.break||(h?a.to<o:a.from>o))return a;let l=e==Pe.ByPosNoHeight?Pe.ByPosNoHeight:Pe.ByPos;return h?a.join(this.right.lineAt(o,l,i,s,o)):this.left.lineAt(o,l,i,r,n).join(a)}forEachLine(t,e,i,r,n,s){let o=r+this.left.height,h=n+this.left.length+this.break;if(this.break)t<h&&this.left.forEachLine(t,e,i,r,n,s),e>=h&&this.right.forEachLine(t,e,i,o,h,s);else{let a=this.lineAt(h,Pe.ByPos,i,r,n);t<a.from&&this.left.forEachLine(t,a.from-1,i,r,n,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,o,h,s)}}replace(t,e,i){let r=this.left.length+this.break;if(e<r)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-r,e-r,i));let n=[];t>0&&this.decomposeLeft(t,n);let s=n.length;for(let t of i)n.push(t);if(t>0&&De(n,s-1),e<this.length){let t=n.length;this.decomposeRight(e,n),De(n,t)}return Ae.of(n)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,r=i+this.break;if(t>=r)return this.right.decomposeRight(t-r,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<r&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?Ae.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,r){let{left:n,right:s}=this,o=e+n.length+this.break,h=null;return r&&r.from<=e+n.length&&r.more?h=n=n.updateHeight(t,e,i,r):n.updateHeight(t,e,i),r&&r.from<=o+s.length&&r.more?h=s=s.updateHeight(t,o,i,r):s.updateHeight(t,o,i),h?this.balanced(n,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function De(t,e){let i,r;null==t[e]&&(i=t[e-1])instanceof Ce&&(r=t[e+1])instanceof Ce&&t.splice(e-1,3,new Ce(i.length+1+r.length))}class Ne{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Qe?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new Qe(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){let r=i.widget?Math.max(0,i.widget.estimatedHeight):0,n=e-t;i.block?this.addBlock(new Te(n,r,i.type)):(n||r>=5)&&this.addLineDeco(r,n),this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).end)}enterLine(){if(this.lineStart>-1)return;let{start:t,end:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(new Ce(t-this.writtenTo-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Qe(this.pos-t,-1)),this.writtenTo=this.pos}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Qe)return t;let e=new Qe(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type!=ne.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=ne.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof Qe||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(new Ce(this.pos-this.writtenTo)):this.nodes.push(new Qe(0,-1));let i=t;for(let t of this.nodes)t instanceof Qe&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}ignore(t,e,i){return t==e&&!i.heightRelevant}static build(t,e,i,r){let n=new Ne(i,t);return ct.iterateSpans(e,i,r,n),n.finish(i)}}class Re{constructor(){this.top=0,this.bottom=0}updateFromDOM(t,e){let{top:i,bottom:r}=function(t,e){let i=t.getBoundingClientRect(),r=Math.max(0,Math.min(innerHeight,i.top)),n=Math.max(0,Math.min(innerHeight,i.bottom));for(let e=t.parentNode;e;)if(1==e.nodeType){if(e.scrollHeight>e.clientHeight){let t=e.getBoundingClientRect();r=Math.min(t.bottom,Math.max(t.top,r)),n=Math.min(t.bottom,Math.max(t.top,n))}e=e.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{top:r-(i.top+e),bottom:n-(i.top+e)}}(t,e),n=i-this.top,s=r-this.bottom,o=0;return n>0&&s>0?o=Math.max(n,s):n<0&&s<0&&(o=Math.min(n,s)),this.top=i,this.bottom=r,o}coverEverything(){this.top=-1e9,this.bottom=1e9}getViewport(t,e,i,r){let n=.5-Math.max(-.5,Math.min(.5,i/1e3/2)),s=new Ee(e.lineAt(this.top-1e3*n,Pe.ByHeight,t,0,0).from,e.lineAt(this.bottom+1e3*(1-n),Pe.ByHeight,t,0,0).to);if(r>-1)if(r<s.from){let{top:i}=e.lineAt(r,Pe.ByPos,t,0,0);s=new Ee(e.lineAt(i-500,Pe.ByHeight,t,0,0).from,e.lineAt(i+(this.bottom-this.top)+500,Pe.ByHeight,t,0,0).to)}else if(r>s.to){let{bottom:i}=e.lineAt(r,Pe.ByPos,t,0,0);s=new Ee(e.lineAt(i-(this.bottom-this.top)-500,Pe.ByHeight,t,0,0).from,e.lineAt(i+500,Pe.ByHeight,t,0,0).to)}return s}coveredBy(t,e,i,r=0){let{top:n}=i.lineAt(e.from,Pe.ByPos,t,0,0),{bottom:s}=i.lineAt(e.to,Pe.ByPos,t,0,0);return(0==e.from||n<=this.top-Math.max(10,Math.min(-r,250)))&&(e.to==t.length||s>=this.bottom+Math.max(10,Math.min(r,250)))}}class Ee{constructor(t,e){this.from=t,this.to=e}clip(t){return Math.max(this.from,Math.min(this.to,t))}eq(t){return this.from==t.from&&this.to==t.to}}const ze={childList:!0,characterData:!0,subtree:!0,characterDataOldValue:!0},We=Et.ie&&Et.ie_version<=11;class Be{constructor(t,e,i){this.docView=t,this.onChange=e,this.onScrollChanged=i,this.active=!1,this.ignoreSelection=new Lt,this.charDataQueue=[],this.charDataTimeout=null,this.scrollTargets=[],this.intersection=null,this.intersecting=!1,this.dom=t.dom,this.observer=new MutationObserver(t=>this.flush(t)),We&&(this.onCharData=t=>{this.charDataQueue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),null==this.charDataTimeout&&(this.charDataTimeout=setTimeout(()=>this.flush(),20))}),this.onSelectionChange=()=>{this.docView.root.activeElement==this.dom&&this.flush()},this.start(),this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(t=>{t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.onScroll())},{}),this.intersection.observe(this.dom)),this.listenForScroll()}onScroll(){this.intersecting&&(this.flush(),this.onScrollChanged())}listenForScroll(){let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,ze),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange),We&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),We&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}takeCharRecords(){let t=this.charDataQueue;return t.length&&(this.charDataQueue=[],clearTimeout(this.charDataTimeout),this.charDataTimeout=null),t}clearSelection(){this.ignoreSelection.set(this.docView.root.getSelection())}clear(){this.observer.takeRecords(),this.takeCharRecords(),this.clearSelection()}flush(t=this.observer.takeRecords()){this.charDataQueue.length&&(t=t.concat(this.takeCharRecords()));let e=this.docView.root.getSelection(),i=!this.ignoreSelection.eq(e)&&function(t,e){if(!e.anchorNode)return!1;try{return t.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)}catch(t){return!1}}(this.dom,e);if(0==t.length&&!i)return;let r=-1,n=-1,s=!1;for(let e of t){let t=this.readMutation(e);t&&(t.typeOver&&(s=!0),-1==r?({from:r,to:n}=t):(r=Math.min(t.from,r),n=Math.max(t.to,n)))}(r>-1||i)&&this.onChange(r,n,s)||(this.docView.dirty&&(this.ignore(()=>this.docView.sync()),this.docView.dirty=0),this.docView.updateSelection()),this.clearSelection()}readMutation(t){let e=this.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(),"childList"==t.type){let i=$e(e,t.previousSibling||t.target.previousSibling,-1),r=$e(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:r?e.posBefore(r):e.posAtEnd,typeOver:!1}}return{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}destroy(){this.stop(),this.intersection&&this.intersection.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll)}}function $e(t,e,i){for(;e;){let r=e.cmView;if(r&&r.parent==t)return r;let n=e.parentNode;e=n!=t.dom?n:i>0?e.nextSibling:e.previousSibling}return null}const Ue=[],Ve=new D(t=>t.plugins),Le=Ve.behavior(),Ie=Ve.behavior(),je=Ve.behavior();class _e{constructor(t,e,i){this.create=t,this.id=e,this.behaviorExtensions=i,this.extension=[Xe(this),...this.behaviorExtensions]}static create(t){return new _e(t,Ve.storageID(),[])}behavior(t,e){return new _e(this.create,this.id,this.behaviorExtensions.concat(Ve.dynamic(t,t=>e(t.plugin(this)))))}decorations(t){return this.behavior(qe,t)}static decoration(t){return _e.create(e=>new Ge(e,t)).decorations(t=>t.decorations).extension}}const He=Ve.behavior({combine:t=>t.reduce((t,e)=>qt(e,t),{})}),Fe=Ve.behavior({combine:t=>t.reduce((t,e)=>qt(e,t),{})}),Xe=Ve.behavior({static:!0}),qe=Ve.behavior();class Ge{constructor(t,e){this.spec=e,this.decorations=e.create(t)}update(t){this.decorations=this.spec.update(this.spec.map?this.decorations.map(t.changes):this.decorations,t)}}const Ze=Ve.behavior(),Ye=Ve.behavior(),Ke=Ve.behavior(),Je=Ve.behavior({combine(t){let e={left:0,top:0,right:0,bottom:0};for(let i of t)e.left=Math.max(e.left,i.left||0),e.top=Math.max(e.top,i.top||0),e.right=Math.max(e.right,i.right||0),e.bottom=Math.max(e.bottom,i.bottom||0);return e}}),ti=F.define(),ei=F.define();class ii{constructor(t,e=Ue,i=Ue){this.view=t,this.transactions=e,this._annotations=i,this.state=e.length?e[e.length-1].apply():t.state,this.changes=e.reduce((t,e)=>t.appendSet(e.changes),K.empty),this.prevState=t.state,this.prevViewport=t._viewport,this.prevThemes=t.behavior(Ye)}get viewport(){return this.view._viewport}get viewportChanged(){return!this.prevViewport.eq(this.view._viewport)}get docChanged(){return this.transactions.some(t=>t.docChanged)}get themeChanged(){return this.prevThemes!=this.view.behavior(Ye)}annotation(t){for(let e of this._annotations)if(e.type==t)return e.value;for(let e=this.transactions.length-1;e>=0;e--){let i=this.transactions[e].annotation(t);if(void 0!==i)return i}}annotations(t){let e=Ue;for(let i of this.transactions){let r=i.annotations(t);r.length&&(e=e.concat(r))}for(let i of this._annotations)i.type==t&&(e=e.concat([i.value]));return e}}const ri=[];class ni extends _t{constructor(t,e){super(),this.view=t,this.viewports=ri,this.compositionDeco=se.none,this.gapDeco=se.none,this.selectionDirty=null,this.forceSelectionUpdate=!1,this.heightMap=Ae.empty(),this.heightOracle=new Se,this.layoutCheckScheduled=-1,this.scrollIntoView=-1,this.paddingTop=0,this.paddingBottom=0,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.setDOM(t.contentDOM),this.viewportState=new Re,this.observer=new Be(this,e,()=>this.checkLayout())}get length(){return this.state.doc.length}get state(){return this.view.state}get viewport(){return this.view._viewport}get root(){return this.view.root}get editorView(){return this.view}init(t,e){this.children=[new me],this.children[0].setParent(this),this.viewports=this.decorations=ri,this.minWidth=0,this.compositionDeco=se.none;let i=[new tt(0,0,0,t.doc.length)];this.heightMap=this.heightMap.applyChanges(ri,m.empty,this.heightOracle.setDoc(t.doc),i),this.computeUpdate(t,t.doc,null,e,ri,0,-1),this.updateInner(i,0),this.scheduleLayoutCheck()}update(t,e=-1){let i=this.state.doc,r=t?t.state:this.state,n=t?t.changes.changedRanges():ri;this.minWidth>0&&n.length&&(n.every(({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo)?(this.minWidthFrom=tt.mapPos(this.minWidthFrom,1,n),this.minWidthTo=tt.mapPos(this.minWidthTo,1,n)):this.minWidth=0);let s=this.computeUpdate(r,i,t,null,n,0,e);Et.chrome&&!this.compositionDeco.size&&t&&t.changes.changes.some(t=>t.text.length>1)&&(this.forceSelectionUpdate=!0),0==this.dirty&&0==s.length&&this.state.selection.primary.from>=this.viewport.from&&this.state.selection.primary.to<=this.viewport.to&&(!t||0==t._annotations.length)?(this.updateSelection(),e>-1&&this.scrollPosIntoView(e),t&&this.scheduleLayoutCheck()):(this.updateInner(s,i.length),this.cancelLayoutCheck(),e>-1&&(this.scrollIntoView=e),this.scheduleLayoutCheck())}scheduleLayoutCheck(){this.layoutCheckScheduled=requestAnimationFrame(()=>this.checkLayout())}updateInner(t,e){let i=this.viewport,r=[i],{head:n,anchor:s}=this.state.selection.primary;if(n<i.from||n>i.to){let{from:t,to:e}=this.lineAt(n,0);r.push(new Ee(t,e))}if(!r.some(({from:t,to:e})=>s>=t&&s<=e)){let{from:t,to:e}=this.lineAt(s,0);r.push(new Ee(t,e))}r.sort((t,e)=>t.from-e.from),this.updateChildren(t,r,e),this.viewports=r,this.observer.ignore(()=>{this.dom.style.height=this.heightMap.height+"px",this.dom.style.minWidth=this.minWidth+"px",this.sync(),this.dirty=0,this.updateSelection(),this.dom.style.height=""})}updateChildren(t,e,i){let r=this.computeGapDeco(e,this.length),n=pe(this.gapDeco,r,t,i);this.gapDeco=r,t=hi(t,n.content);let s=[r].concat(this.decorations),o=this.childCursor(i);for(let e=t.length-1;;e--){let i=e>=0?t[e]:null;if(!i)break;let{fromA:r,toA:n,fromB:h,toB:a}=i,{content:l,breakAtStart:c}=ye.build(this.state.doc,h,a,s),{i:u,off:f}=o.findPos(n,1),{i:d,off:p}=o.findPos(r,-1);this.replaceRange(d,p,u,f,l,c)}}replaceRange(t,e,i,r,n,s){let o=this.children[t],h=n.length?n[n.length-1]:null,a=h?h.breakAfter:s;if(t==i&&!s&&!a&&n.length<2&&o.merge(e,r,n.length?h:null,0==e))return;let l=this.children[i];for(r<l.length||l.children.length&&0==l.children[l.children.length-1].length?(t==i&&(l=l.split(r),r=0),!a&&h&&l.merge(0,r,h,!0)?n[n.length-1]=l:((r||l.children.length&&0==l.children[0].length)&&l.merge(0,r,null,!1),n.push(l))):l.breakAfter&&(h?h.breakAfter=1:s=1),i++,o.breakAfter=s,e>0&&(!s&&n.length&&o.merge(e,o.length,n[0],!1)?o.breakAfter=n.shift().breakAfter:(e<o.length||o.children.length&&0==o.children[o.children.length-1].length)&&o.merge(e,o.length,null,!1),t++);t<i&&n.length;)if(this.children[i-1].match(n[n.length-1]))i--,n.pop();else{if(!this.children[t].match(n[0]))break;t++,n.shift()}(t<i||n.length)&&this.replaceChildren(t,i,n)}updateSelection(t=!1){if(this.clearSelectionDirty(),this.root.activeElement!=this.dom){if(!t)return;Et.gecko&&this.dom.focus()}let e=this.state.selection.primary,i=this.domAtPos(e.anchor),r=this.domAtPos(e.head),n=this.root.getSelection();!this.forceSelectionUpdate&&Wt(i.node,i.offset,n.anchorNode,n.anchorOffset)&&Wt(r.node,r.offset,n.focusNode,n.focusOffset)||(this.forceSelectionUpdate=!1,this.observer.ignore(()=>{if(n.extend)n.collapse(i.node,i.offset),e.empty||n.extend(r.node,r.offset);else{let t=document.createRange();e.anchor>e.head&&([i,r]=[r,i]),t.setEnd(r.node,r.offset),t.setStart(i.node,i.offset),n.removeAllRanges(),n.addRange(t)}})),this.impreciseAnchor=i.precise?null:new It(n.anchorNode,n.anchorOffset),this.impreciseHead=r.precise?null:new It(n.focusNode,n.focusOffset)}lineAt(t,e){return null==e&&(e=this.dom.getBoundingClientRect().top),this.heightMap.lineAt(t,Pe.ByPos,this.state.doc,e+this.paddingTop,0)}lineAtHeight(t,e){return null==e&&(e=this.dom.getBoundingClientRect().top),this.heightMap.lineAt(t,Pe.ByHeight,this.state.doc,e+this.paddingTop,0)}blockAtHeight(t,e){return null==e&&(e=this.dom.getBoundingClientRect().top),this.heightMap.blockAt(t,this.state.doc,e+this.paddingTop,0)}forEachLine(t,e,i,r){return null==r&&(r=this.dom.getBoundingClientRect().top),this.heightMap.forEachLine(t,e,this.state.doc,r+this.paddingTop,0,i)}computeUpdate(t,e,i,r,n,s,o){let h=n.length?n:null,a=this.viewport||new Ee(0,0);for(let l=0;;l++){let c;if(h){let t=tt.mapPos(a.from,-1,n);c=new Ee(t,Math.min(t+(a.to-a.from)+1e3,tt.mapPos(a.to,1,n)))}else c=this.viewportState.getViewport(t.doc,this.heightMap,s,o);if(!(!a||!c.eq(a)||h||i||r))return n;if(5==l)return console.warn("Viewport and decorations failed to converge"),n;let u=this.state||t;r?r(c):this.view.updateInner(i||new ii(this.view),c),a=c,this.view.inputState.composing?i&&i.transactions.length&&(this.compositionDeco=li(this.view,n)):this.compositionDeco=se.none;let f=this.view.behavior(qe).concat(this.compositionDeco);if(!i&&!r&&ai(f,this.decorations))return n;let{content:d,height:p}=oi(i?n:ri,f,this.decorations,u.doc.length);this.decorations=f;let g=hi(h||ri,p);this.heightMap=this.heightMap.applyChanges(f,e,this.heightOracle.setDoc(t.doc),g),h=null,e=t.doc,n=hi(n,d),i=null,r=null}}focus(){this.updateSelection(!0)}cancelLayoutCheck(){this.layoutCheckScheduled>-1&&(cancelAnimationFrame(this.layoutCheckScheduled),this.layoutCheckScheduled=-1)}checkLayout(t=!1){this.cancelLayoutCheck(),this.measureVerticalPadding();let e=Math.min(this.scrollIntoView,this.state.doc.length);this.scrollIntoView=-1;let i=0;if(t?this.viewportState.coverEverything():i=this.viewportState.updateFromDOM(this.dom,this.paddingTop),this.viewportState.top>=this.viewportState.bottom)return;this.view.updateState=1;let r=this.measureVisibleLineHeights(),n=!1;if(this.heightOracle.mustRefresh(r)){let{lineHeight:t,charWidth:e}=this.measureTextSize();n=this.heightOracle.refresh(getComputedStyle(this.dom).whiteSpace,t,e,this.dom.clientWidth/e,r),n&&(this.minWidth=0)}e>-1&&this.scrollPosIntoView(e);let s=[];for(let t of this.view.behavior(Xe)){let e=this.view.plugin(t);e.measure&&e.drawMeasured&&s.push(e)}let o=!1,h=s.map(t=>t.measure());for(let t=0;;t++){this.heightOracle.heightChanged=!1,this.heightMap=this.heightMap.updateHeight(this.heightOracle,0,n,new xe(this.viewport.from,r||this.measureVisibleLineHeights()));let e=this.viewportState.coveredBy(this.state.doc,this.viewport,this.heightMap,i);if(e&&!this.heightOracle.heightChanged)break;if(t>10){console.warn("Layout failed to converge");break}this.view.updateState=2,o=!0;let a=e?ri:this.computeUpdate(this.state,this.state.doc,null,null,ri,i,-1);this.updateInner(a,this.length),r=null,n=!1,i=0,this.view.updateState=1,this.viewportState.updateFromDOM(this.dom,this.paddingTop),h=s.map(t=>t.measure())}for(this.view.updateState=2;s.length;)s=s.filter((t,e)=>t.drawMeasured(h[e])),h=s.map(t=>t.measure());o&&(this.observer.listenForScroll(),this.view.drawPlugins()),this.view.updateState=0}scrollPosIntoView(t){let e=this.coordsAt(t);if(!e)return;let i=this.view.behavior(Je);!function(t,e){let i=t.ownerDocument.defaultView;for(let r=t.parentNode;r;)if(1==r.nodeType){let t,n=r==document.body;if(n)t=Vt(i);else{if(r.scrollHeight<=r.clientHeight&&r.scrollWidth<=r.clientWidth){r=r.parentNode;continue}let e=r.getBoundingClientRect();t={left:e.left,right:e.left+r.clientWidth,top:e.top,bottom:e.top+r.clientHeight}}let s=0,o=0;if(e.top<t.top?o=-(t.top-e.top+5):e.bottom>t.bottom&&(o=e.bottom-t.bottom+5),e.left<t.left?s=-(t.left-e.left+5):e.right>t.right&&(s=e.right-t.right+5),s||o)if(n)i.scrollBy(s,o);else{if(o){let t=r.scrollTop;r.scrollTop+=o,o=r.scrollTop-t}if(s){let t=r.scrollLeft;r.scrollLeft+=s,s=r.scrollLeft-t}e={left:e.left-s,top:e.top-o,right:e.right-s,bottom:e.bottom-o}}if(n)break;r=r.parentNode}else{if(11!=r.nodeType)break;r=r.host}}(this.dom,{left:e.left-i.left,top:e.top-i.top,right:e.right+i.right,bottom:e.bottom+i.bottom})}nearest(t){for(let e=t;e;){let t=e.cmView;if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof me)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t){for(let e=this.length,i=this.children.length-1;;i--){let r=this.children[i],n=e-r.breakAfter-r.length;if(t>=n&&r.type!=ne.WidgetAfter)return r.coordsAt(t-n);e=n}}measureVisibleLineHeights(){let t=[],{from:e,to:i}=this.viewport,r=Math.max(this.dom.clientWidth,this.minWidth)+1;for(let n=0,s=0;s<this.children.length;s++){let o=this.children[s],h=n+o.length;if(h>i)break;if(n>=e){t.push(o.dom.getBoundingClientRect().height);let e=o.dom.scrollWidth;e>r&&(this.minWidth=r=e,this.minWidthFrom=n,this.minWidthTo=h)}n=h+o.breakAfter}return t}measureVerticalPadding(){let t=window.getComputedStyle(this.dom);this.paddingTop=parseInt(t.paddingTop)||0,this.paddingBottom=parseInt(t.paddingBottom)||0}measureTextSize(){for(let t of this.children)if(t instanceof me){let e=t.measureTextSize();if(e)return e}let t,e,i=document.createElement("div");return i.className="codemirror-line",i.textContent="abc def ghi jkl mno pqr stu",this.observer.ignore(()=>{this.dom.appendChild(i);let r=zt(i.firstChild)[0];t=i.getBoundingClientRect().height,e=r?r.width/27:7,i.remove()}),{lineHeight:t,charWidth:e}}destroy(){cancelAnimationFrame(this.layoutCheckScheduled),this.observer.destroy()}clearSelectionDirty(){null!=this.selectionDirty&&(cancelAnimationFrame(this.selectionDirty),this.selectionDirty=null)}setSelectionDirty(){this.observer.clearSelection(),null==this.selectionDirty&&(this.selectionDirty=requestAnimationFrame(()=>this.updateSelection()))}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Xt(this.children,t,e)}computeGapDeco(t,e){let i=[];for(let r=0,n=0;;n++){let s=n==t.length?null:t[n],o=s?s.from-1:e;if(o>r){let t=this.lineAt(o,0).bottom-this.lineAt(r,0).top;i.push(se.replace(r,o,{widget:new si(t),block:!0,inclusive:!0}))}if(!s)break;r=s.to+1}return se.set(i)}}class si extends re{toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}updateDOM(t){if(this.value<1e7){for(;t.lastChild;)t.lastChild.remove();t.style.height=this.value+"px"}else{t.style.height="";for(let e=this.value;e>0;e-=1e7){t.appendChild(document.createElement("div")).style.height=Math.min(e,1e7)+"px"}}return!0}get estimatedHeight(){return this.value}}function oi(t,e,i,r){let n=[],s=[];for(let o=e.length-1;o>=0;o--){let h=e[o],a=o<i.length?i[o]:se.none;if(0==h.size&&0==a.size)continue;let l=pe(a,h,t,r);n=ue(n,l.content),s=ue(s,l.height)}return{content:n,height:s}}function hi(t,e){if(0==e.length)return t;let i=[];for(let r=0,n=0,s=0,o=0;;r++){let h=r==t.length?null:t[r],a=s-o,l=h?h.fromB:1e9;for(;n<e.length&&e[n]<l;){let t=e[n],r=e[n+1],s=Math.max(o,t),h=Math.min(l,r);if(s<=h&&new tt(s+a,h+a,s,h).addToSet(i),r>l)break;n+=2}if(!h)return i;new tt(h.fromA,h.toA,h.fromB,h.toB).addToSet(i),s=h.toA,o=h.toB}}function ai(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function li(t,e){let i=t.root.getSelection(),r=i.focusNode&&function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0)t=t.childNodes[e-1],e=Ut(t);else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(i.focusNode,i.focusOffset);if(!r)return se.none;let n,s,o=t.docView.nearest(r),h=r;if(o instanceof Kt)n=o.posAtStart,s=n+o.length,h=o.dom;else{if(!(o instanceof me))return se.none;{for(;h.parentNode!=o.dom;)h=h.parentNode;let t=h.previousSibling;for(;t&&!t.cmView;)t=t.previousSibling;n=s=t?t.cmView.posAtEnd:o.posAtStart}}let a=tt.mapPos(n,1,e),l=Math.max(a,tt.mapPos(s,-1,e)),c=r.nodeValue,u=t.state.doc;if(l-a<c.length)if(u.slice(a,Math.min(u.length,a+c.length))==c)l=a+c.length;else{if(u.slice(Math.max(0,l-c.length),l)!=c)return se.none;a=l-c.length}else if(u.slice(a,l)!=c)return se.none;return se.set(se.replace(a,l,{widget:new ci({top:h,text:r})}))}class ci extends re{eq(t){return this.value.top==t.top&&this.value.text==t.text}toDOM(){return this.value.top}ignoreEvent(){return!1}get customView(){return ie}}function ui(t,e,i,r="character",n){let s=t.root.getSelection(),o=fi.get(t,e),h="forward"==i||"right"==i?1:-1;if(!s.modify||!o||o.nearViewportEnd(t)||!t.hasFocus||"word"==r||"line"==r&&(Et.gecko||t.state.selection.ranges.length>1)){if("character"==r)return function(t,e,i,r){if(null==i)for(let i=t;;i+=e){if(e<0&&0==i||e>0&&i==r.length)return i;if(!a((e<0?r.slice(i-1,i):r.slice(i,i+1)).charCodeAt(0))){if(e<0)return i-1;if(i!=t)return i}}for(let{i:n,off:s}=i.line.childPos(t-i.start),{children:o}=i.line,h=t;;){if(s==(e<0||n==o.length?0:o[n].length)){if(n+=e,n<0||n>=o.length)return Math.max(0,Math.min(r.length,h+(t==h?e:0)));s=e<0?o[n].length:0}let i=o[n];if(i instanceof Jt){if(!a(i.text.charCodeAt(s-(e<0?1:0)))){if(e<0)return h-1;if(h!=t)return h}s+=e,h+=e}else if(i.length>0)return h-s+(e<0?0:i.length)}}(e,h,o,t.state.doc);if("lineboundary"==r){if(o)return o.start+(h<0?0:o.line.length);let i=t.state.doc.lineAt(e);return h<0?i.start:i.end}if("line"==r){if(o&&!o.nearViewportEnd(t,h)){let i=t.docView.coordsAt(e),r=function(t,e,i){for(let i of t.inputState.goalColumns)if(i.pos==e)return i;let r={pos:0,column:i};return t.inputState.goalColumns.push(r),r}(t,e,i.left);for(let n=h<0?i.top:i.bottom,s=5;s<50;s+=10){let i=yi(t,{x:r.column,y:n+s*h},h);if(i<0)break;if(i!=e)return r.pos=i,i}}return function(t,e,i,r){let n=t.lineAt(i),s=0;for(const r=t.iterRange(n.start,i);!r.next().done;)s=p(r.value,s,e);if(r<0&&0==n.start)return 0;if(r>0&&n.end==t.length)return n.end;let o=t.line(n.number+r),h=o.start,a=0;for(const i=t.iterRange(o.start,o.end);a>=s&&!i.next().done;){const{offset:t,leftOver:r}=g(i.value,a,s,e);a=s-r,h+=t}return h}(t.state.doc,t.state.tabSize,e,h)}if("word"==r)return function(t,e,i){let{doc:r}=t.state;for(let n=e,s=0;;s++){let e=ui(t,n,i,"character","move");if(e==n)return n;if(r.sliceLines(Math.min(e,n),Math.max(e,n)).length>1)return e;let o=U.groupAt(t.state,e,e>n?-1:1),h=n<o.from&&n>o.to?n<o.head:o.from!=n&&(o.to==n||e<n);if(n=h?o.from:o.to,s>0||/\S/.test(r.slice(o.from,o.to)))return n;e=Math.max(0,Math.min(r.length,n+(h?-1:1)))}}(t,e,i);throw new RangeError("Invalid move granularity: "+r)}return t.docView.observer.ignore(()=>{let h=o.prepareForQuery(t,e),a=t.docView.domAtPos(e),l=(!Et.chrome||0==h.lines.length)&&Wt(a.node,a.offset,s.focusNode,s.focusOffset)&&!1;h.atWidget&&Et.gecko&&"extend"==n&&(n="move"),"move"!=n||l&&s.isCollapsed?"extend"!=n||l||s.extend(a.node,a.offset):s.collapse(a.node,a.offset),s.modify(n,i,r),t.docView.setSelectionDirty();let c=t.docView.posFromDOM(s.focusNode,s.focusOffset);return o.undoQueryPreparation(t,h),c})}class fi{constructor(t,e,i){this.line=t,this.start=e,this.index=i}static get(t,e){for(let i=0,r=0;;i++){let n=t.docView.children[i],s=r+n.length;if(s>=e){if(n instanceof me)return new fi(n,r,i);if(n.length)return null}r=s+1}}nearViewportEnd(t,e=0){for(let{from:i,to:r}of t.docView.viewports)if(i>0&&i==this.start&&e<=0||r<t.state.doc.length&&r==this.start+this.line.length&&e>=0)return!0;return!1}prepareForQuery(t,e){let i=[],r=!1;function n(t){return t instanceof Jt||(r=!0),!(t.length>0)&&(t.dom.remove(),i.indexOf(t.parent)<0&&i.push(t.parent),!0)}let{i:s,off:o}=this.line.childPos(e-this.start);if(0==o){for(let t=s;t<this.line.children.length&&n(this.line.children[t]);t++);for(let t=s;t>0&&n(this.line.children[t-1]);t--);}function h(t,e=-1){if(0!=t.children.length)for(let r=0,n=0;r<=t.children.length;r++){let s=r==t.children.length?null:t.children[r];s&&s instanceof Jt||n==e||0!=r&&t.children[r-1]instanceof Jt||(t.dom.insertBefore(document.createTextNode("​"),s?s.dom:null),i.indexOf(t)<0&&i.push(t)),s&&(n+=s.length)}}return this.index>0&&h(this.line.parent.children[this.index-1]),h(this.line,e-this.start),this.index<this.line.parent.children.length-1&&h(this.line.parent.children[this.index+1]),{lines:i,atWidget:r}}undoQueryPreparation(t,e){for(let t of e.lines)t.dirty=2,t.sync(),t.dirty=0}}function di(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function pi(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function gi(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function mi(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Oi(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function vi(t,e,i){let r=t.nodeValue.length,n=document.createRange();for(let s=0;s<r;s++){n.setEnd(t,s+1),n.setStart(t,s);let r=n.getClientRects();for(let o=0;o<r.length;o++){let h=r[o];if(h.top!=h.bottom&&(h.left-1<=e&&h.right+1>=e&&h.top-1<=i&&h.bottom+1>=i)){let i=e>=(h.left+h.right)/2,r=i;if(Et.chrome||Et.gecko){n.setEnd(t,s),n.getBoundingClientRect().left==h.right&&(r=!i)}return{node:t,offset:s+(r?1:0)}}}}return{node:t,offset:0}}function yi(t,{x:e,y:i},r=-1){let n,s=t.contentDOM.getBoundingClientRect(),o=t.defaultLineHeight/2;for(let e=!1;;){if(n=t.blockAtHeight(i,s.top),n.top>i||n.bottom<i){if(r=n.top>i?-1:1,i=Math.min(n.bottom-o,Math.max(n.top+o,i)),e)return-1;e=!0}if(n.type==ne.Text)break;i=r>0?n.bottom+o:n.top-o}let h=n.from;if(h<t._viewport.from)return 0==t._viewport.from?0:-1;if(h>t._viewport.to)return t._viewport.to==t.state.doc.length?t.state.doc.length:-1;e=Math.max(s.left+1,Math.min(s.right-1,e));let a,l=t.root,c=l.elementFromPoint(e,i),u=-1;if(c&&t.contentDOM.contains(c)&&!(t.docView.nearest(c)instanceof ee))if(l.caretPositionFromPoint){let t=l.caretPositionFromPoint(e,i);t&&({offsetNode:a,offset:u}=t)}else if(l.caretRangeFromPoint){let t=l.caretRangeFromPoint(e,i);t&&({startContainer:a,startOffset:u}=t)}if(!a){let{line:r}=fi.get(t,h);({node:a,offset:u}=function t(e,i,r){let n,s,o,h,a,l,c,u;for(let f=e.firstChild;f;f=f.nextSibling){let e=zt(f);for(let d=0;d<e.length;d++){let p=e[d];s&&gi(s,p)&&(p=mi(Oi(p,s.bottom),s.top));let g=di(i,p),m=pi(r,p);if(0==g&&0==m)return 3==f.nodeType?vi(f,i,r):t(f,i,r);(!n||h>m||h==m&&o>g)&&(n=f,s=p,o=g,h=m),0==g?r>p.bottom&&(!c||c.bottom<p.bottom)?(a=f,c=p):r<p.top&&(!u||u.top>p.top)&&(l=f,u=p):c&&gi(c,p)?c=Oi(c,p.bottom):u&&gi(u,p)&&(u=mi(u,p.top))}}if(c&&c.bottom>=r?(n=a,s=c):u&&u.top<=r&&(n=l,s=u),!n)return{node:e,offset:0};let f=Math.max(s.left,Math.min(s.right,i));return 3==n.nodeType?vi(n,f,r):(o||"true"!=n.contentEditable||t(n,f,r),{node:e,offset:Array.prototype.indexOf.call(e.childNodes,n)+(i>=(s.left+s.right)/2?1:0)})}(r.dom,e,i))}return t.docView.posFromDOM(a,u)}class bi{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.registeredEvents=[],this.customHandlers=[],this.composing=!1,this.goalColumns=[],this.mouseSelection=null;for(let e in xi){let i=xi[e];t.contentDOM.addEventListener(e,r=>{Si(t,r)&&(this.runCustomHandlers(e,t,r)?r.preventDefault():i(t,r))}),this.registeredEvents.push(e)}t.contentDOM.addEventListener("keydown",e=>{t.inputState.lastKeyCode=e.keyCode,t.inputState.lastKeyTime=Date.now()}),t.root.activeElement==t.contentDOM&&t.dom.classList.add("codemirror-focused"),this.ensureHandlers(t)}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t){let e=t.behavior(Le);if(!(e==this.customHandlers||e.length==this.customHandlers.length&&e.every((t,e)=>t==this.customHandlers[e]))){this.customHandlers=e;for(let i of e)for(let e in i)this.registeredEvents.indexOf(e)<0&&(this.registeredEvents.push(e),t.contentDOM.addEventListener(e,i=>{Si(t,i)&&this.runCustomHandlers(e,t,i)&&i.preventDefault()}))}}runCustomHandlers(t,e,i){for(let r of this.customHandlers){let n=r[t];if(n)try{if(n(e,i)||i.defaultPrevented)return!0}catch(t){console.error(t)}}return!1}startMouseSelection(t,e,i){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=new wi(this,t,e,i)}update(t){this.mouseSelection&&this.mouseSelection.map(t.changes),this.lastKeyCode=this.lastSelectionTime=0}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}class wi{constructor(t,e,i,r){this.inputState=t,this.view=e,this.update=r;let n=e.contentDOM.ownerDocument;n.addEventListener("mousemove",this.move=this.move.bind(this)),n.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=e.state.behavior(nt.allowMultipleSelections)&&function(t,e){let i=t.behavior(Ie);return i.length?i[0](e):Et.mac?e.metaKey:e.ctrlKey}(e,i),this.dragMove=function(t,e){let i=t.behavior(je);return i.length?i[0](e):Et.mac?!e.altKey:!e.ctrlKey}(e,i),this.startSelection=e.state.selection;let{pos:s,bias:o}=this.queryPos(i);this.startPos=this.curPos=s,this.startBias=this.curBias=o,this.dragging=!!function(t,e,i){let{primary:r}=t.state.selection;if(r.empty)return!1;if(e<r.from||e>r.to)return!1;if(e>r.from&&e<r.to)return!0;let n=t.root.getSelection();if(0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let e=s[t];if(e.left<=i.clientX&&e.right>=i.clientX&&e.top<=i.clientY&&e.bottom>=i.clientY)return!0}return!1}(e,this.startPos,i)&&null,!1===this.dragging&&(i.preventDefault(),this.select())}queryPos(t){let e=this.view.posAtCoords({x:t.clientX,y:t.clientY}),i=this.view.coordsAtPos(e);return{pos:e,bias:i?i.top>t.clientY?-1:i.bottom<t.clientY?1:i.left>t.clientX?-1:1:1}}move(t){if(0==t.buttons)return this.destroy();if(!1!==this.dragging)return;let{pos:e,bias:i}=this.queryPos(t);e==this.curPos&&i==this.curBias||(this.curPos=e,this.curBias=i,this.select())}up(t){null==this.dragging&&this.select(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.inputState.mouseSelection=null}select(){let t=this.update(this.view,this.startSelection,this.startPos,this.startBias,this.curPos,this.curBias,this.extend,this.multiple);t.eq(this.view.state.selection)||this.view.dispatch(this.view.state.t().setSelection(t).annotate(et.userEvent("pointer")))}map(t){t.length&&(this.startSelection=this.startSelection.map(t),this.startPos=t.mapPos(this.startPos),this.curPos=t.mapPos(this.curPos)),this.dragging&&(this.dragging=this.dragging.map(t))}}function Si(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i=e.target;i!=t.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||i.cmView&&i.cmView.ignoreEvent(e))return!1;return!0}const xi=Object.create(null),ki=Et.ie&&Et.ie_version<15||Et.ios&&Et.webkit_version<604;function Pi(t,e){t.dispatch(t.state.t().replaceSelection(e).annotate(et.userEvent("paste")).scrollIntoView())}function Ai(t,e,i,r){if(1==r)return new U(e);if(2==r)return U.groupAt(t.state,e,i);{let i=fi.get(t,e);if(i)return new U(i.start+i.line.length,i.start);let{start:r,end:n}=t.state.doc.lineAt(e);return new U(r,n)}}xi.keydown=(t,e)=>{(function(t){let e=(t.ctrlKey?1:0)|(t.metaKey?8:0)|(t.altKey?2:0)|(t.shiftKey?4:0),i=t.keyCode,r=Et.mac&&1==e;return 8==i||r&&72==i||46==i||r&&68==i||27==i||e==(Et.mac?8:1)&&(66==i||73==i||89==i||90==i)})(e)&&e.preventDefault(),t.inputState.setSelectionOrigin("keyboard")},xi.touchdown=xi.touchmove=(t,e)=>{t.inputState.setSelectionOrigin("pointer")},xi.mousedown=(t,e)=>{var i;0==e.button&&t.startMouseSelection(e,(i=e.detail,(t,e,r,n,s,o,h,a)=>{let l=Ai(t,s,o,i);if(r!=s&&!h){let e=Ai(t,r,n,i);l=l.extend(Math.min(e.from,l.from),Math.max(e.to,l.to))}return h?e.replaceRange(e.primary.extend(l.from,l.to)):a?e.addRange(l):V.create([l])}))},xi.dragstart=(t,e)=>{let{doc:i,selection:{primary:r}}=t.state,{mouseSelection:n}=t.inputState;n&&(n.dragging=r),e.dataTransfer&&(e.dataTransfer.setData("Text",i.slice(r.from,r.to)),e.dataTransfer.effectAllowed="copyMove")},xi.drop=(t,e)=>{if(!e.dataTransfer)return;let i=t.posAtCoords({x:e.clientX,y:e.clientY}),r=e.dataTransfer.getData("Text");if(i<0||!r)return;e.preventDefault();let n=t.state.t(),{mouseSelection:s}=t.inputState;s&&s.dragging&&s.dragMove&&(n.replace(s.dragging.from,s.dragging.to,""),i=n.changes.mapPos(i));let o=new Y(i,i,t.state.splitLines(r));n.change(o).setSelection(V.single(i,i+o.length)).annotate(et.userEvent("drop")),t.focus(),t.dispatch(n)},xi.paste=(t,e)=>{t.docView.observer.flush();let i=ki?null:e.clipboardData,r=i&&i.getData("text/plain");r?(Pi(t,r),e.preventDefault()):function(t){let e=t.dom.ownerDocument,i=e.body.appendChild(e.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{t.focus(),e.body.removeChild(i),Pi(t,i.value)},50)}(t)},xi.copy=xi.cut=(t,e)=>{let i=t.state.selection.primary;if(i.empty)return;let r=ki?null:e.clipboardData,n=t.state.joinLines(t.state.doc.sliceLines(i.from,i.to));r?(e.preventDefault(),r.clearData(),r.setData("text/plain",n)):function(t,e){let i=t.dom.ownerDocument,r=i.body.appendChild(i.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{i.body.removeChild(r),t.focus()},50)}(t,n),"cut"==e.type&&t.dispatch(t.state.t().replaceSelection([""]).scrollIntoView().annotate(et.userEvent("cut")))},xi.focus=t=>{t.update([],[ti(!0)])},xi.blur=t=>{t.update([],[ti(!1)])},xi.beforeprint=t=>{t.docView.checkLayout(!0)};const Ti=F.define();function Qi(t){t.docView.compositionDeco.size&&t.update([],[Ti(null)])}xi.compositionstart=xi.compositionupdate=t=>{t.inputState.composing||(t.docView.compositionDeco.size&&(t.docView.observer.flush(),Qi(t)),t.inputState.composing=!0)},xi.compositionend=t=>{t.inputState.composing=!1,setTimeout(()=>{t.inputState.composing||Qi(t)},50)};function Ci(t,e,i,r){let n,s,o,h=t.state.selection.primary;if(e>-1&&(o=t.docView.domBoundsAround(e,i,0))){let{from:e,to:i}=o,r=t.docView.impreciseHead||t.docView.impreciseAnchor?[]:function(t,e){let i=[];if(e.activeElement!=t)return i;let{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:o}=e.getSelection();r&&(i.push(new Ni(r,n)),s==r&&o==n||i.push(new Ni(s,o)));return i}(t.contentDOM,t.root),a=new Mi(r);a.readRange(o.startDOM,o.endDOM),s=function(t,e){if(0==t.length)return null;let i=t[0].pos,r=2==t.length?t[1].pos:i;return i>-1&&r>-1?V.single(i+e,r+e):null}(r,e);let l=h.from,c=null;8===t.inputState.lastKeyCode&&t.inputState.lastKeyTime>Date.now()-100&&(l=h.to,c="end");let u=function(t,e,i,r){let n=Math.min(t.length,e.length),s=0;for(;s<n&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==n&&t.length==e.length)return null;let o=t.length,h=e.length;for(;o>0&&h>0&&t.charCodeAt(o-1)==e.charCodeAt(h-1);)o--,h--;if("end"==r){let t=Math.max(0,s-Math.min(o,h));i-=o+t-s}if(o<s&&t.length<e.length){s-=i<=s&&i>=o?s-i:0,h=s+(h-o),o=s}else if(h<s){s-=i<=s&&i>=h?s-i:0,o=s+(o-h),h=s}return{from:s,toA:o,toB:h}}(t.state.doc.slice(e,i,"﷚"),a.text,l-e,c);u&&(n=new Y(e+u.from,e+u.toA,a.text.slice(u.from,u.toB).split("﷚")))}else if(t.hasFocus){let e=t.root.getSelection(),{impreciseHead:i,impreciseAnchor:r}=t.docView,n=i&&i.node==e.focusNode&&i.offset==e.focusOffset?t.state.selection.primary.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),o=r&&r.node==e.anchorNode&&r.offset==e.anchorOffset?t.state.selection.primary.anchor:function(t){let e=t.isCollapsed;return e&&Et.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e}(e)?n:t.docView.posFromDOM(e.anchorNode,e.anchorOffset);n==h.head&&o==h.anchor||(s=V.single(o,n))}if(!n&&!s)return!1;if(!n&&r&&!h.empty&&s&&s.primary.empty&&(n=new Y(h.from,h.to,t.state.doc.sliceLines(h.from,h.to))),n){let e=t.state;if(Et.android&&(n.from==h.from&&n.to==h.to&&1==n.length&&2==n.text.length&&Ri(t,"Enter",10)||n.from==h.from-1&&n.to==h.to&&0==n.length&&Ri(t,"Backspace",8)||n.from==h.from&&n.to==h.to+1&&0==n.length&&Ri(t,"Delete",46)))return t.state!=e;let i=e.t();if(n.from>=h.from&&n.to<=h.to&&n.to-n.from>=(h.to-h.from)/3){let t=h.from<n.from?e.doc.slice(h.from,n.from,"﷚"):"",r=h.to>n.to?e.doc.slice(n.to,h.to,"﷚"):"";i.replaceSelection((t+n.text.join("﷚")+r).split("﷚"))}else i.change(n),s&&!i.selection.primary.eq(s.primary)&&i.setSelection(i.selection.replaceRange(s.primary));return t.dispatch(i.scrollIntoView()),!0}if(s&&!s.primary.eq(h)){let e=t.state.t().setSelection(s);return t.inputState.lastSelectionTime>Date.now()-50&&("keyboard"==t.inputState.lastSelectionOrigin?e.scrollIntoView():e.annotate(et.userEvent(t.inputState.lastSelectionOrigin))),t.dispatch(e),!0}return!1}class Mi{constructor(t){this.points=t,this.text=""}readRange(t,e){if(!t)return;let i=t.parentNode;for(let r=t;;){this.findPointBefore(i,r),this.readNode(r);let t=r.nextSibling;if(t==e)break;let n=r.cmView,s=t.cmView;((n?n.breakAfter:Di(r))||(s?s.breakAfter:Di(t))&&("BR"!=r.nodeName||r.cmIgnore))&&(this.text+="﷚"),r=t}this.findPointBefore(i,e)}readNode(t){if(t.cmIgnore)return;let e,i=t.cmView,r=i&&i.overrideDOMText;null!=r?e=r.join("﷚"):3==t.nodeType?e=t.nodeValue:"BR"==t.nodeName?e=t.nextSibling?"﷚":"":1==t.nodeType&&this.readRange(t.firstChild,null),null!=e&&(this.findPointIn(t,e.length),this.text+=e)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointIn(t,e){for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e))}}function Di(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class Ni{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}function Ri(t,e,i){let r={key:e,code:e,keyCode:i,which:i,cancelable:!0},n=new KeyboardEvent("keydown",r);t.contentDOM.dispatchEvent(n);let s=new KeyboardEvent("keyup",r);return t.contentDOM.dispatchEvent(s),n.defaultPrevented||s.defaultPrevented}class Ei{constructor(t={}){this.plugins=Object.create(null),this.editorAttrs={},this.contentAttrs={},this.themeCache=Object.create(null),this.themeCacheFor=[],this.updateState=2,this.waiting=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.appendChild(this.contentDOM),this.dom=document.createElement("div"),this.dom.appendChild(this.scrollDOM),this.dispatch=t.dispatch||(t=>this.update([t])),this.root=t.root||document,this.docView=new ni(this,(t,e,i)=>Ci(this,t,e,i));let e=t.state||nt.create();this.extensions=t.extensions||[],this.configure(e.configuration.foreign),this.inputState=new bi(this),this.docView.init(e,t=>{this._viewport=t,this._state=e;for(let t of this.behavior(Xe)){let e=this.plugins[t.id];if(e)throw new Error("Duplicated view plugin"+((e.constructor||Object)!=Object&&e.constructor.name?` (${e.constructor.name})`:""));this.plugins[t.id]=t.create(this)}}),this.mountStyles(),this.updateAttrs(),this.updateState=0,window.addEventListener("resize",()=>{-1==Wi&&(Wi=setTimeout(Bi,50))})}get state(){return this._state}get viewport(){return this._viewport}update(t=[],e=[]){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");this.updateState=2,this.clearWaiting();let i=this.state,r=i.configuration.foreign;for(let e of t){if(e.startState!=i)throw new RangeError("Trying to update state with a transaction that doesn't start from the current state.");i=e.apply()}let n=i.configuration.foreign;n!=r&&(this.configure(n),this.updatePlugins());let s=t.length>0||e.length>0?new ii(this,t,e):null;(i.doc!=this.state.doc||t.some(t=>t.selectionSet&&!t.annotation(et.preserveGoalColumn)))&&(this.inputState.goalColumns.length=0),this.docView.update(s,t.some(t=>t.scrolledIntoView)?i.selection.primary.head:-1),s&&(this.inputState.ensureHandlers(this),this.drawPlugins(),this.behavior(Ze)!=this.styleModules&&this.mountStyles()),this.updateAttrs(),this.updateState=0}waitFor(t){t.then(()=>{t.canceled||this.update([],[ei(!0)])}),this.waiting.push(t)}clearWaiting(){for(let t of this.waiting)t.canceled=!0;this.waiting.length=0}updateAttrs(){let t=this.behavior(He),e=this.behavior(Fe);Zt(this.dom,this.editorAttrs,t),this.editorAttrs=t,Zt(this.contentDOM,this.contentAttrs,e),this.contentAttrs=e,this.scrollDOM.className=this.cssClass("scroller")+" "+ge.scroller}configure(t){if(this.configuration=Ve.resolve([zi].concat(this.extensions).concat(t)),this.configuration.foreign.length)throw new Error("Non-view extensions found in view")}updatePlugins(){let t=this.plugins;this.plugins=Object.create(null);for(let e of this.behavior(Xe))this.plugins[e.id]=Object.prototype.hasOwnProperty.call(t,e.id)?t[e.id]:e.create(this)}mountStyles(){this.styleModules=this.behavior(Ze),st.a.mount(this.root,this.styleModules.concat(ge).reverse())}drawPlugins(){for(let t of this.behavior(Xe)){let e=this.plugins[t.id];if(e.draw)try{e.draw()}catch(t){console.error(t)}}this.updateAttrs()}plugin(t){let e=this.plugins[t.id];if(void 0===e&&this.behavior(Xe).indexOf(t)>-1)throw new Error("Accessing a plugin from another plugin with higher precedence");return e}behavior(t){return this.configuration.getBehavior(t,this)}updateInner(t,e){this._viewport=e,this._state=t.state;let i=this.plugins;this.plugins=Object.create(null);for(let e of this.behavior(Xe)){let r=this.plugins[e.id]=i[e.id];if(r.update)try{r.update(t)}catch(t){console.error(t),this.plugins[e.id]={update(){}}}}}cssClass(t){let e=this.behavior(Ye);if(e!=this.themeCacheFor)this.themeCache=Object.create(null),this.themeCacheFor=e;else{let e=this.themeCache[t];if(null!=e)return e}let i="";for(let r=0;;){let n=t.indexOf(".",r),s=n<0?t:t.slice(0,n);i+=(i?" ":"")+"codemirror-"+(r?s.replace(/\./g,"-"):s);for(let t of e){let e=t[s];e&&(i+=" "+e)}if(n<0)break;r=n+1}return this.themeCache[t]=i}phrase(t){for(let e of this.behavior(Ke))if(Object.prototype.hasOwnProperty.call(e,t))return e[t];return t}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}readingLayout(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.docView.layoutCheckScheduled>-1&&this.docView.checkLayout()}requireMeasure(){this.docView.scheduleLayoutCheck()}blockAtHeight(t,e){return this.readingLayout(),this.docView.blockAtHeight(t,e)}lineAtHeight(t,e){return this.readingLayout(),this.docView.lineAtHeight(t,e)}lineAt(t,e){return this.readingLayout(),this.docView.lineAt(t,e)}viewportLines(t,e){let{from:i,to:r}=this._viewport;this.docView.forEachLine(i,r,t,e)}get contentHeight(){return this.docView.heightMap.height+this.docView.paddingTop+this.docView.paddingBottom}movePos(t,e,i="character",r="move"){return ui(this,t,e,i,r)}posAtCoords(t){return this.readingLayout(),yi(this,t)}coordsAtPos(t){return this.readingLayout(),this.docView.coordsAt(t)}get defaultCharacterWidth(){return this.docView.heightOracle.charWidth}get defaultLineHeight(){return this.docView.heightOracle.lineHeight}startMouseSelection(t,e){this.focus(),this.inputState.startMouseSelection(this,t,e)}get hasFocus(){return this.root.activeElement==this.contentDOM}focus(){this.docView.focus()}destroy(){for(let t of this.behavior(Xe)){let e=this.plugins[t.id];if(e.destroy)try{e.destroy()}catch(t){console.error(t)}}this.inputState.destroy(),this.dom.remove(),this.docView.destroy()}static theme(t){for(let e in t){let i=e.split(".").length-1;i>0&&(t[e].specificity=i)}let e=new st.a(t);return[Ye(e),Ze(e)]}}Ei.extend=Ve,Ei.styleModule=Ze,Ei.handleDOMEvents=Le,Ei.dragMovesSelection=je,Ei.clickAddsSelectionRange=Ie,Ei.decorations=qe,Ei.phrases=Ke,Ei.scrollMargins=Je,Ei.contentAttributes=Fe,Ei.editorAttributes=He,Ei.focusChange=ti;const zi=[Ve.dynamic(He,t=>({class:"codemirror "+ge.wrapper+(t.hasFocus?" codemirror-focused ":" ")+t.cssClass("wrap")})),Ve.dynamic(Fe,t=>({spellcheck:"false",contenteditable:"true",class:ge.content+" "+t.cssClass("content"),style:`${Et.tabSize}: ${t.state.tabSize}`}))];let Wi=-1;function Bi(){Wi=-1;let t=document.querySelectorAll(".codemirror-content");for(let e=0;e<t.length;e++){let i=t[e].cmView;i&&i.editorView.update([],[ei(!0)])}}class $i extends ot{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}map(t,e){return(e=t.mapPos(e,-1,G.TrackBefore))<0?null:new ht(e,e,this)}toDOM(t){return null}at(t){return new ht(t,t,this)}}$i.prototype.elementClass="";const Ui={style:"",renderEmptyElements:!1,elementStyle:"",initialMarkers:()=>ct.empty,updateMarkers:t=>t,lineMarker:()=>null,initialSpacer:null,updateSpacer:null,handleDOMEvents:{}},Vi=Ei.extend.behavior();class Li{constructor(t){this.config=B(t,Ui)}get extension(){return[_i(),Vi(this)]}}const Ii=Ei.extend.behavior();let ji=_e.create(t=>new Hi(t)).behavior(Ei.scrollMargins,t=>t.scrollMargins());function _i(t){let e=[ji.extension,er];return t&&!1===t.fixed&&e.push(Ii(!0)),e}class Hi{constructor(t){this.view=t,this.dom=document.createElement("div"),this.dom.setAttribute("aria-hidden","true"),this.gutters=t.behavior(Vi).map(e=>new Xi(t,e.config));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.behavior(Ii),this.fixed&&(this.dom.style.position="sticky"),t.scrollDOM.insertBefore(this.dom,t.contentDOM),this.updateTheme()}updateTheme(){this.dom.className=this.view.cssClass("gutters");for(let t of this.gutters)t.updateTheme()}update(t){t.themeChanged&&this.updateTheme();for(let e of this.gutters)e.update(t)}draw(){let t=this.gutters.map(t=>new Fi(t,this.view.viewport));this.view.viewportLines(e=>{let i;if(i=Array.isArray(e.type)?e.type.find(t=>t.type==ne.Text):e.type==ne.Text?e:void 0,i)for(let e of t)e.line(this.view,i)},0);for(let e of t)e.finish(this.view);this.dom.style.minHeight=this.view.contentHeight+"px"}scrollMargins(){return 0!=this.gutters.length&&this.fixed?"ltr"==getComputedStyle(this.view.scrollDOM).direction?{left:this.dom.offsetWidth}:{right:this.dom.offsetWidth}:{}}}class Fi{constructor(t,e){this.gutter=t,this.localMarkers=[],this.i=0,this.height=0,this.next=t.markers.iter(e.from,e.to).next,this.nextMarker=this.next()}line(t,e){for(this.localMarkers.length&&(this.localMarkers=[]);this.nextMarker&&this.nextMarker.from<=e.from;)this.nextMarker.from==e.from&&this.localMarkers.push(this.nextMarker.value),this.nextMarker=this.next();let i=this.gutter.config.lineMarker(t,e,this.localMarkers);i&&this.localMarkers.unshift(i);let r=this.gutter;if(0==this.localMarkers.length&&!r.config.renderEmptyElements)return;let n=e.top-this.height;if(this.i==r.elements.length){let i=new qi(t,e.height,n,this.localMarkers,r.elementClass);r.elements.push(i),r.dom.appendChild(i.dom)}else{let i=this.localMarkers,s=r.elements[this.i];(function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0})(i,s.markers)&&(i=s.markers,this.localMarkers.length=0),s.update(t,e.height,n,i,r.elementClass)}this.height=e.bottom,this.i++}finish(t){let e=this.gutter;for(;e.elements.length>this.i;)e.dom.removeChild(e.elements.pop().dom)}}class Xi{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div");for(let i in e.handleDOMEvents)this.dom.addEventListener(i,r=>{let n=t.lineAtHeight(r.clientY);e.handleDOMEvents[i](t,n,r)&&r.preventDefault()});this.markers=e.initialMarkers(t),e.initialSpacer&&(this.spacer=new qi(t,0,0,[e.initialSpacer(t)],this.elementClass),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none"),this.updateTheme()}updateTheme(){for(this.dom.className=this.view.cssClass("gutter"+(this.config.style?"."+this.config.style:"")),this.elementClass=this.view.cssClass("gutterElement"+(this.config.style?"."+this.config.style:""));this.elements.length;)this.dom.removeChild(this.elements.pop().dom)}update(t){if(t.themeChanged&&this.updateTheme(),this.markers=this.config.updateMarkers(this.markers.map(t.changes),t),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e],this.elementClass)}}destroy(){this.dom.remove()}}class qi{constructor(t,e,i,r,n){this.height=-1,this.above=0,this.dom=document.createElement("div"),this.update(t,e,i,r,n)}update(t,e,i,r,n){if(this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),this.markers!=r){this.markers=r;for(let t;t=this.dom.lastChild;)t.remove();let e=n;for(let i of r){let r=i.toDOM(t);r&&this.dom.appendChild(r);let n=i.elementClass;n&&(e+=" "+n)}this.dom.className=e}}}const Gi=F.define(),Zi=Ei.extend.behavior({combine:t=>W(t,{formatNumber:String,handleDOMEvents:{}},{handleDOMEvents(t,e){let i={};for(let e in t)i[e]=t[e];for(let t in e){let r=i[t],n=e[t];i[t]=r?(t,e,i)=>r(t,e,i)||n(t,e,i):n}return i}})});class Yi extends $i{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(t){let e=t.behavior(Zi);return document.createTextNode(e.formatNumber(this.number))}}const Ki=new Li({style:"lineNumber",updateMarkers(t,e){let i=e.annotation(Gi);return i&&(t=t.update(i.add||[],i.filter||null)),t},lineMarker:(t,e,i)=>i.length?null:new Yi(t.state.doc.lineAt(e.from).number),initialSpacer:t=>new Yi(tr(t.state.doc.lines)),updateSpacer(t,e){let i=tr(e.view.state.doc.lines);return i==t.number?t:new Yi(i)}});function Ji(t={}){return[Zi(t),Ki.extension]}function tr(t){let e=9;for(;e<t;)e=10*e+9;return e}const er=Ei.theme({gutters:{background:"#f5f5f5",borderRight:"1px solid silver",color:"#999",display:"flex",height:"100%",boxSizing:"border-box",left:0},gutter:{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",height:"100%",overflow:"hidden"},gutterElement:{boxSizing:"border-box"},"gutterElement.lineNumber":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"}}),ir=/[\u0000-\u0008\u000a-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/gu,rr={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},nr=Ei.extend.behavior({combine(t){let e=W(t,{render:null,specialChars:ir,addSpecialChars:null}),i=document.body.style;return e.replaceTabs=null==(i.tabSize||i.MozTabSize),e.replaceTabs&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,"gu")),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,"gu")),e}}),sr=_e.create(t=>new hr(t)).decorations(t=>t.decorations);function or(t={}){return[nr(t),sr.extension,ur]}class hr{constructor(t){this.view=t,this.from=0,this.to=0,this.decorations=se.none,this.updateForViewport()}update(t){t.changes.length&&(this.decorations=this.decorations.map(t.changes),this.from=t.changes.mapPos(this.from,1),this.to=t.changes.mapPos(this.to,-1),this.closeHoles(t.changes.changedRanges())),this.updateForViewport()}closeHoles(t){let e=[],i=this.view.viewport,r=[],n=this.view.behavior(nr);for(let s=0;s<t.length;s++){let{fromB:o,toB:h}=t[s];for(n.replaceTabs&&(h=this.view.state.doc.lineAt(h).end);s<t.length-1&&t[s+1].fromB<h+10;)h=Math.max(h,t[++s].toB);o=Math.max(i.from,o),h=Math.min(i.to,h),o>=h||(this.getDecorationsFor(o,h,e),r.push(o,h))}e.length&&(this.decorations=this.decorations.update(e,t=>{for(let e=0;e<r.length;e+=2)if(t>=r[e]&&t<r[e+1])return!1;return!0},r[0],r[r.length-1]))}updateForViewport(){let t=this.view.viewport;if(this.from==t.from&&this.to==t.to)return;let e=[];this.from>=t.to||this.to<=t.from?(this.getDecorationsFor(t.from,t.to,e),this.decorations=se.set(e)):(t.from<this.from&&this.getDecorationsFor(t.from,this.from,e),this.to<t.to&&this.getDecorationsFor(this.to,t.to,e),this.decorations=this.decorations.update(e,(e,i)=>e>=t.from&&i<=t.to)),this.from=t.from,this.to=t.to}getDecorationsFor(t,e,i){let r=this.view.behavior(nr),{doc:n}=this.view.state;for(let s,o=t,h=n.iterRange(t,e);!h.next().done;){if(!h.lineBreak)for(;s=r.specialChars.exec(h.value);){let t,e=s[0].codePointAt?s[0].codePointAt(0):s[0].charCodeAt(0);if(null!=e){if(9==e){let e=n.lineAt(o+s.index),i=this.view.state.tabSize,r=p(n.slice(e.start,o+s.index),0,i);t=new lr((i-r%i)*this.view.defaultCharacterWidth)}else t=new ar(r,e);i.push(se.replace(o+s.index,o+s.index+s[0].length,{widget:t}))}}o+=h.value.length}}}class ar extends re{constructor(t,e){super(e),this.options=t}toDOM(){let t=((e=this.value)>=32?null:10==e?"␤":String.fromCharCode(9216+e))||"•";var e;let i="Control character "+(rr[this.value]||this.value),r=this.options.render&&this.options.render(this.value,i,t);if(r)return r;let n=document.createElement("span");return n.textContent=t,n.title=i,n.setAttribute("aria-label",i),n.style.color="red",n}ignoreEvent(){return!1}}class lr extends re{toDOM(){let t=document.createElement("span");return t.textContent="\t",t.className=cr.tab,t.style.width=this.value+"px",t}ignoreEvent(){return!1}}const cr=new st.a({tab:{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"}}),ur=Ei.styleModule(cr);class fr{constructor(t,e=null,i=null){this.map=t,this.inverted=e,this.selection=i}get isChange(){return null!=this.inverted}}function dr(t,e,i,r){let n=e+1>i+20?e-i-1:0,s=t.slice(n,e);return s.push(r),s}function pr(t,e,i,r,n,s){if(t.length){const r=t[t.length-1];if(r.selection&&r.isChange==Boolean(i)&&s(r))return i?dr(t,t.length-1,n,new fr(r.map.appendSet(e.desc),i.appendSet(r.inverted),r.selection)):t}return dr(t,t.length,n,new fr(e.desc,i,r))}function gr(){return!1}class mr{constructor(t,e,i=null,r){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=r}resetTime(){return new mr(this.done,this.undone)}addChanges(t,e,i,r,n,s,o){let h=gr;return null!==this.prevTime&&r-this.prevTime<s&&(e||this.prevUserEvent==n&&"keyboard"==n)&&(h=e?e=>function(t,e){return!!t&&e.from<=t.mapPos(t.to,1)&&e.to>=t.mapPos(t.from)}(e.map.changes[e.map.length-1],t.changes[0]):t=>{return e=t.selection,r=i,e.ranges.length==r.ranges.length&&0===e.ranges.filter((t,e)=>t.empty!=r.ranges[e].empty).length;var e,r}),new mr(pr(this.done,t,e,i,o,h),this.undone,r,n)}addMapping(t,e){return 0==this.done.length?this:new mr(dr(this.done,this.done.length,e,new fr(t)),this.undone)}canPop(t,e){const i=0==t?this.done:this.undone;for(const{isChange:t,selection:r}of i)if(t||1==e&&r)return!0;return!1}pop(t,e,i,r){let{changes:n,branch:s,selection:o}=function(t,e){let i=null,r=t.length-1;for(;;r--){if(r<0)throw new RangeError("popChanges called on empty branch");let n=t[r];if(n.isChange||1==e&&n.selection)break;i=i?n.map.appendSet(i):n.map}let n=t[r],s=t.slice(0,r),o=n.inverted||K.empty,h=n.selection;if(i){let t=n.map.length;i=n.map.appendSet(i);let e=[];for(let r=0;r<o.length;r++){let n=o.changes[r].map(i.partialMapping(t-r));n&&(i=i.append(n.desc),e.push(n))}s.push(new fr(i)),o=new K(e),h=h.map(i)}return{changes:o,branch:s,selection:h}}(0==t?this.done:this.undone,e),h=i.selection;for(let t of n.changes)i.change(t);i.setSelection(o);let a=0==t?this.undone:this.done;return a=pr(a,i.changes,i.changes.length>0?i.invertedChanges():null,h,r,gr),{transaction:i,state:new mr(0==t?s:a,0==t?a:s)}}eventCount(t,e){let i=0,r=0==t?this.done:this.undone;for(const{isChange:t,selection:n}of r)(t||1==e&&n)&&++i;return i}}mr.empty=new mr([],[]);const Or=F.define(),vr=F.define(),yr=new H({init:t=>mr.empty,apply(t,e,i){const r=t.annotation(Or);if(r)return r;if(t.annotation(vr)&&(e=e.resetTime()),!t.changes.length&&!t.selectionSet)return e;let n=i.behavior(br);return!1!==t.annotation(et.addToHistory)?e.addChanges(t.changes,t.changes.length?t.invertedChanges():null,t.startState.selection,t.annotation(et.time),t.annotation(et.userEvent),n.newGroupDelay,n.minDepth):e.addMapping(t.changes.desc,n.minDepth)}}),br=nt.extend.behavior({combine:t=>W(t,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})});function wr(t={}){return[yr.extension,br(t)]}function Sr(t,e){return function({state:i,dispatch:r}){let n=i.behavior(br),s=i.field(yr,!1);if(!s||!s.canPop(t,e))return!1;const{transaction:o,state:h}=s.pop(t,e,i.t(),n.minDepth);return r(o.annotate(Or(h))),!0}}const xr=Sr(0,0),kr=Sr(1,0),Pr=Sr(0,1),Ar=Sr(1,1);function Tr(t,e){return function(i){let r=i.field(yr,!1);return r?r.eventCount(t,e):0}}Tr(0,0),Tr(1,0),Tr(0,1),Tr(1,1);const Qr=F.define();function Cr(t){let e=[];for(let{head:i}of t.state.selection.ranges)e.some(t=>t.from<=i&&t.to>=i)||e.push(t.lineAt(i));return e}const Mr=t=>{if(!t.plugin(Er))return!1;let e=[];for(let i of Cr(t)){let r=t.state.behavior(nt.foldable).reduce((e,r)=>e||r(t.state,i.from,i.to),null);r&&e.push(r)}return!!e.length&&(t.dispatch(t.state.t().annotate(Qr({fold:e}))),!0)},Dr=t=>{let e=[],i=t.plugin(Er);if(!i)return!1;for(let r of Cr(t)){let t=i.foldInside(r.from,r.to);t&&e.push(t)}return!!e.length&&(t.dispatch(t.state.t().annotate(Qr({unfold:e}))),!0)},Nr={placeholderDOM:null,placeholderText:"…"},Rr=Ei.extend.behavior({combine:t=>W(t,Nr)}),Er=_e.create(t=>new Wr(t)).decorations(t=>t.decorations);function zr(t={}){return[Rr(t),Er.extension,Ei.extend.fallback(Lr)]}class Wr{constructor(t){this.view=t,this.decorations=se.none;let e=t.behavior(Rr);this.widgetConfig={config:e,class:this.placeholderClass}}get placeholderClass(){return this.view.cssClass("foldPlaceholder")}update(t){this.decorations=this.decorations.map(t.changes);for(let e of t.transactions){let t=e.annotation(Qr);t&&this.updateRanges(t.fold||[],t.unfold||[])}if(t.themeChanged&&this.placeholderClass!=this.widgetConfig.class){this.widgetConfig={config:this.widgetConfig.config,class:this.placeholderClass};let t,e=[],i=this.decorations.iter();for(;t=i.next();)e.push(se.replace(t.from,t.to,{widget:new Br(this.widgetConfig)}));this.decorations=se.set(e)}}updateRanges(t,e){this.decorations=this.decorations.update(t.map(({from:t,to:e})=>se.replace(t,e,{widget:new Br(this.widgetConfig)})),e.length?(t,i)=>!e.some(e=>e.from==t&&e.to==i):null,e.reduce((t,e)=>Math.min(t,e.from),1e8),e.reduce((t,e)=>Math.max(t,e.to),0))}foldInside(t,e){let i=null;return this.decorations.between(t,e,(t,e)=>i={from:t,to:e}),i}}class Br extends re{ignoreEvents(){return!1}toDOM(t){let e=this.value.config;if(e.placeholderDOM)return e.placeholderDOM();let i=document.createElement("span");return i.textContent=e.placeholderText,i.setAttribute("aria-label",t.phrase("folded code")),i.title=t.phrase("unfold"),i.className=this.value.class,i.onclick=e=>{let i=t.lineAt(t.posAtDOM(e.target)),r=t.plugin(Er).foldInside(i.from,i.to);r&&t.dispatch(t.state.t().annotate(Qr({unfold:[r]}))),e.preventDefault()},i}}const $r={openText:"⌄",closedText:"›"};class Ur extends $i{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.phrase(this.open?"Fold line":"Unfold line"),e}}function Vr(t={}){let e=B(t,$r);return[new Li({style:"foldGutter",lineMarker:(t,i)=>t.plugin(Er).foldInside(i.from,i.to)?new Ur(e,!1):t.state.behavior(nt.foldable).some(e=>e(t.state,i.from,i.to))?new Ur(e,!0):null,initialSpacer:()=>new Ur(e,!1),handleDOMEvents:{click:(t,e)=>{let i=t.plugin(Er).foldInside(e.from,e.to);if(i)return t.dispatch(t.state.t().annotate(Qr({unfold:[i]}))),!0;let r=t.state.behavior(nt.foldable).reduce((i,r)=>i||r(t.state,e.from,e.to),null);return!!r&&(t.dispatch(t.state.t().annotate(Qr({fold:[r]}))),!0)}}}).extension,zr()]}const Lr=Ei.theme({foldPlaceholder:{background:"#eee",border:"1px solid silver",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},"gutterElement.foldGutter":{padding:"0 1px",cursor:"pointer"}});var Ir=i(5);const jr=new $.NodeProp;function _r(t){return nt.indentation((e,i)=>function(t,e,i){let r=e.resolve(i);for(let t=r,e=i;;){let i=t.childBefore(e);if(!i)break;i.type.prop($.NodeProp.error)&&i.start==i.end?(r=t,e=i.start):(t=i,e=t.end+1)}for(;r;r=r.parent){let e=Hr(r.type)||(null==r.parent?Fr:null);if(e)return e(new Xr(t,i,r))}return-1}(e,t.getPartialTree(e,i,i),i))}function Hr(t){let e=t.prop(jr);if(!e){let e=t.prop($.NodeProp.delim);if(e)return function({closing:t,align:e=!0,units:i=1}){return r=>{let n=r.textAfter.slice(0,t.length)==t,s=e?function(t){let e=t.node,i=e.childAfter(e.start);if(!i)return null;let r=t.state.doc.lineAt(i.start);for(let t=i.end;;){let n=e.childAfter(t);if(!n)return null;if(!n.type.prop($.NodeProp.skipped))return n.start<r.end?i:null;t=n.end}}(r):null;return s?n?r.column(s.start):r.column(s.end):r.baseIndent+(n?0:r.unit*i)}}({closing:e.split(" ")[1]})}return e}function Fr(){return 0}class Xr{constructor(t,e,i){this.state=t,this.pos=e,this.node=i}get unit(){return this.state.indentUnit}get textAfter(){return this.state.doc.slice(this.pos,Math.min(this.pos+50,this.state.doc.lineAt(this.pos).end)).match(/^\s*(.*)/)[1]}countColumn(t,e){e<0&&(e=t.length);let i=this.state.tabSize;for(var r=0,n=0;;){let s=t.indexOf("\t",r);if(s<0||s>=e)return n+(e-r);n+=s-r,n+=i-n%i,r=s+1}}lineIndent(t){let e=t.slice(0,Math.min(50,t.length,this.node.start>t.start?this.node.start-t.start:1e8));return this.countColumn(e,e.search(/\S/))}get baseIndent(){let t=this.state.doc.lineAt(this.node.start);for(;;){let e=this.node.resolve(t.start);for(;e.parent&&e.parent.start==e.start;)e=e.parent;if(qr(e,this.node))break;t=this.state.doc.lineAt(e.start)}return this.lineIndent(t)}column(t){let e=this.state.doc.lineAt(t);return this.countColumn(e.slice(0,t-e.start),t-e.start)}}function qr(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}const Gr=new $.NodeProp;const Zr={};class Yr{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}get(t){if(t>=this.length)return-1;let e=this.cursorPos-this.string.length;return(t<e||t>=this.cursorPos)&&(t<this.cursorPos&&(this.cursor=this.doc.iter(),this.cursorPos=0),this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,e=this.cursorPos-this.string.length),this.string.charCodeAt(t-e)}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.slice(t,e):this.string.slice(t-i,e-i)}clip(t){return new Yr(this.doc,t)}}class Kr{constructor(t){this.upto=t,this.promise=new Promise(t=>this.resolve=t),this.promise.canceled=!1}}class Jr{constructor(t){this.tree=t,this.parsedTo=0,this.parse=null,this.working=-1,this.requests=[]}apply(t){return t.docChanged?new Jr(this.tree.applyChanges(t.changes.changedRanges())):this}updateTree(t,e,i,r,n){if(r<=this.parsedTo)return!0;if(this.parse||(this.parse=t.startParse(new Yr(e),{cache:this.tree}),this.continueParse(r)),this.parsedTo>=r)return!0;if(!n)return!1;this.scheduleWork();let s=this.requests.find(t=>t.upto==r&&!t.promise.canceled);return s||this.requests.push(s=new Kr(r)),s.promise}continueParse(t){let e=Date.now()+100;for(let t=0;;t++){let i=this.parse.advance();if(i)return this.parsedTo=1e9,this.parse=null,void(this.tree=i);if(1e3==t&&(t=0,Date.now()>e))break}this.parsedTo=this.parse.pos,this.tree=this.parse.forceFinish(),this.parsedTo>=t&&(this.parse=null)}scheduleWork(){-1==this.working&&(this.working=setTimeout(()=>this.work(),200))}work(){this.working=-1;let t=this.requests.reduce((t,e)=>e.promise.canceled?t:Math.max(t,e.upto),0);t>this.parsedTo&&this.continueParse(t),this.requests=this.requests.filter(t=>!t.promise.canceled&&t.upto>this.parsedTo||(t.promise.canceled||t.resolve(this.tree),!1)),this.requests.length&&this.scheduleWork()}}function tn(){return new $.NodeProp({deserialize:t=>t.split(" ")})}tn(),tn();const en=new class{constructor(t){this.typeNames=[""],this.prop=new $.NodeProp,this.flags=t.flags,this.types=t.types,this.flagMask=Math.pow(2,this.flags.length)-1,this.typeShift=this.flags.length+1;let e=[void 0];for(let i of t.types){let t=/^([\w\-]+)(?:=([\w-]+))?$/.exec(i);if(!t)throw new RangeError("Invalid type name "+i);this.typeNames.push(t[1]),e.push(t[2])}if(this.parents=e.map(t=>{if(null==t)return 0;let e=this.typeNames.indexOf(t);if(e<0)throw new RangeError(`Unknown parent type '${t}' specified`);return e}),this.flags.length>29||this.typeNames.length>Math.pow(2,29-this.flags.length))throw new RangeError("Too many style tag flags to fit in a 30-bit integer")}get(t){let e=43==t.charCodeAt(0)?1:0;for(let i of(e?t.slice(1):t).split(" "))if(i){let r=this.flags.indexOf(i);if(r>-1)e+=1<<r+1;else{let r=this.typeNames.indexOf(i);if(r<0)throw new RangeError(`Unknown tag type '${i}'`);if(e>>this.typeShift)throw new RangeError(`Multiple tag types specified in '${t}'`);e+=r<<this.typeShift}}return e}add(t){let e=$.NodeType.match(t);return this.prop.add(t=>{let i=e(t);return null==i?void 0:this.get(i)})}highlighter(t){let e=new nn(this,t);return[_e.create(t=>new sn(t,this.prop,e)).decorations(t=>t.decorations).extension,Ei.styleModule(e.module)]}specificity(t){let e=t&this.flagMask,i=0;for(let t=1;t<=this.flags.length;t++)e&1<<t&&i++;for(let e=t>>this.flags.length+1;e;e=this.parents[e])i+=1e3;return i}}({flags:["invalid","meta","type2","type3","type4","link","strong","emphasis","heading","list","quote","changed","inserted","deleted","definition","constant","control"],types:["comment","lineComment=comment","blockComment=comment","name","variableName=name","typeName=name","propertyName=name","className=name","labelName=name","namespace=name","literal","string=literal","character=string","number=literal","integer=number","float=number","regexp=literal","escape=literal","color=literal","content","keyword","self=keyword","null=keyword","atom=keyword","unit=keyword","modifier=keyword","operatorKeyword=keyword","operator","derefOperator=operator","arithmeticOperator=operator","logicOperator=operator","bitwiseOperator=operator","compareOperator=operator","updateOperator=operator","typeOperator=operator","punctuation","separator=punctuation","bracket=punctuation","angleBracket=bracket","squareBracket=bracket","paren=bracket","brace=bracket"]});class rn{constructor(t,e,i,r){this.type=t,this.flags=e,this.specificity=i,this.cls=r}}class nn{constructor(t,e){this.tags=t,this.cache=Object.create(null);let i=Object.create(null),r=0,n=[];for(let s in e){let o=t.get(s),h="c"+r++;i[h]=e[s],n.push(new rn(o>>t.typeShift,o&t.flagMask,t.specificity(o),h))}this.rules=n.sort((t,e)=>e.specificity-t.specificity),this.module=new st.a(i)}match(t){let e=this.cache[t];if(null!=e)return e;let i="",r=t>>this.tags.typeShift,n=t&this.tags.flagMask;for(;;){for(let t of this.rules)if(t.type==r&&(t.flags&n)==t.flags&&(i&&(i+=" "),i+=this.module[t.cls],n&=~t.flags,r))break;if(!r)break;r=this.tags.parents[r]}return this.cache[t]=i}}class sn{constructor(t,e,i){this.prop=e,this.styling=i,this.partialDeco=!1,this.syntax=null,this.decorations=se.none;for(let e of t.state.behavior(nt.syntax)){this.syntax=e;break}this.buildDeco(t)}update(t){(this.partialDeco||t.docChanged||t.viewportChanged)&&this.buildDeco(t.view)}buildDeco(t){if(!this.syntax)return;let{from:e,to:i}=t.viewport,{tree:r,rest:n}=this.syntax.getTree(t.state,e,i);this.partialDeco=!!n,n&&t.waitFor(n);let s=[],o=e;function h(t,e){t>o&&e&&s.push(se.mark(o,t,{class:e})),o=t}let a="",l=[],c=[];r.iterate({from:e,to:i,enter:(t,e)=>{let i=c.length?c[c.length-1]:"",r=i,n=t.prop(this.prop);if(null!=n){let t=this.styling.match(n);t&&(r&&(r+=" "),r+=t),1&n&&(i=r)}l.push(r),i&&c.push(i),r!=a&&(h(e,a),a=r)},leave:(t,e,r)=>{l.pop(),c.pop();let n=l.length?l[l.length-1]:"";n!=a&&(h(Math.min(i,r),a),a=n)}}),this.decorations=se.set(s)}}const on=(hn={invalid:{color:"#f00"},keyword:{color:"#708"},atom:{color:"#219"},number:{color:"#164"},string:{color:"#a11"},character:{color:"#a11"},regexp:{color:"#e40"},escape:{color:"#e40"},"variableName definition":{color:"#00f"},typeName:{color:"#085"},"propertyName definition":{color:"#00c"},comment:{color:"#940"},meta:{color:"#555"}},en.highlighter(hn));var hn;const an=new class{constructor(t){var e;this.parser=t,this.field=new H({init:()=>new Jr($.Tree.empty),apply:(t,e)=>e.apply(t)}),this.extension=[nt.syntax(this),this.field.extension,_r(this),(e=this,nt.foldable((t,i,r)=>{let n=null;for(let s=e.getPartialTree(t,i,Math.min(t.doc.length,r+100)).resolve(r);s;s=s.parent){if(s.start<i||s.end<=r)continue;let t=s.type.prop(Gr);if(t){let e=t(s);e&&e.to>r&&(n=e)}}return n}))]}tryGetTree(t,e,i){let r=t.field(this.field);return r.updateTree(this.parser,t.doc,e,i,!1)?r.tree:null}getTree(t,e,i){let r=t.field(this.field),n=r.updateTree(this.parser,t.doc,e,i,!0);return{tree:r.tree,rest:!0===n?null:n}}getPartialTree(t,e,i){let r=t.field(this.field);return r.updateTree(this.parser,t.doc,e,i,!1),r.tree}get docNodeType(){return this.parser.group.types[1]}languageDataAt(t,e){let i=this.parser.group.types[1];if(this.parser.hasNested){let r=this.getPartialTree(t,e,e).resolve(e);for(;r;){if(r.type.prop($.NodeProp.top)){i=r.type;break}r=r.parent}}return i.prop(X)||Zr}}(Ir.parser.withProps(jr.add({Declaration:function({except:t,units:e=1}={}){return i=>{let r=t&&t.test(i.textAfter);return i.baseIndent+(r?0:e*i.unit)}}()}),Gr.add({Block:t=>({from:t.start+1,to:t.end-1})}),(ln={"import charset namespace keyframes":"keyword definition","media supports":"keyword control","from to":"keyword",NamespaceName:"namespace",KeyframeName:"labelName",TagName:"typeName",ClassName:"className",PseudoClassName:"className constant",not:"operatorKeyword",IdName:"labelName",AttributeName:"propertyName",NumberLiteral:"number",PropertyName:"propertyName",KeywordQuery:"keyword",FeatureName:"propertyName",UnaryQueryOp:"operatorKeyword",callee:"keyword",ValueName:"atom",CallTag:"atom",Callee:"variableName",Unit:"unit","UniversalSelector NestingSelector":"operator definition",AtKeyword:"keyword",MatchOp:"compareOperator","ChildOp SiblingOp, LogicOp":"logicOperator",BinOp:"arithmeticOperator",Important:"modifier",Comment:"blockComment",ParenthesizedContent:"name type2",ColorLiteral:"color",StringLiteral:"string",":":"punctuation definition","PseudoOp #":"derefOperator","; ,":"separator","( )":"paren","[ ]":"squareBracket","{ }":"brace"},en.add(ln))));var ln;for(var cn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},un={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},fn="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),dn="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),pn="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),gn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),mn="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),On=fn&&(gn||+fn[1]<57)||pn&&gn,vn=0;vn<10;vn++)cn[48+vn]=cn[96+vn]=String(vn);for(vn=1;vn<=24;vn++)cn[vn+111]="F"+vn;for(vn=65;vn<=90;vn++)cn[vn]=String.fromCharCode(vn+32),un[vn]=String.fromCharCode(vn);for(var yn in cn)un.hasOwnProperty(yn)||(un[yn]=cn[yn]);const bn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function wn(t){const e=t.split(/-(?!$)/);let i,r,n,s,o=e[e.length-1];"Space"==o&&(o=" ");for(let t=0;t<e.length-1;++t){const o=e[t];if(/^(cmd|meta|m)$/i.test(o))s=!0;else if(/^a(lt)?$/i.test(o))i=!0;else if(/^(c|ctrl|control)$/i.test(o))r=!0;else if(/^s(hift)?$/i.test(o))n=!0;else{if(!/^mod$/i.test(o))throw new Error("Unrecognized modifier name: "+o);bn?s=!0:r=!0}}return i&&(o="Alt-"+o),r&&(o="Ctrl-"+o),s&&(o="Meta-"+o),n&&(o="Shift-"+o),o}function Sn(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const xn=t=>{let e=new kn(t);return Ei.handleDOMEvents({keydown(t,i){let r=e.get(i);return!!r&&r(t)}})};class kn{constructor(t){this.map=Object.create(null);for(const e in t)this.map[wn(e)]=t[e]}get(t){const e=function(t){var e=!(On&&(t.ctrlKey||t.altKey||t.metaKey)||(dn||mn)&&t.shiftKey&&t.key&&1==t.key.length)&&t.key||(t.shiftKey?un:cn)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}(t),i=1==e.length&&" "!=e,r=this.map[Sn(e,t,!i)];if(r)return r;let n;if(i&&(t.shiftKey||t.altKey||t.metaKey)&&(n=cn[t.keyCode])&&n!=e){const e=this.map[Sn(n,t,!0)];if(e)return e}}}function Pn(t,e,i){let r=t.state.t().forEachRange(r=>r.empty||"lineboundary"==i?new U(t.movePos(r.head,e,i,"move")):new U("left"==e||"backward"==e?r.from:r.to));return!r.selection.eq(t.state.selection)&&("line"==i&&r.annotate(et.preserveGoalColumn(!0)),t.dispatch(r.scrollIntoView()),!0)}const An=t=>Pn(t,"left","character"),Tn=t=>Pn(t,"right","character"),Qn=t=>Pn(t,"backward","line"),Cn=t=>Pn(t,"forward","line"),Mn=t=>Pn(t,"backward","lineboundary"),Dn=t=>Pn(t,"forward","lineboundary");function Nn(t,e,i){let r=t.state.t().forEachRange(r=>new U(r.anchor,t.movePos(r.head,e,i,"extend")));return!r.selection.eq(t.state.selection)&&("line"==i&&r.annotate(et.preserveGoalColumn(!0)),t.dispatch(r.scrollIntoView()),!0)}const Rn=t=>Nn(t,"left","character"),En=t=>Nn(t,"right","character"),zn=t=>Nn(t,"backward","line"),Wn=t=>Nn(t,"forward","line"),Bn=t=>Nn(t,"backward","lineboundary"),$n=t=>Nn(t,"forward","lineboundary"),Un=({state:t,dispatch:e})=>(e(t.t().setSelection(V.single(0)).scrollIntoView()),!0),Vn=({state:t,dispatch:e})=>(e(t.t().setSelection(V.single(t.doc.length)).scrollIntoView()),!0);function Ln(t,e){let i=t.state.t().forEachRange((i,r)=>{let{from:n,to:s}=i;if(n==s){let r=t.movePos(i.head,e,"character","move");n=Math.min(n,r),s=Math.max(s,r)}return n==s?i:(r.replace(n,s,""),new U(n))});return!!i.docChanged&&(t.dispatch(i.scrollIntoView()),!0)}const In=t=>Ln(t,"backward"),jn=t=>Ln(t,"forward");function _n(t){let e="";for(let i=0;i<t;i++)e+=" ";return e}function Hn(t,e){for(let i of t.behavior(nt.indentation)){let r=i(t,e);if(r>-1)return r}return-1}const Fn=({state:t,dispatch:e})=>{let i=-1,r=[];for(let e of t.selection.ranges)for(let{start:n,end:s}=t.doc.lineAt(e.from);;){if(n!=i){i=n;let e,o=Hn(t,n);o>-1&&o!=(e=/^\s*/.exec(t.doc.slice(n,Math.min(s,n+100)))[0].length)&&r.push({pos:n,current:e,indent:o})}if(s+1>e.to)break;({start:n,end:s}=t.doc.lineAt(s+1))}if(r.length>0){let i=t.t();for(let{pos:t,current:e,indent:n}of r){let r=i.changes.mapPos(t);i.replace(r,r+e,_n(n))}e(i)}return!0},Xn={ArrowLeft:An,ArrowRight:Tn,"Shift-ArrowLeft":Rn,"Shift-ArrowRight":En,"Mod-ArrowLeft":t=>Pn(t,"left","word"),"Mod-ArrowRight":t=>Pn(t,"right","word"),"Shift-Mod-ArrowLeft":t=>Nn(t,"left","word"),"Shift-Mod-ArrowRight":t=>Nn(t,"right","word"),ArrowUp:Qn,ArrowDown:Cn,"Shift-ArrowUp":zn,"Shift-ArrowDown":Wn,Home:Mn,End:Dn,"Shift-Home":Bn,"Shift-End":$n,"Mod-Home":Un,"Mod-End":Vn,"Mod-a":({state:t,dispatch:e})=>(e(t.t().setSelection(V.single(0,t.doc.length))),!0),Backspace:In,Delete:jn,Enter:({state:t,dispatch:e})=>{let i=0,r=t.selection.ranges.map(e=>{let i=Hn(t,e.from);return i>-1?i:/^\s*/.exec(t.doc.lineAt(e.from).slice(0,50))[0].length});return e(t.t().forEachRange(({from:t,to:e},n)=>{let s=r[i++],o=n.doc.lineAt(e);for(;e<o.end&&/s/.test(o.slice(e-o.start,e+1-o.start));)e++;return n.replace(t,e,["",_n(s)]),new U(t+s+1)}).scrollIntoView()),!0}},qn={"Control-b":An,"Control-f":Tn,"Shift-Control-b":Rn,"Shift-Control-f":En,"Control-p":Qn,"Control-n":Cn,"Shift-Control-p":zn,"Shift-Control-n":Wn,"Control-a":Mn,"Control-e":Dn,"Shift-Control-a":Bn,"Shift-Control-e":$n,"Cmd-ArrowUp":Un,"Cmd-ArrowDown":Vn,"Control-d":jn,"Control-h":In};for(let t in Xn)qn[t]=Xn[t];const Gn=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?qn:Xn,Zn=/Mac/.test(navigator.platform);LTN.chunks.LTNChunkCSS=class{constructor(){this.view=null,this.text=""}static get title(){return"CSS"}async init(t){this.text=t.text}async renderEditor(){return this.view=new Ei({state:nt.create({doc:this.text,extensions:[Ji(),or(),wr(),Vr(),an.extension,on,xn({"Mod-z":xr,"Mod-Shift-z":kr,"Mod-u":t=>Pr(t)||!0,[Zn?"Mod-Shift-u":"Alt-u"]:Ar,"Ctrl-y":Zn?void 0:kr,"Shift-Tab":Fn,"Mod-Alt-[":Mr,"Mod-Alt-]":Dr}),xn(Gn)]})}),this.view.dom}async renderReport(){let t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");t.appendChild(e),e.type="text/css",e.styleSheet?e.styleSheet.cssText=this.text:e.appendChild(document.createTextNode(this.text))}async save(){return{text:this.view.state.toJSON().doc}}}}]);